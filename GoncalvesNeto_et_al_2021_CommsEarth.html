<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB R2020a"><title>Untitled</title><style type="text/css">.rtcContent { padding: 30px; } .CodeBlock { background-color: #F7F7F7; margin: 10px 0 10px 0;}
.S0 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 0px none rgb(0, 0, 0); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S1 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 0px none rgb(0, 0, 0); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S2 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }</style></head><body><div class = rtcContent><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%% GoncalvesNeto_et_al_2021_CommsEarth</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Afonso Goncalves Neto</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% December 1, 2020</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% In this script, all of the figures in Gon√ßalves Neto, Langan &amp; Palter</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% (2021) are created. Additional steps in Adobe Illustrator were applied to</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% generate the final formatting in the manuscript.</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%% Figure 1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Schematic of the circulation in the Northwest Atlantic Ocean and the water </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% column temperature change in the period 2009-2018 relative to 2001-2007. The </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% filled red (blue) contours indicate warming (cooling) of the vertically-</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% averaged ocean temperature from the EN4 objective analysis (Good et al., 2013)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% to 2,000 m or the seafloor if it is shallower than 2,000 m in 0.5oC increments</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% (change in the unshaded region is &lt;0.25oC). Background in grayscale shows the</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% bathymetry of the region, with darker shades representing shallower areas. The</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% main surface circulation patterns associated with the Gulf Stream (red) and </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% the Labrador Current (blue) systems are identified with arrows. Coastal and </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% shelf areas of interest are indicated. TGB stands for Tail of the Grand Banks </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% and SENR, for Southeastern Newfoundland Ridge.</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Set  directory to save data</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>data_dir = </span><span style="color: rgb(255, 153, 200);">'/Users/afonso/Documents/Research/TGB/data/'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Set directory to save figures and tables</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>output_dir = </span><span style="color: rgb(255, 153, 200);">'/Users/afonso/Documents/Research/TGB/output/'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Bathymetry (first layer)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>load([output_dir,</span><span style="color: rgb(255, 153, 200);">'etopo1_TGB.mat'</span><span>],</span><span style="color: rgb(255, 153, 200);">'lat_z'</span><span>,</span><span style="color: rgb(255, 153, 200);">'lon_z'</span><span>,</span><span style="color: rgb(255, 153, 200);">'z'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>figure(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>, [100, 200, 800, 600])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>subplot(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,[0.06 0.09 0.88 0.85])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>axesm(</span><span style="color: rgb(255, 153, 200);">'MapProjection'</span><span>,</span><span style="color: rgb(255, 153, 200);">'eqdcylin'</span><span>,</span><span style="color: rgb(255, 153, 200);">'MapLatLimit'</span><span>,[30 60],</span><span style="color: rgb(255, 153, 200);">'MapLonLimit'</span><span>,[-80 -40])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>hold </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>pcolorm(lat_z,lon_z,z)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>shading </span><span style="color: rgb(255, 153, 200);">flat</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>colormap(cmocean(</span><span style="color: rgb(255, 153, 200);">'gray'</span><span>,</span><span style="color: rgb(255, 153, 200);">'negative'</span><span>))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>caxis([-4500 2000])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>geoshow(</span><span style="color: rgb(255, 153, 200);">'GSHHS_i_L1.shp'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FaceColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span><span style="color: rgb(0, 191, 191);">%[.7 .7 .7])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plabel(</span><span style="color: rgb(255, 153, 200);">'PLabelLocation'</span><span>,5,</span><span style="color: rgb(255, 153, 200);">'fontsize'</span><span>,14)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>mlabel(</span><span style="color: rgb(255, 153, 200);">'MLabelLocation'</span><span>,10,</span><span style="color: rgb(255, 153, 200);">'MLabelParallel'</span><span>,</span><span style="color: rgb(255, 153, 200);">'south'</span><span>,</span><span style="color: rgb(255, 153, 200);">'fontsize'</span><span>,14)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>framem</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>tightmap</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(gcf, </span><span style="color: rgb(255, 153, 200);">'Color'</span><span>, </span><span style="color: rgb(255, 153, 200);">'w'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>saveas(gcf,[output_dir,</span><span style="color: rgb(255, 153, 200);">'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_Figure1_layer1'</span><span>],</span><span style="color: rgb(255, 153, 200);">'epsc'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%export_fig(gcf,[output_dir,'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_Figure1_layer1'],'-eps','-transparent')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Temperature change (second layer)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>load([data_dir,</span><span style="color: rgb(255, 153, 200);">'en4_NWA.mat'</span><span>],</span><span style="color: rgb(255, 153, 200);">'t_en4'</span><span>,</span><span style="color: rgb(255, 153, 200);">'s_en4'</span><span>,</span><span style="color: rgb(255, 153, 200);">'lon_en4'</span><span>,</span><span style="color: rgb(255, 153, 200);">'lat_en4'</span><span>,</span><span style="color: rgb(255, 153, 200);">'time_en4'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[~,in1] = min(abs(time_en4 - datenum(</span><span style="color: rgb(255, 153, 200);">'20010115'</span><span>,</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[~,out1] = min(abs(time_en4 - datenum(</span><span style="color: rgb(255, 153, 200);">'20071215'</span><span>,</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[~,in2] = min(abs(time_en4 - datenum(</span><span style="color: rgb(255, 153, 200);">'20090115'</span><span>,</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[~,out2] = min(abs(time_en4 - datenum(</span><span style="color: rgb(255, 153, 200);">'20181215'</span><span>,</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>t_en4_2001_2007 = nanmean(nanmean(t_en4(:,:,1:30,in1:out1),4),3);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>t_en4_2009_2018 = nanmean(nanmean(t_en4(:,:,1:30,in2:out2),4),3);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>figure(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>, [100, 200, 800, 600])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>subplot(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,[0.06 0.09 0.88 0.85])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>axesm(</span><span style="color: rgb(255, 153, 200);">'MapProjection'</span><span>,</span><span style="color: rgb(255, 153, 200);">'eqdcylin'</span><span>,</span><span style="color: rgb(255, 153, 200);">'MapLatLimit'</span><span>,[30 60],</span><span style="color: rgb(255, 153, 200);">'MapLonLimit'</span><span>,[-80 -40])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>hold </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>t_diff = t_en4_2009_2018' - t_en4_2001_2007';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>pcolorm(lat_en4,lon_en4,t_diff)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>shading </span><span style="color: rgb(255, 153, 200);">flat</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>fillm([53,53,55,55],[-67,-63,-63,-67],</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%rectangle('Position',[0.2,0.8,0.1,0.1],'FaceColor','k','EdgeColor','k')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%rectangle('Position',[52,-68,2,4],'FaceColor','k','EdgeColor','k')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>colormap([5/256,113/256,175/256;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    5/256,113/256,176/256;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    247/256,247/256,247/256;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    247/256,247/256,247/256;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    244/256,165/256,130/256;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    244/256,165/256,130/256;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    214/256,96/256,77/256;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    214/256,96/256,77/256;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    178/256,24/256,43/256;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    178/256,24/256,43/256])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(gca,</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,14)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>geoshow(</span><span style="color: rgb(255, 153, 200);">'GSHHS_i_L1.shp'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FaceColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span><span style="color: rgb(0, 191, 191);">%[.7 .7 .7])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plabel(</span><span style="color: rgb(255, 153, 200);">'PLabelLocation'</span><span>,5,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,14)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>mlabel(</span><span style="color: rgb(255, 153, 200);">'MLabelLocation'</span><span>,10,</span><span style="color: rgb(255, 153, 200);">'MLabelParallel'</span><span>,</span><span style="color: rgb(255, 153, 200);">'south'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,14)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>framem</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>tightmap</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%cbarrow</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c = colorbar(</span><span style="color: rgb(255, 153, 200);">'Orientation'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Horizontal'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,[0.2 0.7 0.27 0.04],</span><span style="color: rgb(255, 153, 200);">'Color'</span><span>,[1-eps,1,1],</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,10);</span><span style="color: rgb(0, 191, 191);">%colorbar over land</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c.Label.String = </span><span style="color: rgb(255, 153, 200);">'Temperature Difference (^\circC)'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c.Ticks = [-0.75 -0.25 0.25 0.75 1.25 1.75];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(c,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,14)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>caxis([-0.75 1.75])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(gcf, </span><span style="color: rgb(255, 153, 200);">'Color'</span><span>, </span><span style="color: rgb(255, 153, 200);">'w'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>saveas(gcf,[output_dir,</span><span style="color: rgb(255, 153, 200);">'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_Figure1_layer2'</span><span>],</span><span style="color: rgb(255, 153, 200);">'epsc'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clearvars </span><span style="color: rgb(255, 153, 200);">-except *_dir</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>close </span><span style="color: rgb(255, 153, 200);">all</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%% Figure 2</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Set  directory to save data</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span class="warning_squiggle_rte1619232262">data_dir</span><span> = </span><span style="color: rgb(255, 153, 200);">'/Users/afonso/Documents/Research/TGB/data/'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Set directory to save figures and tables</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>output_dir = </span><span style="color: rgb(255, 153, 200);">'/Users/afonso/Documents/Research/TGB/output/'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>load([output_dir,</span><span style="color: rgb(255, 153, 200);">'etopo1_TGB.mat'</span><span>],</span><span style="color: rgb(255, 153, 200);">'lat_z'</span><span>,</span><span style="color: rgb(255, 153, 200);">'lon_z'</span><span>,</span><span style="color: rgb(255, 153, 200);">'z'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>load([output_dir,</span><span style="color: rgb(255, 153, 200);">'SSH_TGB.mat'</span><span>],</span><span style="color: rgb(255, 153, 200);">'time_month'</span><span>,</span><span style="color: rgb(255, 153, 200);">'lat_ssh'</span><span>,</span><span style="color: rgb(255, 153, 200);">'lon_ssh'</span><span>,</span><span style="color: rgb(255, 153, 200);">'adt'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>figure(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>, [100, 200, 800, 600])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>axesm(</span><span style="color: rgb(255, 153, 200);">'MapProjection'</span><span>,</span><span style="color: rgb(255, 153, 200);">'eqdcylin'</span><span>,</span><span style="color: rgb(255, 153, 200);">'MapLatLimit'</span><span>,[30 60],</span><span style="color: rgb(255, 153, 200);">'MapLonLimit'</span><span>,[-80 -40])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>hold </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c1_aux = contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),[-500 -500],</span><span style="color: rgb(255, 153, 200);">'k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%c1_aux = contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),[-1000 -1000],'k','linewidth',1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%c01_aux = contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),[-100 -100],'k','linewidth',1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>linem([36 36],[360-75 360-47],</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>linem([46 46],[360-75 360-47],</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>linem([36 46],[360-75 360-75],</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>linem([36 46],[360-47 360-47],</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>geoshow(</span><span style="color: rgb(255, 153, 200);">'landareas.shp'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FaceColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span><span style="color: rgb(0, 191, 191);">%[.7 .7 .7])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>close </span><span style="color: rgb(255, 153, 200);">all</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c1 = NaN(2,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>j = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 2:length(c1_aux)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">if </span><span>c1_aux(1,i)&gt;=360-75 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">&amp;</span><span> c1_aux(1,i)&lt;=360-47 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">&amp;</span><span> c1_aux(2,i)&gt;=36 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">&amp;</span><span> c1_aux(2,i)&lt;=46</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        c1(:,j) = c1_aux(:,i);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">if </span><span>j&gt;1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            </span><span style="color: rgb(237, 177, 32);">if </span><span>abs(c1_aux(1,i)-c1(1,j-1))&lt;0.2</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>                j = j+1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            </span><span style="color: rgb(237, 177, 32);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>                c1(:,j) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            j = j+1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear </span><span style="color: rgb(255, 153, 200);">i j</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">if </span><span>isnan(c1(1,end))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    c1 = c1(:,1:end-1);</span><span style="color: rgb(0, 191, 191);">% lon,lat of 1000m isobath</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c1(3,:) = zeros;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c1_dist = gsw_distance(c1(1,:),c1(2,:));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 2:length(c1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    c1(3,i) = sum(c1_dist(1:i-1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear </span><span style="color: rgb(255, 153, 200);">c1_aux c1_dist i</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Lat and Lon for TGB, slope and shelf</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>lon_ssh2 = lon_ssh(lon_ssh&gt;=360-75 &amp; lon_ssh&lt;=360-45);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>lat_ssh2 = lat_ssh(lat_ssh&gt;=36 &amp; lat_ssh&lt;=46);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[</span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">lon_ssh2_mesh</span><span>,</span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">lat_ssh2_mesh</span><span>] = meshgrid(lon_ssh2,lat_ssh2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>lon_z2 = lon_z(lon_z&gt;=360-75 &amp; lon_z&lt;=360-45);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>lat_z2 = lat_z(lat_z&gt;=36 &amp; lat_z&lt;=46);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[</span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">lon_z2_mesh</span><span>,</span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">lat_z2_mesh</span><span>] = meshgrid(lon_z2,lat_z2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>z2 = z(lat_z&gt;=36 &amp; lat_z&lt;=46,lon_z&gt;=360-75 &amp; lon_z&lt;=360-45)';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Define area at TGB between 3000m and 4000 isobaths (for time series)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[lon_mesh,lat_mesh] = meshgrid(lon_ssh,lat_ssh);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[lon_z_mesh,lat_z_mesh] = meshgrid(lon_z,lat_z);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span class="warning_squiggle_rte1619232262">lon_z_tgb</span><span> = lon_z(lon_z&gt;=360-51 &amp; lon_z&lt;=360-46);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span class="warning_squiggle_rte1619232262">lat_z_tgb</span><span> = lat_z(lat_z&gt;=39 &amp; lat_z&lt;=43);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>z_ssh = interp2(lon_z_mesh,lat_z_mesh,z,lon_mesh,lat_mesh);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>z_tgb = z_ssh(lat_ssh&gt;=39 &amp; lat_ssh&lt;=43,lon_ssh&gt;=360-51 &amp; lon_ssh&lt;=360-46);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[z_aux1,z_aux2] = find(z_tgb&gt;=-4000 &amp; z_tgb&lt;=-3000);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>z_aux3 = z_aux1+36;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>z_aux4 = z_aux2+116;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% SLA at TGB</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>adt_TGB = nan(length(time_month),length(z_aux4));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i=1:length(z_aux4)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    adt_TGB(:,i) = squeeze(adt(z_aux4(i),z_aux3(i),:));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>adt_TGB2 = nanmean(adt_TGB,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span class="warning_squiggle_rte1619232262">adt_TGB2_lp</span><span> = filtfilt(ones(12,1)/12,1,adt_TGB2(1:end-1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% ADT time series</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla_TGB2_std = nanstd(adt_TGB2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span class="warning_squiggle_rte1619232262">sla_TGB2_mean</span><span> = nanmean(adt_TGB2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2 = adt_TGB2;</span><span style="color: rgb(0, 191, 191);">%-sla_TGB2_mean;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span class="warning_squiggle_rte1619232262">sla2_TGB2_lp</span><span> = filtfilt(ones(12,1)/12,1,sla2_TGB2(1:end-1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span class="warning_squiggle_rte1619232262">slahigh</span><span> = find(sla2_TGB2&gt;(1.5*sla_TGB2_std));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span class="warning_squiggle_rte1619232262">slalow</span><span> = find(sla2_TGB2&lt;-(1.5*sla_TGB2_std));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% annual averages</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2_yr = NaN(26,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 1:26</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    sla2_TGB2_yr(i,1) = nanmean(sla2_TGB2(i*12-11:i*12));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% monthly averages</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2_mo = NaN(12,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 1:12</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    sla2_TGB2_mo(i,1) = nanmean(sla2_TGB2(i:12:16*12+i));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span class="warning_squiggle_rte1619232262">sla2_TGB2_mo_std</span><span>(i,1) = nanstd(sla2_TGB2(i:12:16*12+i));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 1:26</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    sla2_TGB2_nomo(i*12-11:i*12) = sla2_TGB2(i*12-11:i*12) - sla2_TGB2_mo;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2_nomo_mean = nanmean(sla2_TGB2_nomo);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2_nomo_std = nanstd(sla2_TGB2_nomo);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2_nomo = sla2_TGB2_nomo - sla2_TGB2_nomo_mean;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span class="warning_squiggle_rte1619232262">slahigh_nomo</span><span> = find(sla2_TGB2_nomo&gt;(1.5*(sla2_TGB2_nomo_std)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span class="warning_squiggle_rte1619232262">slalow_nomo</span><span> = find(sla2_TGB2_nomo&lt;(1.5*(-sla2_TGB2_nomo_std)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span class="warning_squiggle_rte1619232262">sla2_TGB2_nomo_lp</span><span> = filtfilt(ones(12,1)/12,1,sla2_TGB2_nomo(1:end-1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[ipt,</span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">ipt_res</span><span>] = findchangepts(sla2_TGB2_nomo(1:end-1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% TGB SSH increase: 0.1043 m</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>nanmean(sla2_TGB2_nomo(1:12*15))</span><span style="color: rgb(0, 191, 191);">% -0.0409 m</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>nanmean(sla2_TGB2_nomo(12*16+1:end))</span><span style="color: rgb(0, 191, 191);">% 0.0634 m</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>round(100*nanmean(sla2_TGB2_nomo(1:ipt)),1)</span><span style="color: rgb(0, 191, 191);">% -0.0417 m</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>nanmean(sla2_TGB2_nomo(ipt:end))</span><span style="color: rgb(0, 191, 191);">% 0.0625 m</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>save(</span><span style="color: rgb(255, 153, 200);">'SSH_TGB_anom.mat'</span><span>,</span><span style="color: rgb(255, 153, 200);">'sla2_TGB2'</span><span>,</span><span style="color: rgb(255, 153, 200);">'sla2_TGB2_nomo'</span><span>,</span><span style="color: rgb(255, 153, 200);">'sla2_TGB2_mo'</span><span>,</span><span style="color: rgb(255, 153, 200);">'sla2_TGB2_mo_std'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Basin SSH increase: 0.0450</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>nanmean(nanmean(nanmean(adt(:,:,1:12*15),3)))</span><span style="color: rgb(0, 191, 191);">% - 0.0066 m</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>nanmean(nanmean(nanmean(adt(:,:,12*16+1:end),3)))</span><span style="color: rgb(0, 191, 191);">% 0.0384 m</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%csvwrite([output_dir,'SSH_TGB_1993-2018.csv'],sla2_TGB2_nomo')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% SSH fit</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_fit_aux = readtable(</span><span style="color: rgb(255, 153, 200);">'SSH.Fit.csv'</span><span>, </span><span style="color: rgb(255, 153, 200);">'HeaderLines'</span><span>,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_fit = table2array(sla2_fit_aux);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear </span><span style="color: rgb(255, 153, 200);">sla2_fit_aux</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>mycolors = linspecer(2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>adt_mean = nanmean(adt,3);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>figure(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>, [100, 200, 800, 600])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>subplot(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,[0.05 0.52 0.46 0.46])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>axesm(</span><span style="color: rgb(255, 153, 200);">'MapProjection'</span><span>,</span><span style="color: rgb(255, 153, 200);">'eqdcylin'</span><span>,</span><span style="color: rgb(255, 153, 200);">'MapLatLimit'</span><span>,[30 60],</span><span style="color: rgb(255, 153, 200);">'MapLonLimit'</span><span>,[-80 -40])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>hold </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>pcolorm(lat_ssh,lon_ssh,(adt_mean')*100)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>shading </span><span style="color: rgb(255, 153, 200);">interp</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>colormap(cmocean(</span><span style="color: rgb(255, 153, 200);">'balance'</span><span>,32))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c = colorbar(</span><span style="color: rgb(255, 153, 200);">'Orientation'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Horizontal'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,[0.12 0.84 0.1 0.02],</span><span style="color: rgb(255, 153, 200);">'Color'</span><span>,[1-eps,1,1],</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,10);</span><span style="color: rgb(0, 191, 191);">%colorbar over land</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c.Label.String = </span><span style="color: rgb(255, 153, 200);">'SSH (cm)'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(c,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,14)</span><span style="color: rgb(0, 191, 191);">%,'Fontweight','bold')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c.Ticks = [-80 0 80];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>caxis([-80 80])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-100 -100],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[77/256 77/256 77/256],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,0.5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-1000 -1000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[77/256 77/256 77/256],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,0.5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-3000 -3000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[77/256 77/256 77/256],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,0.5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-4000 -4000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[77/256 77/256 77/256],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,0.5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z2(1:2:end),lon_z2(1:2:end-120),z2(1:2:end-120,1:2:end)',[-1000 -1000],</span><span style="color: rgb(255, 153, 200);">'r'</span><span>,</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z2(lat_z2&gt;=39 &amp; lat_z2&lt;43),lon_z2(lon_z2&gt;=360-51 &amp; lon_z2&lt;=360-46),z2(lon_z2&gt;=360-51 &amp; lon_z2&lt;=360-46,lat_z2&gt;=39 &amp; lat_z2&lt;43)',[-3000 -3000],</span><span style="color: rgb(255, 153, 200);">'k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z2(lat_z2&gt;=39 &amp; lat_z2&lt;43),lon_z2(lon_z2&gt;=360-51 &amp; lon_z2&lt;=360-46),z2(lon_z2&gt;=360-51 &amp; lon_z2&lt;=360-46,lat_z2&gt;=39 &amp; lat_z2&lt;43)',[-4000 -4000],</span><span style="color: rgb(255, 153, 200);">'k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[</span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">aux1</span><span> </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">aux2</span><span>] = min(abs(lon_z2-360+51));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[a1 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">b1</span><span>] = min(abs(z2(aux2,:)+3000));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[a2 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">b2</span><span>] = min(abs(z2(aux2,:)+4000));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[</span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">aux1</span><span> </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">aux2</span><span>] = min(abs(lat_z2-43));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[a3 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">b3</span><span>] = min(abs(z2(1300:end,aux2)+3000));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[a4 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">b4</span><span>] = min(abs(z2(1300:end,aux2)+4000));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>linem([lat_z2(b1) lat_z2(b2)],[-51 -51],</span><span style="color: rgb(255, 153, 200);">'k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>linem([43 43],[lon_z2(b3+1300) lon_z2(b4+1300)],</span><span style="color: rgb(255, 153, 200);">'k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>linem([43 46],[360-55 360-57.5],</span><span style="color: rgb(255, 153, 200);">':k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>linem([40.8 43],[360-64 360-67.5],</span><span style="color: rgb(255, 153, 200);">':k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>linem([38.6 41.6],[360-68.8 360-68.8],</span><span style="color: rgb(255, 153, 200);">':k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>textm(42.5,360-55,</span><span style="color: rgb(255, 153, 200);">'LCh'</span><span>,</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,14,</span><span style="color: rgb(255, 153, 200);">'Fontweight'</span><span>,</span><span style="color: rgb(255, 153, 200);">'bold'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>textm(40.8,360-63.5,</span><span style="color: rgb(255, 153, 200);">'NECh'</span><span>,</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,14,</span><span style="color: rgb(255, 153, 200);">'Fontweight'</span><span>,</span><span style="color: rgb(255, 153, 200);">'bold'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>textm(39,360-68.3,</span><span style="color: rgb(255, 153, 200);">'GSCh'</span><span>,</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,14,</span><span style="color: rgb(255, 153, 200);">'Fontweight'</span><span>,</span><span style="color: rgb(255, 153, 200);">'bold'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%contourm(lat_ssh,lon_ssh,(adt_mean')*100,[25 25],'m','linewidth',2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>geoshow(</span><span style="color: rgb(255, 153, 200);">'GSHHS_i_L1.shp'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FaceColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span><span style="color: rgb(0, 191, 191);">%[.7 .7 .7])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plabel(</span><span style="color: rgb(255, 153, 200);">'PLabelLocation'</span><span>,5,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,14)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>mlabel(</span><span style="color: rgb(255, 153, 200);">'MLabelLocation'</span><span>,10,</span><span style="color: rgb(255, 153, 200);">'MLabelParallel'</span><span>,</span><span style="color: rgb(255, 153, 200);">'south'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>framem</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>tightmap</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>adt_diff = nanmean(adt(:,:,12*16+1:end),3)-nanmean(adt(:,:,1:12*15),3);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>subplot(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,[0.52 0.52 0.46 0.46])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>axesm(</span><span style="color: rgb(255, 153, 200);">'MapProjection'</span><span>,</span><span style="color: rgb(255, 153, 200);">'eqdcylin'</span><span>,</span><span style="color: rgb(255, 153, 200);">'MapLatLimit'</span><span>,[30 60],</span><span style="color: rgb(255, 153, 200);">'MapLonLimit'</span><span>,[-80 -40])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>hold </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>pcolorm(lat_ssh,lon_ssh,(adt_diff'-nanmean(nanmean(adt_diff)))*100)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>shading </span><span style="color: rgb(255, 153, 200);">interp</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>colormap(cmocean(</span><span style="color: rgb(255, 153, 200);">'balance'</span><span>,15))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c = colorbar(</span><span style="color: rgb(255, 153, 200);">'Orientation'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Horizontal'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,[0.59 0.84 0.1 0.02],</span><span style="color: rgb(255, 153, 200);">'Color'</span><span>,[1-eps,1,1],</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,10);</span><span style="color: rgb(0, 191, 191);">%colorbar over land</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c.Label.String = </span><span style="color: rgb(255, 153, 200);">'SSH Diff (cm)'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(c,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,14)</span><span style="color: rgb(0, 191, 191);">%,'Fontweight','bold')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c.Ticks = [-15 0 15]</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>caxis([-15 15])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),[-100 -100],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[77/256 77/256 77/256],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,0.5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),[-1000 -1000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[77/256 77/256 77/256],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,0.5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),[-3000 -3000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[77/256 77/256 77/256],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,0.5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),[-4000 -4000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[77/256 77/256 77/256],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,0.5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%contourm(lat_ssh,lon_ssh,(adt_mean')*100,[25 25],'m','linewidth',2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>geoshow(</span><span style="color: rgb(255, 153, 200);">'GSHHS_i_L1.shp'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FaceColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span><span style="color: rgb(0, 191, 191);">%[.7 .7 .7])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plabel(</span><span style="color: rgb(255, 153, 200);">'off'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>mlabel(</span><span style="color: rgb(255, 153, 200);">'MLabelLocation'</span><span>,10,</span><span style="color: rgb(255, 153, 200);">'MLabelParallel'</span><span>,</span><span style="color: rgb(255, 153, 200);">'south'</span><span>,</span><span style="color: rgb(255, 153, 200);">'fontsize'</span><span>,14)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>framem</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>tightmap</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>subplot(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,[0.08 0.075 0.88 0.38])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>hold </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%plot(time_month,sla2_TGB2_nomo*100,'color',[120/256,120/256,120/256],'LineWidth',1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%plot(time_month(7:end-6),sla2_TGB2_nomo_lp(7:end-5)*100,'color',[60/256,60/256,60/256],'LineWidth',2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%plot([time_month(1) time_month(ipt)],[nanmean(sla2_TGB2_nomo(1:ipt))*100 nanmean(sla2_TGB2_nomo(1:ipt))*100],'color',mycolors(1,:),'LineWidth',3)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%plot([time_month(ipt) time_month(end)],[nanmean(sla2_TGB2_nomo(ipt:end))*100 nanmean(sla2_TGB2_nomo(ipt:end))*100],'color',mycolors(2,:),'LineWidth',3)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plot(time_month(1:end-1),sla2_fit(:,4)*100,</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,rgb(</span><span style="color: rgb(255, 153, 200);">'DarkGray'</span><span>),</span><span style="color: rgb(255, 153, 200);">'LineWidth'</span><span>,1.5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plot(time_month(1:end-1),sla2_fit(:,3)*100,</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,rgb(</span><span style="color: rgb(255, 153, 200);">'DarkSlateGray'</span><span>),</span><span style="color: rgb(255, 153, 200);">'LineWidth'</span><span>,1.5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plot([time_month(1) time_month(ipt)],[nanmean(sla2_fit(1:ipt,3))*100 nanmean(sla2_fit(1:ipt,3))*100],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,mycolors(1,:),</span><span style="color: rgb(255, 153, 200);">'LineWidth'</span><span>,3)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plot([time_month(ipt) time_month(end)],[nanmean(sla2_fit(ipt:end,3))*100 nanmean(sla2_fit(ipt:end,3))*100],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,mycolors(2,:),</span><span style="color: rgb(255, 153, 200);">'LineWidth'</span><span>,3)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%text(datenum('19930701','yyyymmdd'),15,...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%    ['$\bf{\overline{SSH}_{pre-shift} = ',num2str(round(100*nanmean(sla2_TGB2_nomo(1:ipt)),1)),' cm}$'],...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%    'Interpreter','latex','FontName','Helvetica','FontSize',16,'color',mycolors(1,:))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%text(datenum('20120101','yyyymmdd'),-15,...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%    ['$\bf{\overline{SSH}_{post-shift} = ',num2str(round(100*nanmean(sla2_TGB2_nomo(ipt:end)),1)),' cm}$'],...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%    'Interpreter','latex','FontName','Helvetica','FontSize',16,'color',mycolors(2,:))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>datetick(</span><span style="color: rgb(255, 153, 200);">'x'</span><span>,</span><span style="color: rgb(255, 153, 200);">'yy'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>grid </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%ylim([-25 30]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ylim([-30 30]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>xlim([time_month(1) time_month(end)]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(gca,</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,14)</span><span style="color: rgb(0, 191, 191);">%,'xtick',[])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ylabel(</span><span style="color: rgb(255, 153, 200);">'SSH Anomaly (cm)'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>xlabel(</span><span style="color: rgb(255, 153, 200);">'Time (years)'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>box </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(gcf, </span><span style="color: rgb(255, 153, 200);">'Color'</span><span>, </span><span style="color: rgb(255, 153, 200);">'w'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>saveas(gcf,[output_dir,</span><span style="color: rgb(255, 153, 200);">'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_Figure2revised_pre'</span><span>],</span><span style="color: rgb(255, 153, 200);">'epsc'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clearvars </span><span style="color: rgb(255, 153, 200);">-except *_dir</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>close </span><span style="color: rgb(255, 153, 200);">all</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>figure(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>, [100, 200, 800, 350])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>axesm(</span><span style="color: rgb(255, 153, 200);">'MapProjection'</span><span>,</span><span style="color: rgb(255, 153, 200);">'eqdcylin'</span><span>,</span><span style="color: rgb(255, 153, 200);">'MapLatLimit'</span><span>,[36 46],</span><span style="color: rgb(255, 153, 200);">'MapLonLimit'</span><span>,[-75 -47])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>hold </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span class="warning_squiggle_rte1619232262">c1_aux</span><span> = contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),[-1000 -1000],</span><span style="color: rgb(255, 153, 200);">'k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c01_aux = contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),[-500 -500],</span><span style="color: rgb(255, 153, 200);">'k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>linem([36 36],[360-75 360-47],</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>linem([46 46],[360-75 360-47],</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>linem([36 46],[360-75 360-75],</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>linem([36 46],[360-47 360-47],</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>geoshow(</span><span style="color: rgb(255, 153, 200);">'landareas.shp'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FaceColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span><span style="color: rgb(0, 191, 191);">%[.7 .7 .7])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plabel(</span><span style="color: rgb(255, 153, 200);">'PLabelLocation'</span><span>,0.5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>mlabel(</span><span style="color: rgb(255, 153, 200);">'MLabelLocation'</span><span>,0.5,</span><span style="color: rgb(255, 153, 200);">'MLabelParallel'</span><span>,</span><span style="color: rgb(255, 153, 200);">'south'</span><span>,</span><span style="color: rgb(255, 153, 200);">'fontsize'</span><span>,14)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>framem</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>tightmap</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>gridm</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(gcf, </span><span style="color: rgb(255, 153, 200);">'Color'</span><span>, </span><span style="color: rgb(255, 153, 200);">'w'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%saveas(gcf,[output_dir,'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_isobaths'],'png')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%% Figure 3</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Set  directory to save data</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>data_dir = </span><span style="color: rgb(255, 153, 200);">'/Users/afonso/Documents/Research/TGB/data/'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Set directory to save figures and tables</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>output_dir = </span><span style="color: rgb(255, 153, 200);">'/Users/afonso/Documents/Research/TGB/output/'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>load([output_dir,</span><span style="color: rgb(255, 153, 200);">'etopo1_TGB.mat'</span><span>],</span><span style="color: rgb(255, 153, 200);">'lat_z'</span><span>,</span><span style="color: rgb(255, 153, 200);">'lon_z'</span><span>,</span><span style="color: rgb(255, 153, 200);">'z'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>load([output_dir,</span><span style="color: rgb(255, 153, 200);">'SSH_TGB.mat'</span><span>],</span><span style="color: rgb(255, 153, 200);">'time_month'</span><span>,</span><span style="color: rgb(255, 153, 200);">'lat_ssh'</span><span>,</span><span style="color: rgb(255, 153, 200);">'lon_ssh'</span><span>,</span><span style="color: rgb(255, 153, 200);">'u_g'</span><span>,</span><span style="color: rgb(255, 153, 200);">'v_g'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>load([data_dir,</span><span style="color: rgb(255, 153, 200);">'en4_NWA2.mat'</span><span>],</span><span style="color: rgb(255, 153, 200);">'lon_en4'</span><span>,</span><span style="color: rgb(255, 153, 200);">'lat_en4'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>figure(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>, [100, 200, 800, 600])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>axesm(</span><span style="color: rgb(255, 153, 200);">'MapProjection'</span><span>,</span><span style="color: rgb(255, 153, 200);">'eqdcylin'</span><span>,</span><span style="color: rgb(255, 153, 200);">'MapLatLimit'</span><span>,[30 60],</span><span style="color: rgb(255, 153, 200);">'MapLonLimit'</span><span>,[-80 -40])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>hold </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c1_aux = contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),[-500 -500],</span><span style="color: rgb(255, 153, 200);">'k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%c1_aux = contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),[-1000 -1000],'k','linewidth',1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>linem([36 36],[360-75 360-47],</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>linem([46 46],[360-75 360-47],</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>linem([36 46],[360-75 360-75],</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>linem([36 46],[360-47 360-47],</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>geoshow(</span><span style="color: rgb(255, 153, 200);">'landareas.shp'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FaceColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span><span style="color: rgb(0, 191, 191);">%[.7 .7 .7])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>close </span><span style="color: rgb(255, 153, 200);">all</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c1 = NaN(2,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>j = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 2:length(c1_aux)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">if </span><span>c1_aux(1,i)&gt;=360-75 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">&amp;</span><span> c1_aux(1,i)&lt;=360-47 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">&amp;</span><span> c1_aux(2,i)&gt;=36 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">&amp;</span><span> c1_aux(2,i)&lt;=46</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        c1(:,j) = c1_aux(:,i);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">if </span><span>j&gt;1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            </span><span style="color: rgb(237, 177, 32);">if </span><span>abs(c1_aux(1,i)-c1(1,j-1))&lt;0.2</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>                j = j+1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            </span><span style="color: rgb(237, 177, 32);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>                c1(:,j) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            j = j+1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear </span><span style="color: rgb(255, 153, 200);">i j</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">if </span><span>isnan(c1(1,end))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    c1 = c1(:,1:end-1);</span><span style="color: rgb(0, 191, 191);">% lon,lat of 1000m isobath</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c1(3,:) = zeros;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c1_dist = gsw_distance(c1(1,:),c1(2,:));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 2:length(c1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    c1(3,i) = sum(c1_dist(1:i-1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear </span><span style="color: rgb(255, 153, 200);">c1_aux c1_dist i</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Lat and Lon for TGB, slope and shelf</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>lon_ssh2 = lon_ssh(lon_ssh&gt;=360-75 &amp; lon_ssh&lt;=360-45);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>lat_ssh2 = lat_ssh(lat_ssh&gt;=36 &amp; lat_ssh&lt;=46);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[</span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">lon_ssh2_mesh</span><span>,</span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">lat_ssh2_mesh</span><span>] = meshgrid(lon_ssh2,lat_ssh2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>lon_z2 = lon_z(lon_z&gt;=360-75 &amp; lon_z&lt;=360-45);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>lat_z2 = lat_z(lat_z&gt;=36 &amp; lat_z&lt;=46);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[lon_z2_mesh,lat_z2_mesh] = meshgrid(lon_z2,lat_z2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span class="warning_squiggle_rte1619232262">z2</span><span> = z(lat_z&gt;=36 &amp; lat_z&lt;=46,lon_z&gt;=360-75 &amp; lon_z&lt;=360-45)';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Define velocity on different isobaths</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[lon_mesh </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">lat_mesh</span><span>] = meshgrid(lon_ssh,lat_ssh);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>u_z = NaN(length(lat_z2),length(lon_z2),size(u_g,3));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>v_z = NaN(length(lat_z2),length(lon_z2),size(v_g,3));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>t = 1:length(time_month)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    u_z(:,:,t) = interp2(lon_mesh,lat_mesh,u_g(:,:,t)',lon_z2_mesh,lat_z2_mesh);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    v_z(:,:,t) = interp2(lon_mesh,lat_mesh,v_g(:,:,t)',lon_z2_mesh,lat_z2_mesh);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% 1000m </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>u_1 = NaN(length(c1),length(time_month));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>v_1 = NaN(length(c1),length(time_month));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>t = 1:length(time_month)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    u_1(:,t) = interp2(lon_z2_mesh,lat_z2_mesh,u_z(:,:,t),c1(1,:),c1(2,:));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    v_1(:,t) = interp2(lon_z2_mesh,lat_z2_mesh,v_z(:,:,t),c1(1,:),c1(2,:));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear </span><span style="color: rgb(255, 153, 200);">u_z v_z z2 lon_z2* lat_z2* lon_ssh2* lat_ssh2* u_g v_g t</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Rotating velocities</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% magnitude of input vector</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>uv_in = sqrt(u_1.^2 + v_1.^2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>cross_1 = NaN(size(u_1,1)-1,size(u_1,2));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>along_1 = NaN(size(u_1,1)-1,size(u_1,2));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>cross_1_u = NaN(size(u_1,1)-1,size(u_1,2));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>cross_1_v = NaN(size(u_1,1)-1,size(u_1,2));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>along_1_u = NaN(size(u_1,1)-1,size(u_1,2));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>along_1_v = NaN(size(u_1,1)-1,size(u_1,2));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>cross_1_anom = NaN(size(u_1,1)-1,size(u_1,2));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>along_1_anom = NaN(size(u_1,1)-1,size(u_1,2));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>t = 1:length(time_month)-1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">for </span><span>i = 1:size(c1,2)-1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>                </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(0, 191, 191);">% direction of input vector (angle relative to north, increases clockwise)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">if </span><span>u_1(i,t) &gt;= 0 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">&amp;</span><span> v_1(i,t) &gt;= 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            theta_in = atand(u_1(i,t)/v_1(i,t));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            </span><span style="color: rgb(0, 191, 191);">%theta_in_aux = theta_in</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">elseif </span><span>u_1(i,t) &gt;= 0 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">&amp;</span><span> v_1(i,t) &lt; 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            theta_in = 180 + atand(u_1(i,t)/v_1(i,t));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            </span><span style="color: rgb(0, 191, 191);">%theta_in_aux = theta_in - 90</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">elseif </span><span>u_1(i,t) &lt; 0 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">&amp;</span><span> v_1(i,t) &lt; 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            theta_in = 180 + atand(u_1(i,t)/v_1(i,t));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            </span><span style="color: rgb(0, 191, 191);">%theta_in_aux = theta_in - 180</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">elseif </span><span>u_1(i,t) &lt; 0 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">&amp;</span><span> v_1(i,t) &gt;= 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            theta_in = 360 + atand(u_1(i,t)/v_1(i,t));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            </span><span style="color: rgb(0, 191, 191);">%theta_in_aux = theta_in - 270</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(0, 191, 191);">% direction of speed (angle relative to north, increases clockwise)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">if </span><span>(c1(2,i+1)-c1(2,i)) &gt;= 0 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">&amp;</span><span> (c1(1,i+1)-c1(1,i)) &gt;= 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            theta_rot = atand((c1(1,i+1)-c1(1,i))/(c1(2,i+1)-c1(2,i)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            </span><span style="color: rgb(0, 191, 191);">%theta_rot_aux = 90 - theta_rot</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">elseif </span><span>(c1(2,i+1)-c1(2,i)) &lt; 0 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">&amp;</span><span> (c1(1,i+1)-c1(1,i)) &gt;= 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            theta_rot = 180 + atand((c1(1,i+1)-c1(1,i))/(c1(2,i+1)-c1(2,i)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            </span><span style="color: rgb(0, 191, 191);">%theta_rot_aux = 180 - theta_rot</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">elseif </span><span>(c1(2,i+1)-c1(2,i)) &lt; 0 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">&amp;</span><span> (c1(1,i+1)-c1(1,i)) &lt; 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            theta_rot = 180 + atand((c1(1,i+1)-c1(1,i))/(c1(2,i+1)-c1(2,i)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            </span><span style="color: rgb(0, 191, 191);">%theta_rot_aux = 270 - theta_rot</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">elseif </span><span>(c1(2,i+1)-c1(2,i)) &gt;= 0 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">&amp;</span><span> (c1(1,i+1)-c1(1,i)) &lt; 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            theta_rot = 360 + atand((c1(1,i+1)-c1(1,i))/(c1(2,i+1)-c1(2,i)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            </span><span style="color: rgb(0, 191, 191);">%theta_rot_aux = 360 - theta_rot</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(0, 191, 191);">% direction of speed relative to the new coordinate system</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">if </span><span>theta_in &gt; theta_rot</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            theta_out = theta_in - theta_rot;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            theta_out = 360 - theta_rot + theta_in;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        cross_1(i,t) = uv_in(i,t) * sind(theta_out);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        along_1(i,t) = uv_in(i,t) * cosd(theta_out);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        uv_out = sqrt(along_1.^2 + cross_1.^2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        along_1_u(i,t) = along_1(i,t) * sind(theta_rot);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        along_1_v(i,t) = along_1(i,t) * cosd(theta_rot);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">if </span><span>theta_rot + 90 &gt; 360</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            cross_1_u(i,t) = cross_1(i,t) * sind(theta_rot-270);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            cross_1_v(i,t) = cross_1(i,t) * cosd(theta_rot-270);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            cross_1_u(i,t) = cross_1(i,t) * sind(theta_rot+90);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            cross_1_v(i,t) = cross_1(i,t) * cosd(theta_rot+90);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        clear </span><span style="color: rgb(255, 153, 200);">theta*</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear </span><span style="color: rgb(255, 153, 200);">i t</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Calculate anomalies</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 1:size(c1,2)-1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    along_1_anom(i,:) = along_1(i,:) - nanmean(along_1(i,:));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    cross_1_anom(i,:) = cross_1(i,:) - nanmean(cross_1(i,:));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Remove seasonality</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% calculate monthly averages</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>along_1_mo = NaN(size(along_1,1),12);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>cross_1_mo = NaN(size(along_1,1),12);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>j = 1:size(along_1,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">for </span><span>i = 1:12</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        along_1_mo(j,i) = nanmean(along_1(j,i:12:25*12+i));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        cross_1_mo(j,i) = nanmean(cross_1(j,i:12:25*12+i));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% remove monthly averages</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>along_1_nomo = NaN(size(along_1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>cross_1_nomo = NaN(size(along_1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>j = 1:size(along_1,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">for </span><span>i = 1:26</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        along_1_nomo(j,i*12-11:i*12) = along_1(j,i*12-11:i*12) - along_1_mo(j,:);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        cross_1_nomo(j,i*12-11:i*12) = cross_1(j,i*12-11:i*12) - cross_1_mo(j,:);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Calculate lagged correlations (deseasonalized)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% along_nomo_corrlag = NaN(size(along_1_nomo,1)-40,61);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% along_nomo_p = NaN(size(along_1_nomo,1)-40,61);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% along_nomo_pl = NaN(size(along_1_nomo,1)-40,61);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% along_nomo_pu = NaN(size(along_1_nomo,1)-40,61);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% for i = 41:size(along_1,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%     for l = 0:60</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%         [aux_corr,aux_p,aux_pl,aux_pu] = corrcoef(along_1_nomo(41,1:end-1-l),along_1_nomo(i,1+l:end-1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%         along_nomo_corrlag(i-40,l+1) = aux_corr(1,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%         along_nomo_p(i-40,l+1) = aux_p(1,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%         along_nomo_pl(i-40,l+1) = aux_pl(1,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%         along_nomo_pu(i-40,l+1) = aux_pu(1,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%         clear aux_corr aux_p aux_pl aux_pu</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%     end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>along_nomo_corrlag = NaN(size(along_1_nomo,1),61);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>along_nomo_p = NaN(size(along_1_nomo,1),61);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>along_nomo_pl = NaN(size(along_1_nomo,1),61);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>along_nomo_pu = NaN(size(along_1_nomo,1),61);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 1:size(along_1,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">for </span><span>l = -12:48</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">if </span><span>l&gt;=0</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            [aux_corr,aux_p,aux_pl,aux_pu] = corrcoef(along_1_nomo(41,1:end-1-l),along_1_nomo(i,1+l:end-1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            [aux_corr,aux_p,aux_pl,aux_pu] = corrcoef(along_1_nomo(41,1-l:end-1),along_1_nomo(i,1:end-1+l));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        along_nomo_corrlag(i,l+13) = aux_corr(1,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        along_nomo_p(i,l+13) = aux_p(1,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        along_nomo_pl(i,l+13) = aux_pl(1,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        along_nomo_pu(i,l+13) = aux_pu(1,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        clear </span><span style="color: rgb(255, 153, 200);">aux_corr aux_p aux_pl aux_pu</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% T149 from Joe</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%T2 = readtable('Z149mat2.xlsx','TreatAsEmpty',["NA"]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T = readtable(</span><span style="color: rgb(255, 153, 200);">'Z149mat22.csv'</span><span>, </span><span style="color: rgb(255, 153, 200);">'HeaderLines'</span><span>,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T1 = table2array(T);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T1(T1==0) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T149_change_point = NaN(1,1271);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T149_change = NaN(1,1271);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>j = 1:1271</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">if </span><span>sum(~isnan(T1(:,j))) &gt;= 1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        T149_change_point(1,j) = find(~isnan(T1(:,j)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        T149_change(1,j) = T1(T149_change_point(1,j),j);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%     aux = T1(:,j);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%     aux1 = ~isnan(T1(:,j))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%     for i = 1:264</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%         aux = ~isnan(T1(i,j));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%         %aux = strcmp(T1(i,j),{'NA'});</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%         if aux==0</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%             T149_change_point(1,j) = i;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%             T149_change(1,j) = T1(i,j);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%         end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%     end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T149_change_reshape = reshape(T149_change,41,31);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T149_change_point_reshape = reshape(T149_change_point,41,31);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Set window to Jan/2009 to Dec/2011</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T149_change_reshape_20092011 = T149_change_reshape;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span class="warning_squiggle_rte1619232262">T149_change_reshape_20092011</span><span>(T149_change_point_reshape&lt;193 | T149_change_point_reshape&gt;228) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T149_change_point_reshape_20092011 = T149_change_point_reshape;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T149_change_point_reshape_20092011(T149_change_point_reshape&lt;193 | T149_change_point_reshape&gt;228) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[lon_en4_mesh,lat_en4_mesh] = meshgrid(lon_en4,lat_en4);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[lon_mab,lat_mab] = find(T149_change_point_reshape_20092011&gt;=217 &amp; lon_en4_mesh' &lt; 295 &amp; lon_en4_mesh' &gt; 283 &amp; lat_en4_mesh' &gt; 33);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[lon_gom,lat_gom] = find(T149_change_point_reshape_20092011&gt;=202 &amp; T149_change_point_reshape_20092011&lt;=213 &amp; lon_en4_mesh' &lt; 298);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[lon_ss,lat_ss] = find(T149_change_point_reshape_20092011&gt;=193 &amp; T149_change_point_reshape_20092011&lt;=201 &amp; lon_en4_mesh' &lt;= 299);</span><span style="color: rgb(0, 191, 191);">% &amp; lat_en4_mesh' &lt; 46);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[lon_lc,lat_lc] = find(T149_change_point_reshape_20092011&gt;=193 &amp; T149_change_point_reshape_20092011&lt;=201 &amp; lon_en4_mesh' &gt;= 300);</span><span style="color: rgb(0, 191, 191);">% &amp; lat_en4_mesh' &lt; 46);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>figure(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>, [100, 200, 600, 650])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sp1 = subplot(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,[0.08 0.69 0.82 0.25]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>hold </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%pcolor(c1(3,41:end-1)/1000,0:20,along_nomo_corrlag(:,1:21)')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>pcolor(c1(3,1:end-1)/1000,-6:18,along_nomo_corrlag(:,7:31)')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>shading </span><span style="color: rgb(255, 153, 200);">interp</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%colormap jet</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%colormap(sp1,cmocean('balance',28,'pivot',0.18))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>colormap(sp1,crameri(</span><span style="color: rgb(255, 153, 200);">'vik'</span><span>,28,</span><span style="color: rgb(255, 153, 200);">'pivot'</span><span>,0.18))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c = colorbar;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c.Label.String = </span><span style="color: rgb(255, 153, 200);">'Corr Coef'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%c.Ticks = [-0.2 -0.16 -0.12 -0.08 -0.04 0 0.04 0.08 0.12 0.20 0.28 0.36 0.44 0.52 0.60 0.68 0.76 0.84 0.92 1]</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(c,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,14)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>caxis([-0.1 0.6])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%cbarrow</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%contour(c1(3,41:end-1)/1000,0:20,along_nomo_p(:,1:21)',[0.05 0.05],'w','linewidth',3)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contour(c1(3,1:end-1)/1000,-6:18,along_nomo_p(:,7:31)',[0.05 0.05],</span><span style="color: rgb(255, 153, 200);">'w'</span><span>,</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,3)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%contour(c1(3,41:end-1)/1000,0:20,along_nomo_corrlag(:,1:21)',[0.12 0.12],'y','linewidth',3)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%contour(0:60,c1(3,41:end-1)/1000,along_nomo_corrlag,[0.18 0.18],'y','linewidth',3)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>dd = linspace(500,2283,10);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>tt = linspace(0,13,10);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plot(dd,tt,</span><span style="color: rgb(255, 153, 200);">'k--'</span><span>,</span><span style="color: rgb(255, 153, 200);">'LineWidth'</span><span>,4)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plot([c1(3,36)/1000 c1(3,36)/1000],[-6 18],</span><span style="color: rgb(255, 153, 200);">':k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'LineWidth'</span><span>,2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plot([c1(3,94)/1000 c1(3,94)/1000],[-6 18],</span><span style="color: rgb(255, 153, 200);">':k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'LineWidth'</span><span>,2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%text(c1(3,94)/1000,20.2,'Laurentian Channel','FontSize',14,'FontWeight','bold')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plot([c1(3,165)/1000 c1(3,165)/1000],[-6 18],</span><span style="color: rgb(255, 153, 200);">':k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'LineWidth'</span><span>,2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%text(c1(3,165)/1000,20.2,'Northeast Channel','FontSize',14,'FontWeight','bold')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plot([c1(3,196)/1000 c1(3,196)/1000],[-6 18],</span><span style="color: rgb(255, 153, 200);">':k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'LineWidth'</span><span>,2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%text(c1(3,196)/1000,20.2,'Great South Channel','FontSize',14,'FontWeight','bold')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%set(gca,'xdir','reverse','FontSize',14)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ax1=gca;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(ax1,</span><span style="color: rgb(255, 153, 200);">'xdir'</span><span>,</span><span style="color: rgb(255, 153, 200);">'reverse'</span><span>,</span><span style="color: rgb(255, 153, 200);">'xtick'</span><span>,[c1(3,36)/1000,(c1(3,36)/1000)+500,</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    (c1(3,36)/1000)+1000,(c1(3,36)/1000)+1500,(c1(3,36)/1000)+2000,</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    (c1(3,36)/1000)+2500],</span><span style="color: rgb(255, 153, 200);">'xticklabel'</span><span>,</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    [{0};{500};{1000};{1500};{2000};{2500};],</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,14)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>xlabel(</span><span style="color: rgb(255, 153, 200);">'Distance (km)'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,14)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ylabel(</span><span style="color: rgb(255, 153, 200);">'Lag (months)'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,14)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ax2 = axes(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>, get(ax1, </span><span style="color: rgb(255, 153, 200);">'Position'</span><span>),</span><span style="color: rgb(255, 153, 200);">'Color'</span><span>, </span><span style="color: rgb(255, 153, 200);">'none'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(ax2, </span><span style="color: rgb(255, 153, 200);">'XLim'</span><span>, get(ax1, </span><span style="color: rgb(255, 153, 200);">'XLim'</span><span>),</span><span style="color: rgb(255, 153, 200);">'YLim'</span><span>, get(ax1, </span><span style="color: rgb(255, 153, 200);">'YLim'</span><span>));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(ax2, </span><span style="color: rgb(255, 153, 200);">'XTick'</span><span>, get(ax1, </span><span style="color: rgb(255, 153, 200);">'XTick'</span><span>), </span><span style="color: rgb(255, 153, 200);">'YTick'</span><span>, get(ax1, </span><span style="color: rgb(255, 153, 200);">'YTick'</span><span>));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(ax2, </span><span style="color: rgb(255, 153, 200);">'XAxisLocation'</span><span>,</span><span style="color: rgb(255, 153, 200);">'top'</span><span>,</span><span style="color: rgb(255, 153, 200);">'ytick'</span><span>,[],</span><span style="color: rgb(255, 153, 200);">'xdir'</span><span>,</span><span style="color: rgb(255, 153, 200);">'reverse'</span><span>,</span><span style="color: rgb(255, 153, 200);">'xtick'</span><span>,[c1(3,36)/1000,c1(3,94)/1000,c1(3,165)/1000,c1(3,196)/1000,c1(3,end-1)/1000],</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(255, 153, 200);">'xticklabel'</span><span>,[{</span><span style="color: rgb(255, 153, 200);">'TGB'</span><span>};{</span><span style="color: rgb(255, 153, 200);">'LCh'</span><span>};{</span><span style="color: rgb(255, 153, 200);">'NECh'</span><span>};{</span><span style="color: rgb(255, 153, 200);">'GSCh'</span><span>};{</span><span style="color: rgb(255, 153, 200);">'CH'</span><span>}],</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,14)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%title('Along-slope velocity from TGB')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(gcf, </span><span style="color: rgb(255, 153, 200);">'Color'</span><span>, </span><span style="color: rgb(255, 153, 200);">'w'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sp2 = subplot(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,[0.08 0.06 0.86 0.6]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>axesm(</span><span style="color: rgb(255, 153, 200);">'MapProjection'</span><span>,</span><span style="color: rgb(255, 153, 200);">'eqdcylin'</span><span>,</span><span style="color: rgb(255, 153, 200);">'MapLatLimit'</span><span>,[33 50],</span><span style="color: rgb(255, 153, 200);">'MapLonLimit'</span><span>,[-77 -48])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>hold </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%t_diff = t10002000_en4_2009_2018' - t10002000_en4_2001_2007';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>pcolorm(lat_en4,lon_en4,T149_change_point_reshape_20092011')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>shading </span><span style="color: rgb(255, 153, 200);">flat</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%caxis([min(min(T149_change_point_reshape)) max(max(T149_change_point_reshape))])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%colormap(sp2,cmocean('curl',12))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>colormap(sp2,crameri(</span><span style="color: rgb(255, 153, 200);">'nuuk'</span><span>,12))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%colormap(sp2,linspecer(12,'sequential'))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%h = colorbar;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>caxis([193 229])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%ylabel(h,'Time of Change Point','Fontsize',14)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%set(h,'Fontsize',14,'ytick',[193;199;205;211;217;223],'yticklabel',[datestr(time_ssh(193),'mmmyy');datestr(time_ssh(199),'mmmyy');datestr(time_ssh(205),'mmmyy');datestr(time_ssh(211),'mmmyy');datestr(time_ssh(217),'mmmyy');datestr(time_ssh(223),'mmmyy')])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-100 -100],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-1000 -1000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-3000 -3000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-4000 -4000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>fillm([33.1,33.1,36.2,36.2],[-65,-48.1,-48.1,-65],</span><span style="color: rgb(255, 153, 200);">'facecolor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>,</span><span style="color: rgb(255, 153, 200);">'edgecolor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c = colorbar(</span><span style="color: rgb(255, 153, 200);">'Orientation'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Horizontal'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,[0.51 0.162 0.32 0.048],</span><span style="color: rgb(255, 153, 200);">'Color'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,10);</span><span style="color: rgb(0, 191, 191);">%colorbar over land</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c.Label.String = </span><span style="color: rgb(255, 153, 200);">'T_{149m} Change Point'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(c,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,14,</span><span style="color: rgb(255, 153, 200);">'ytick'</span><span>,[193;211;229],</span><span style="color: rgb(255, 153, 200);">'yticklabel'</span><span>,[datestr(time_month(193),</span><span style="color: rgb(255, 153, 200);">'mmmyy'</span><span>);datestr(time_month(211),</span><span style="color: rgb(255, 153, 200);">'mmmyy'</span><span>);datestr(time_month(229),</span><span style="color: rgb(255, 153, 200);">'mmmyy'</span><span>)])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%scatterm(lat_en4(lat_mab)+0.5,lon_en4(lon_mab)+0.5,20,plotcolor(2,:),'o','filled')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%scatterm(lat_en4(lat_gom)+0.5,lon_en4(lon_gom)+0.5,20,plotcolor(4,:),'o','filled')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>scatterm(lat_en4(lat_lc)+0.5,lon_en4(lon_lc)+0.5,20,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>,</span><span style="color: rgb(255, 153, 200);">'o'</span><span>,</span><span style="color: rgb(255, 153, 200);">'filled'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>scatterm(lat_en4(lat_ss)+0.5,lon_en4(lon_ss)+0.5,20,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'+'</span><span>,</span><span style="color: rgb(255, 153, 200);">'LineWidth'</span><span>,1.5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>scatterm(lat_en4(lat_gom)+0.5,lon_en4(lon_gom)+0.5,20,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>,</span><span style="color: rgb(255, 153, 200);">'^'</span><span>,</span><span style="color: rgb(255, 153, 200);">'filled'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>scatterm(lat_en4(lat_mab)+0.5,lon_en4(lon_mab)+0.5,20,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'x'</span><span>,</span><span style="color: rgb(255, 153, 200);">'LineWidth'</span><span>,2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>linem([44.5 46],[360-56.3 360-57.8],</span><span style="color: rgb(255, 153, 200);">':w'</span><span>,</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,3)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>linem([41.6 42.6],[360-65 360-67],</span><span style="color: rgb(255, 153, 200);">':w'</span><span>,</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,3)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>linem([41 41.9],[360-69 360-69],</span><span style="color: rgb(255, 153, 200);">':k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,3)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>linem([40.4 41],[360-69 360-69],</span><span style="color: rgb(255, 153, 200);">':k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,3)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>textm(46,360-57,</span><span style="color: rgb(255, 153, 200);">'LCh'</span><span>,</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,14,</span><span style="color: rgb(255, 153, 200);">'Fontweight'</span><span>,</span><span style="color: rgb(255, 153, 200);">'bold'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>textm(43,360-67,</span><span style="color: rgb(255, 153, 200);">'NECh'</span><span>,</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,14,</span><span style="color: rgb(255, 153, 200);">'Fontweight'</span><span>,</span><span style="color: rgb(255, 153, 200);">'bold'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>textm(40,360-71.3,</span><span style="color: rgb(255, 153, 200);">'GSCh'</span><span>,</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,14,</span><span style="color: rgb(255, 153, 200);">'Fontweight'</span><span>,</span><span style="color: rgb(255, 153, 200);">'bold'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>textm(35,360-75.3,</span><span style="color: rgb(255, 153, 200);">'CH'</span><span>,</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,14,</span><span style="color: rgb(255, 153, 200);">'Fontweight'</span><span>,</span><span style="color: rgb(255, 153, 200);">'bold'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(gca,</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,14)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>geoshow(</span><span style="color: rgb(255, 153, 200);">'GSHHS_i_L1.shp'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FaceColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span><span style="color: rgb(0, 191, 191);">%[.7 .7 .7])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plabel(</span><span style="color: rgb(255, 153, 200);">'PLabelLocation'</span><span>,5,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,14)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>mlabel(</span><span style="color: rgb(255, 153, 200);">'MLabelLocation'</span><span>,5,</span><span style="color: rgb(255, 153, 200);">'MLabelParallel'</span><span>,</span><span style="color: rgb(255, 153, 200);">'south'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,14)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%title('Change Point of 150-m Deseasonalized Temperature (1993-2018)','fontsize',16)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>framem</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>tightmap</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(gcf, </span><span style="color: rgb(255, 153, 200);">'Color'</span><span>, </span><span style="color: rgb(255, 153, 200);">'w'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>saveas(gcf,[output_dir,</span><span style="color: rgb(255, 153, 200);">'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_Figure3revised_pre'</span><span>],</span><span style="color: rgb(255, 153, 200);">'epsc'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clearvars </span><span style="color: rgb(255, 153, 200);">-except *_dir</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>close </span><span style="color: rgb(255, 153, 200);">all</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%% Figure 4</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Set  directory to save data</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>data_dir = </span><span style="color: rgb(255, 153, 200);">'/Users/afonso/Documents/Research/TGB/data/'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Set directory to save figures and tables</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>output_dir = </span><span style="color: rgb(255, 153, 200);">'/Users/afonso/Documents/Research/TGB/output/'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>load([data_dir,</span><span style="color: rgb(255, 153, 200);">'EN4_profiles_TGB_AMJ_dec_postQC_toplot.mat'</span><span>],</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(255, 153, 200);">'T_series1'</span><span>,</span><span style="color: rgb(255, 153, 200);">'S_series1'</span><span>,</span><span style="color: rgb(255, 153, 200);">'p_interp'</span><span>,</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(255, 153, 200);">'t_lc_series1'</span><span>,</span><span style="color: rgb(255, 153, 200);">'s_lc_series1'</span><span>,</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(255, 153, 200);">'t_gs_series1'</span><span>,</span><span style="color: rgb(255, 153, 200);">'s_gs_series1'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>load([output_dir,</span><span style="color: rgb(255, 153, 200);">'etopo1_TGB.mat'</span><span>],</span><span style="color: rgb(255, 153, 200);">'lat_z'</span><span>,</span><span style="color: rgb(255, 153, 200);">'lon_z'</span><span>,</span><span style="color: rgb(255, 153, 200);">'z'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>year = </span><span class="warning_squiggle_rte1619232262">[</span><span>1930:10:2020];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Joe's temperature maps</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T2 = readtable(</span><span style="color: rgb(255, 153, 200);">'Z149mat2.xlsx'</span><span>,</span><span style="color: rgb(255, 153, 200);">'TreatAsEmpty'</span><span>,</span><span class="warning_squiggle_rte1619232262">[</span><span style="color: rgb(255, 153, 200);">"NA"</span><span>]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T = readtable(</span><span style="color: rgb(255, 153, 200);">'Z149mat2.csv'</span><span>, </span><span style="color: rgb(255, 153, 200);">'HeaderLines'</span><span>,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T1 = table2array(T);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T1(T1==0) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T149_change_point = NaN(1,1271);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T149_change = NaN(1,1271);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>j = 1:1271</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">if </span><span>sum(~isnan(T1(:,j))) &gt;= 1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        T149_change_point(1,j) = find(~isnan(T1(:,j)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        T149_change(1,j) = T1(T149_change_point(1,j),j);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%     aux = T1(:,j);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%     aux1 = ~isnan(T1(:,j))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%     for i = 1:264</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%         aux = ~isnan(T1(i,j));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%         %aux = strcmp(T1(i,j),{'NA'});</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%         if aux==0</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%             T149_change_point(1,j) = i;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%             T149_change(1,j) = T1(i,j);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%         end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%     end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T149_change_reshape = reshape(T149_change,41,31);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T149_change_point_reshape = reshape(T149_change_point,41,31);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Set window to Jan/2009 to Dec/2011</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T149_change_reshape_20092011 = T149_change_reshape;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span class="warning_squiggle_rte1619232262">T149_change_reshape_20092011</span><span>(T149_change_point_reshape&lt;193 | T149_change_point_reshape&gt;228) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T149_change_point_reshape_20092011 = T149_change_point_reshape;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T149_change_point_reshape_20092011(T149_change_point_reshape&lt;193 | T149_change_point_reshape&gt;228) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%load([output_dir,'etopo1_TGB.mat'],'lat_z','lon_z','z')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%load([output_dir,'SSH_TGB.mat'],'time_month','lat_ssh','lon_ssh','u_g','v_g')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>load([data_dir,</span><span style="color: rgb(255, 153, 200);">'en4_NWA2.mat'</span><span>],</span><span style="color: rgb(255, 153, 200);">'t_en4'</span><span>,</span><span style="color: rgb(255, 153, 200);">'t_unc_en4'</span><span>,</span><span style="color: rgb(255, 153, 200);">'lon_en4'</span><span>,</span><span style="color: rgb(255, 153, 200);">'lat_en4'</span><span>,</span><span style="color: rgb(255, 153, 200);">'time_en4'</span><span>,</span><span class="warning_squiggle_rte1619232262" style="color: rgb(255, 153, 200);">'depth_en4'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span class="warning_squiggle_rte1619232262">time_ssh</span><span> = time_en4(93*12+1:end-9);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>t_en4 = t_en4 - 273.15;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[lon_en4_mesh,lat_en4_mesh] = meshgrid(lon_en4,lat_en4);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[lon_mab,lat_mab] = find(T149_change_point_reshape_20092011&gt;=217 &amp; lon_en4_mesh' &lt; 295);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[lon_gom,lat_gom] = find(T149_change_point_reshape_20092011&gt;=202 &amp; T149_change_point_reshape_20092011&lt;=213 &amp; lon_en4_mesh' &lt; 298);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[lon_ss,lat_ss] = find(T149_change_point_reshape_20092011&gt;=196 &amp; T149_change_point_reshape_20092011&lt;=201 &amp; lon_en4_mesh' &lt;= 299);</span><span style="color: rgb(0, 191, 191);">% &amp; lat_en4_mesh' &lt; 46);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[lon_lc,lat_lc] = find(T149_change_point_reshape_20092011&gt;=196 &amp; T149_change_point_reshape_20092011&lt;=201 &amp; lon_en4_mesh' &gt;= 300);</span><span style="color: rgb(0, 191, 191);">% &amp; lat_en4_mesh' &lt; 46);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[lon_sslc,lat_sslc] = find(T149_change_point_reshape_20092011&gt;=193 &amp; T149_change_point_reshape_20092011&lt;=201 &amp; lon_en4_mesh' &lt; 310);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>t149_1930_2018 = squeeze(t_en4(:,:,14,30*12+1:end-9));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>t149_1930_2018_unc = squeeze(t_unc_en4(:,:,14,30*12+1:end-9));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>time_1930_2018 = time_en4(30*12+1:end-9);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% MAB</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 1:length(lat_mab)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span class="warning_squiggle_rte1619232262">t149_mab_aux</span><span>(i,:) = squeeze(t149_1930_2018(lon_mab(i),lat_mab(i),:));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span class="warning_squiggle_rte1619232262">t149_mab_unc_aux</span><span>(i,:) = squeeze(t149_1930_2018_unc(lon_mab(i),lat_mab(i),:));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>t149_mab = nanmean(t149_mab_aux,1)';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>t149_mab_unc = sqrt(nanmean(t149_mab_unc_aux,1).^2 + nanstd(t149_mab_aux,1).^2)';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear </span><span style="color: rgb(255, 153, 200);">t_149_mab_aux t149_mab_unc_aux i</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% GoM</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 1:length(lat_gom)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span class="warning_squiggle_rte1619232262">t149_gom_aux</span><span>(i,:) = squeeze(t149_1930_2018(lon_gom(i),lat_gom(i),:));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span class="warning_squiggle_rte1619232262">t149_gom_unc_aux</span><span>(i,:) = squeeze(t149_1930_2018_unc(lon_gom(i),lat_gom(i),:));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>t149_gom = nanmean(t149_gom_aux,1)';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>t149_gom_unc = sqrt(nanmean(t149_gom_unc_aux,1).^2 + nanstd(t149_gom_aux,1).^2)';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear </span><span style="color: rgb(255, 153, 200);">t_149_ss_aux t149_gom_unc_aux i</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% SS</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 1:length(lat_ss)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span class="warning_squiggle_rte1619232262">t149_ss_aux</span><span>(i,:) = squeeze(t149_1930_2018(lon_ss(i),lat_ss(i),:));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span class="warning_squiggle_rte1619232262">t149_ss_unc_aux</span><span>(i,:) = squeeze(t149_1930_2018_unc(lon_ss(i),lat_ss(i),:));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>t149_ss = nanmean(t149_ss_aux,1)';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>t149_ss_unc = sqrt(nanmean(t149_ss_unc_aux,1).^2 + nanstd(t149_ss_aux,1).^2)';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear </span><span style="color: rgb(255, 153, 200);">t_149_ss_aux t149_ss_unc_aux i</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% LC</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 1:length(lat_lc)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span class="warning_squiggle_rte1619232262">t149_lc_aux</span><span>(i,:) = squeeze(t149_1930_2018(lon_lc(i),lat_lc(i),:));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span class="warning_squiggle_rte1619232262">t149_lc_unc_aux</span><span>(i,:) = squeeze(t149_1930_2018_unc(lon_lc(i),lat_lc(i),:));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>t149_lc = nanmean(t149_lc_aux,1)';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>t149_lc_unc = sqrt(nanmean(t149_lc_unc_aux,1).^2 + nanstd(t149_lc_aux,1).^2)';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear </span><span style="color: rgb(255, 153, 200);">t_149_lc_aux t149_lc_unc_aux i</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% SS + LC</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 1:length(lat_sslc)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span class="warning_squiggle_rte1619232262">t149_sslc_aux</span><span>(i,:) = squeeze(t149_1930_2018(lon_sslc(i),lat_sslc(i),:));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span class="warning_squiggle_rte1619232262">t149_sslc_unc_aux</span><span>(i,:) = squeeze(t149_1930_2018_unc(lon_sslc(i),lat_sslc(i),:));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>t149_sslc = nanmean(t149_sslc_aux,1)';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>t149_sslc_unc = sqrt(nanmean(t149_sslc_unc_aux,1).^2 + nanstd(t149_sslc_aux,1).^2)';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear </span><span style="color: rgb(255, 153, 200);">t_149_sslc_aux t149_sslc_unc_aux i</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% numbers for paper</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>nanmean(t149_sslc(1:120))</span><span style="color: rgb(0, 191, 191);">% 1930s mean 7.3325</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>nanstd(t149_sslc(1:120))</span><span style="color: rgb(0, 191, 191);">% 1930s std 0.8949</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>nanmean(t149_sslc(120+1:120*3))</span><span style="color: rgb(0, 191, 191);">% 1940s-1950s mean 8.5931</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>nanstd(t149_sslc(120+1:120*3))</span><span style="color: rgb(0, 191, 191);">% 1940s-1950s std 0.9221</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>nanmean(t149_sslc(120*3+1:120*4))</span><span style="color: rgb(0, 191, 191);">% 1960s mean 7.7460</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>nanstd(t149_sslc(120*3+1:120*4))</span><span style="color: rgb(0, 191, 191);">% 1960s std 0.9253</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>nanmean(t149_sslc(120*4+1:120*8))</span><span style="color: rgb(0, 191, 191);">% 1970s-2000s mean 9.0755</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>nanstd(t149_sslc(120*4+1:120*8))</span><span style="color: rgb(0, 191, 191);">% 1970s-2000s std 0.8392</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>nanmean(t149_sslc(120*4+1:120*5))</span><span style="color: rgb(0, 191, 191);">% 1970s mean 9.1049</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>nanstd(t149_sslc(120*4+1:120*5))</span><span style="color: rgb(0, 191, 191);">% 1970s std 0.0.7568</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>nanmean(t149_sslc(120*5+1:120*6))</span><span style="color: rgb(0, 191, 191);">% 1980s mean 8.9779</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>nanstd(t149_sslc(120*5+1:120*6))</span><span style="color: rgb(0, 191, 191);">% 1980s std 0.8340</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>nanmean(t149_sslc(120*6+1:120*7))</span><span style="color: rgb(0, 191, 191);">% 1990s mean 8.9692</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>nanstd(t149_sslc(120*6+1:120*7))</span><span style="color: rgb(0, 191, 191);">% 1990s std 0.8428</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>nanmean(t149_sslc(120*7+1:120*8))</span><span style="color: rgb(0, 191, 191);">% 2000s mean 9.2500</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>nanstd(t149_sslc(120*7+1:120*8))</span><span style="color: rgb(0, 191, 191);">% 2000s std 0.8966</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>nanmean(t149_sslc(120*8+1:end))</span><span style="color: rgb(0, 191, 191);">% 2010s mean 10.6554</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>nanstd(t149_sslc(120*8+1:end))</span><span style="color: rgb(0, 191, 191);">% 2010s std 0.6889</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>t149_sslc_yr = NaN(89,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 1:89</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    t149_sslc_yr(i,1) = nanmean(t149_sslc(i*12-11:i*12));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>t149_sslc_yr_sort = NaN(89,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[t149_sslc_yr_sort(:,2),aux] = sort(t149_sslc_yr,</span><span style="color: rgb(255, 153, 200);">'descend'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>t149_sslc_yr_sort(:,1) = aux + 1929;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear </span><span style="color: rgb(255, 153, 200);">aux</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Plot T-S diagram (make it look nice)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 1:length(year)-1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span class="warning_squiggle_rte1619232262">S_series11</span><span>(:,i) = gsw_SA_from_SP(S_series1(:,i),p_interp,-50.5,42.5);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span class="warning_squiggle_rte1619232262">T_series11</span><span>(:,i) = gsw_pt0_from_t(S_series11(:,i),T_series1(:,i),p_interp);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span class="warning_squiggle_rte1619232262">s_lc_series11</span><span>(:,i) = gsw_SA_from_SP(s_lc_series1(:,i),p_interp,-50.5,42.5);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span class="warning_squiggle_rte1619232262">t_lc_series11</span><span>(:,i) = gsw_pt0_from_t(s_lc_series11(:,i),t_lc_series1(:,i),p_interp);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span class="warning_squiggle_rte1619232262">s_gs_series11</span><span>(:,i) = gsw_SA_from_SP(s_gs_series1(:,i),p_interp,-50.5,42.5);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span class="warning_squiggle_rte1619232262">t_gs_series11</span><span>(:,i) = gsw_pt0_from_t(s_gs_series11(:,i),t_gs_series1(:,i),p_interp);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>theta=T_series11(:);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>s=S_series11(:);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>smin=min(s)-0.01.*min(s);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>smax=max(s)+0.03.*max(s);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>thetamin=min(theta)-0.5*max(theta);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>thetamax=max(theta)+0.8*max(theta);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>xdim=round((smax-smin)./0.1+1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ydim=round((thetamax-thetamin)+1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>dens=zeros(ydim,xdim);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>thetai=((1:ydim)-1)*1+thetamin;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>si=((1:xdim)-1)*0.1+smin;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>disp(xdim);disp(ydim);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>j=1:ydim</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">for </span><span>i=1:xdim</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        dens(j,i)=gsw_sigma0(si(i),thetai(j));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% % smooth profiles</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% t_tail_series_smooth = NaN(size(t_tail_series));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% s_tail_series_smooth = NaN(size(s_tail_series));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% for i = 4:12</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%     t_tail_series_smooth(i,:) = smooth(p_interp,t_tail_series(i,:),0.15,'rloess');</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%     s_tail_series_smooth(i,:) = smooth(p_interp,s_tail_series(i,:),0.15,'rloess');</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>myscatter1 = varycolor(11);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>myscatter2 = linspecer(11);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>figure(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>, [100, 200, 600, 800])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>subplot(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,[0.08 0.38 0.88 0.58])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>xlabel(</span><span style="color: rgb(255, 153, 200);">'Absolute Salinity'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,14)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ylabel(</span><span style="color: rgb(255, 153, 200);">'Potential Temperature (^\circC)'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,14)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>hold </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i=1:9</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>eval([</span><span style="color: rgb(255, 153, 200);">'s'</span><span>,num2str(i),</span><span style="color: rgb(255, 153, 200);">' = line(S_series11(p_interp&gt;=25 &amp; p_interp &lt;=2000,i),T_series11(p_interp&gt;=25 &amp; p_interp &lt;=2000,i),''LineWidth'',5);'</span><span>])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>eval([</span><span style="color: rgb(255, 153, 200);">'s'</span><span>,num2str(i),</span><span style="color: rgb(255, 153, 200);">'.Color = myscatter1(i+1,:);'</span><span>])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%eval(['s',num2str(i),'.MarkerEdgeColor = myscatter2(i,:);'])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span class="warning_squiggle_rte1619232262">legendinfo</span><span>{i} = </span><span class="warning_squiggle_rte1619232262">[</span><span>num2str(year(i))];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i=1:9</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>eval([</span><span style="color: rgb(255, 153, 200);">'s'</span><span>,num2str(i),</span><span style="color: rgb(255, 153, 200);">' = scatter(S_series11(p_interp&gt;=25 &amp; p_interp &lt;=2000,i),T_series11(p_interp&gt;=25 &amp; p_interp &lt;=2000,i),50);'</span><span>])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>eval([</span><span style="color: rgb(255, 153, 200);">'s'</span><span>,num2str(i),</span><span style="color: rgb(255, 153, 200);">'.MarkerFaceColor = myscatter1(i+1,:);'</span><span>])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>eval([</span><span style="color: rgb(255, 153, 200);">'s'</span><span>,num2str(i),</span><span style="color: rgb(255, 153, 200);">'.MarkerEdgeColor = myscatter1(i+1,:);'</span><span>])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%eval(['s',num2str(i),'.MarkerFaceAlpha = 0.4;'])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%eval(['s',num2str(i),'.MarkerEdgeAlpha = 0.4;'])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>legendinfo{i} = </span><span class="warning_squiggle_rte1619232262">[</span><span>num2str(year(i))];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[c,h]=contour(si,thetai,dens,[27.68 27.68],</span><span style="color: rgb(255, 153, 200);">'-k'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clabel(c,h,</span><span style="color: rgb(255, 153, 200);">'LabelSpacing'</span><span>,500);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[c,h]=contour(si,thetai,dens,[27.80 27.80],</span><span style="color: rgb(255, 153, 200);">'-k'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clabel(c,h,</span><span style="color: rgb(255, 153, 200);">'LabelSpacing'</span><span>,500);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(gca,</span><span style="color: rgb(255, 153, 200);">'fontsize'</span><span>,14)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plot(nanmean(s_gs_series11(p_interp&gt;=450 &amp; p_interp &lt;=2000,:),2),</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    nanmean(t_gs_series11(p_interp&gt;=450 &amp; p_interp &lt;=2000,:),2),</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,myscatter2(11,:),</span><span style="color: rgb(255, 153, 200);">'LineWidth'</span><span>,3)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plot(nanmean(s_lc_series11(p_interp&gt;=50 &amp; p_interp &lt;=2000,:),2),</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    nanmean(t_lc_series11(p_interp&gt;=50 &amp; p_interp &lt;=2000,:),2),</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,myscatter2(1,:),</span><span style="color: rgb(255, 153, 200);">'LineWidth'</span><span>,3)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[c,h]=contour(si,thetai,dens,</span><span style="color: rgb(255, 153, 200);">'LineStyle'</span><span>,</span><span style="color: rgb(255, 153, 200);">'--'</span><span>,</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[60/256,60/256,60/256]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clabel(c,h,</span><span style="color: rgb(255, 153, 200);">'LabelSpacing'</span><span>,450,</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[60/256,60/256,60/256]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>legend(legendinfo,</span><span style="color: rgb(255, 153, 200);">'location'</span><span>,</span><span style="color: rgb(255, 153, 200);">'southeast'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>text(34.25,2,</span><span style="color: rgb(255, 153, 200);">'Labrador Current'</span><span>,</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,myscatter2(1,:),</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,14,</span><span style="color: rgb(255, 153, 200);">'FontWeight'</span><span>,</span><span style="color: rgb(255, 153, 200);">'bold'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>text(35.25,9.5,</span><span style="color: rgb(255, 153, 200);">'Gulf'</span><span>,</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,myscatter2(11,:),</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,14,</span><span style="color: rgb(255, 153, 200);">'FontWeight'</span><span>,</span><span style="color: rgb(255, 153, 200);">'bold'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>text(35.2,9,</span><span style="color: rgb(255, 153, 200);">'Stream'</span><span>,</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,myscatter2(11,:),</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,14,</span><span style="color: rgb(255, 153, 200);">'FontWeight'</span><span>,</span><span style="color: rgb(255, 153, 200);">'bold'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ylim([1 10])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>xlim([33.6 35.5])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>box </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>subplot(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,[0.08 0.08 0.88 0.22])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>hold </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>fill([time_1930_2018;flipud(time_1930_2018)],</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    [(t149_sslc + t149_sslc_unc/2);flipud(t149_sslc - t149_sslc_unc/2)],</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    [120/256,120/256,120/256],</span><span style="color: rgb(255, 153, 200);">'EdgeColor'</span><span>,[120/256,120/256,120/256],</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(255, 153, 200);">'FaceAlpha'</span><span>,0.4,</span><span style="color: rgb(255, 153, 200);">'EdgeAlpha'</span><span>,0.05)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plot(time_1930_2018,t149_sslc,</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>datetick(</span><span style="color: rgb(255, 153, 200);">'x'</span><span>,</span><span style="color: rgb(255, 153, 200);">'yyyy'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(gca,</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,14)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ylabel(</span><span style="color: rgb(255, 153, 200);">'Temperature (^\circC)'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>xlabel(</span><span style="color: rgb(255, 153, 200);">'Time (year)'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%title('149-m Temperature (Scotian Shelf + Laurentian Channel)')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>grid </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>axis(</span><span style="color: rgb(255, 153, 200);">'tight'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ylim([4 14])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>box </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(gcf, </span><span style="color: rgb(255, 153, 200);">'Color'</span><span>, </span><span style="color: rgb(255, 153, 200);">'w'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>saveas(gcf,[output_dir,</span><span style="color: rgb(255, 153, 200);">'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_Figure4_pre2'</span><span>],</span><span style="color: rgb(255, 153, 200);">'epsc'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Inset</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>figure(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>, [100, 200, 650, 400])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span class="warning_squiggle_rte1619232262">sp2</span><span> = subplot(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,[0.15 0.165 0.805 0.8]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>axesm(</span><span style="color: rgb(255, 153, 200);">'MapProjection'</span><span>,</span><span style="color: rgb(255, 153, 200);">'eqdcylin'</span><span>,</span><span style="color: rgb(255, 153, 200);">'MapLatLimit'</span><span>,[36 50],</span><span style="color: rgb(255, 153, 200);">'MapLonLimit'</span><span>,[-72 -45])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>hold </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-100 -100],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-1000 -1000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-3000 -3000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-4000 -4000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%TGB</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plotm([41 41],[-53.1 -47.9],</span><span style="color: rgb(255, 153, 200);">'k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'LineWidth'</span><span>,5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plotm([44 44],[-53.1 -47.9],</span><span style="color: rgb(255, 153, 200);">'k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'LineWidth'</span><span>,5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plotm([40.9 44.1],[-53 -53],</span><span style="color: rgb(255, 153, 200);">'k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'LineWidth'</span><span>,5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plotm([40.9 44.1],[-48 -48],</span><span style="color: rgb(255, 153, 200);">'k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'LineWidth'</span><span>,5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%LC</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plotm([47 47],[-46.9 -48.1],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,myscatter2(1,:),</span><span style="color: rgb(255, 153, 200);">'LineWidth'</span><span>,5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plotm([44 44],[-46.9 -48.1],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,myscatter2(1,:),</span><span style="color: rgb(255, 153, 200);">'LineWidth'</span><span>,5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plotm([47.1 43.9],[-47 -47],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,myscatter2(1,:),</span><span style="color: rgb(255, 153, 200);">'LineWidth'</span><span>,5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plotm([47.1 43.9],[-48 -48],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,myscatter2(1,:),</span><span style="color: rgb(255, 153, 200);">'LineWidth'</span><span>,5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%GS</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plotm([41 41],[-52.9 -56.1],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,myscatter2(11,:),</span><span style="color: rgb(255, 153, 200);">'LineWidth'</span><span>,5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plotm([40 40],[-52.9 -56.1],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,myscatter2(11,:),</span><span style="color: rgb(255, 153, 200);">'LineWidth'</span><span>,5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plotm([41.1 39.9],[-53 -53],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,myscatter2(11,:),</span><span style="color: rgb(255, 153, 200);">'LineWidth'</span><span>,5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plotm([41.1 39.9],[-56 -56],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,myscatter2(11,:),</span><span style="color: rgb(255, 153, 200);">'LineWidth'</span><span>,5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>scatterm(lat_en4(lat_sslc)+0.5,lon_en4(lon_sslc)+0.5,50,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'o'</span><span>,</span><span style="color: rgb(255, 153, 200);">'filled'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(gca,</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,14)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>geoshow(</span><span style="color: rgb(255, 153, 200);">'GSHHS_i_L1.shp'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FaceColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span><span style="color: rgb(0, 191, 191);">%[.7 .7 .7])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plabel(</span><span style="color: rgb(255, 153, 200);">'PLabelLocation'</span><span>,5,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,30)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>mlabel(</span><span style="color: rgb(255, 153, 200);">'MLabelLocation'</span><span>,10,</span><span style="color: rgb(255, 153, 200);">'MLabelParallel'</span><span>,</span><span style="color: rgb(255, 153, 200);">'south'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,30)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%title('Change Point of 150-m Deseasonalized Temperature (1993-2018)','fontsize',16)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>framem</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>tightmap</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(gcf, </span><span style="color: rgb(255, 153, 200);">'Color'</span><span>, </span><span style="color: rgb(255, 153, 200);">'w'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>saveas(gcf,[output_dir,</span><span style="color: rgb(255, 153, 200);">'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_Figure4_inset_pre'</span><span>],</span><span style="color: rgb(255, 153, 200);">'epsc'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clearvars </span><span style="color: rgb(255, 153, 200);">-except *_dir</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>close </span><span style="color: rgb(255, 153, 200);">all</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%% Supplemental Figure 1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Set  directory to save data</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span class="warning_squiggle_rte1619232262">data_dir</span><span> = </span><span style="color: rgb(255, 153, 200);">'/Users/afonso/Documents/Research/TGB/data/'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Set directory to save figures and tables</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>output_dir = </span><span style="color: rgb(255, 153, 200);">'/Users/afonso/Documents/Research/TGB/output/'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>load([output_dir,</span><span style="color: rgb(255, 153, 200);">'etopo1_TGB.mat'</span><span>],</span><span style="color: rgb(255, 153, 200);">'lat_z'</span><span>,</span><span style="color: rgb(255, 153, 200);">'lon_z'</span><span>,</span><span style="color: rgb(255, 153, 200);">'z'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>load([output_dir,</span><span style="color: rgb(255, 153, 200);">'SSH_TGB.mat'</span><span>],</span><span style="color: rgb(255, 153, 200);">'time_month'</span><span>,</span><span style="color: rgb(255, 153, 200);">'lat_ssh'</span><span>,</span><span style="color: rgb(255, 153, 200);">'lon_ssh'</span><span>,</span><span style="color: rgb(255, 153, 200);">'adt'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>figure(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>, [100, 200, 800, 600])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>axesm(</span><span style="color: rgb(255, 153, 200);">'MapProjection'</span><span>,</span><span style="color: rgb(255, 153, 200);">'eqdcylin'</span><span>,</span><span style="color: rgb(255, 153, 200);">'MapLatLimit'</span><span>,[30 60],</span><span style="color: rgb(255, 153, 200);">'MapLonLimit'</span><span>,[-80 -40])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>hold </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c1_aux = contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),[-1000 -1000],</span><span style="color: rgb(255, 153, 200);">'k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>linem([36 36],[360-75 360-47],</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>linem([46 46],[360-75 360-47],</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>linem([36 46],[360-75 360-75],</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>linem([36 46],[360-47 360-47],</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>geoshow(</span><span style="color: rgb(255, 153, 200);">'landareas.shp'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FaceColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span><span style="color: rgb(0, 191, 191);">%[.7 .7 .7])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>close </span><span style="color: rgb(255, 153, 200);">all</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c1 = NaN(2,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>j = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 2:length(c1_aux)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">if </span><span>c1_aux(1,i)&gt;=360-75 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">&amp;</span><span> c1_aux(1,i)&lt;=360-47 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">&amp;</span><span> c1_aux(2,i)&gt;=36 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">&amp;</span><span> c1_aux(2,i)&lt;=46</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        c1(:,j) = c1_aux(:,i);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">if </span><span>j&gt;1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            </span><span style="color: rgb(237, 177, 32);">if </span><span>abs(c1_aux(1,i)-c1(1,j-1))&lt;0.2</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>                j = j+1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            </span><span style="color: rgb(237, 177, 32);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>                c1(:,j) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            j = j+1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear </span><span style="color: rgb(255, 153, 200);">i j</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">if </span><span>isnan(c1(1,end))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    c1 = c1(:,1:end-1);</span><span style="color: rgb(0, 191, 191);">% lon,lat of 1000m isobath</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c1(3,:) = zeros;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c1_dist = gsw_distance(c1(1,:),c1(2,:));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 2:length(c1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    c1(3,i) = sum(c1_dist(1:i-1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear </span><span style="color: rgb(255, 153, 200);">c1_aux c1_dist i</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Lat and Lon for TGB, slope and shelf</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>lon_ssh2 = lon_ssh(lon_ssh&gt;=360-75 &amp; lon_ssh&lt;=360-45);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>lat_ssh2 = lat_ssh(lat_ssh&gt;=36 &amp; lat_ssh&lt;=46);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[</span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">lon_ssh2_mesh</span><span>,</span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">lat_ssh2_mesh</span><span>] = meshgrid(lon_ssh2,lat_ssh2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>lon_z2 = lon_z(lon_z&gt;=360-75 &amp; lon_z&lt;=360-45);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>lat_z2 = lat_z(lat_z&gt;=36 &amp; lat_z&lt;=46);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[</span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">lon_z2_mesh</span><span>,</span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">lat_z2_mesh</span><span>] = meshgrid(lon_z2,lat_z2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span class="warning_squiggle_rte1619232262">z2</span><span> = z(lat_z&gt;=36 &amp; lat_z&lt;=46,lon_z&gt;=360-75 &amp; lon_z&lt;=360-45)';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Define area at TGB between 3000m and 4000 isobaths (for time series)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[lon_mesh,lat_mesh] = meshgrid(lon_ssh,lat_ssh);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[lon_z_mesh,lat_z_mesh] = meshgrid(lon_z,lat_z);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>lon_z_tgb = lon_z(lon_z&gt;=360-51 &amp; lon_z&lt;=360-46);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>lat_z_tgb = lat_z(lat_z&gt;=39 &amp; lat_z&lt;=43);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>z_ssh = interp2(lon_z_mesh,lat_z_mesh,z,lon_mesh,lat_mesh);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>z_tgb = z_ssh(lat_ssh&gt;=39 &amp; lat_ssh&lt;=43,lon_ssh&gt;=360-51 &amp; lon_ssh&lt;=360-46);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[z_aux1,z_aux2] = find(z_tgb&gt;=-4000 &amp; z_tgb&lt;=-3000);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>z_aux3 = z_aux1+36;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>z_aux4 = z_aux2+116;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% SLA at TGB</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>adt_TGB = nan(length(time_month),length(z_aux4));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i=1:length(z_aux4)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    adt_TGB(:,i) = squeeze(adt(z_aux4(i),z_aux3(i),:));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>adt_TGB2 = nanmean(adt_TGB,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>adt_TGB2_lp = filtfilt(ones(12,1)/12,1,adt_TGB2(1:end-1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% ADT time series</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla_TGB2_std = nanstd(adt_TGB2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla_TGB2_mean = nanmean(adt_TGB2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2 = adt_TGB2;</span><span style="color: rgb(0, 191, 191);">%-sla_TGB2_mean;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2_lp = filtfilt(ones(12,1)/12,1,sla2_TGB2(1:end-1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>slahigh = find(sla2_TGB2&gt;(1.5*sla_TGB2_std));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>slalow = find(sla2_TGB2&lt;-(1.5*sla_TGB2_std));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% annual averages</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2_yr = NaN(26,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 1:26</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    sla2_TGB2_yr(i,1) = nanmean(sla2_TGB2(i*12-11:i*12));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% monthly averages</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2_mo = NaN(12,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 1:12</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    sla2_TGB2_mo(i,1) = nanmean(sla2_TGB2(i:12:16*12+i));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 1:26</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    sla2_TGB2_nomo(i*12-11:i*12) = sla2_TGB2(i*12-11:i*12) - sla2_TGB2_mo;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2_nomo_mean = nanmean(sla2_TGB2_nomo);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2_nomo_std = nanstd(sla2_TGB2_nomo);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2_nomo = sla2_TGB2_nomo - sla2_TGB2_nomo_mean;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>slahigh_nomo = find(sla2_TGB2_nomo&gt;(1.5*(sla2_TGB2_nomo_std)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>slalow_nomo = find(sla2_TGB2_nomo&lt;(1.5*(-sla2_TGB2_nomo_std)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2_nomo_lp = filtfilt(ones(12,1)/12,1,sla2_TGB2_nomo(1:end-1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2_std = nanstd(sla2_TGB2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[ipt,ipt_res] = findchangepts(sla2_TGB2_nomo(1:end-1))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% TGB SSH increase: 0.1043 m</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>nanmean(sla2_TGB2_nomo(1:12*15))</span><span style="color: rgb(0, 191, 191);">% -0.0409 m</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>nanmean(sla2_TGB2_nomo(12*16+1:end))</span><span style="color: rgb(0, 191, 191);">% 0.0634 m</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>nanmean(sla2_TGB2_nomo(1:ipt))</span><span style="color: rgb(0, 191, 191);">% -0.0417 m</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>nanmean(sla2_TGB2_nomo(ipt:end))</span><span style="color: rgb(0, 191, 191);">% 0.0625 m</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Basin SSH increase: 0.0450</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>nanmean(nanmean(nanmean(adt(:,:,1:12*15),3)))</span><span style="color: rgb(0, 191, 191);">% - 0.0066 m</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>nanmean(nanmean(nanmean(adt(:,:,12*16+1:end),3)))</span><span style="color: rgb(0, 191, 191);">% 0.0384 m</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>csvwrite([output_dir,</span><span style="color: rgb(255, 153, 200);">'SSH_TGB_1993-2018.csv'</span><span>],sla2_TGB2_nomo')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Histogram of SSH at TGB</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2_nomo_var = var(sla2_TGB2_nomo*100,</span><span style="color: rgb(255, 153, 200);">'omitnan'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sum(sla2_TGB2_nomo&lt;(nanmean(sla2_TGB2_nomo)-1.5*sla2_TGB2_nomo_std)) + </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    sum(sla2_TGB2_nomo&gt;(nanmean(sla2_TGB2_nomo)+1.5*sla2_TGB2_nomo_std))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2_nomo_pre = sla2_TGB2_nomo(1:ipt-1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2_nomo_pre_var = var(sla2_TGB2_nomo_pre*100,</span><span style="color: rgb(255, 153, 200);">'omitnan'</span><span>)</span><span style="color: rgb(0, 191, 191);">%50.5265cm^2</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2_nomo_pre_std = nanstd(sla2_TGB2_nomo_pre*100)</span><span style="color: rgb(0, 191, 191);">%7.1082 cm</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2_nomo_pre_mean = nanmean(sla2_TGB2_nomo_pre*100)</span><span style="color: rgb(0, 191, 191);">%-4.1972 cm</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2_nomo_post = sla2_TGB2_nomo(ipt:end);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2_nomo_post_var = var(sla2_TGB2_nomo_post*100,</span><span style="color: rgb(255, 153, 200);">'omitnan'</span><span>)</span><span style="color: rgb(0, 191, 191);">%63.6254 cm^2</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2_nomo_post_std = nanstd(sla2_TGB2_nomo_post*100)</span><span style="color: rgb(0, 191, 191);">%7.9766 cm</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2_nomo_post_mean = nanmean(sla2_TGB2_nomo_post*100)</span><span style="color: rgb(0, 191, 191);">%6.2454 cm</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2_nomo_pre_aux = [sla2_TGB2_nomo_pre,NaN(1,length(sla2_TGB2_nomo_post))];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2_nomo_post_aux = [sla2_TGB2_nomo_post,NaN(1,length(sla2_TGB2_nomo_pre))];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>100 * (sla2_TGB2_nomo_post_var - sla2_TGB2_nomo_pre_var)</span><span class="warning_squiggle_rte1619232262">/</span><span>sla2_TGB2_nomo_pre_var;</span><span style="color: rgb(0, 191, 191);">%25.9249%</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>100 * (sla2_TGB2_nomo_post_std - sla2_TGB2_nomo_pre_std)</span><span class="warning_squiggle_rte1619232262">/</span><span>sla2_TGB2_nomo_pre_std;</span><span style="color: rgb(0, 191, 191);">%12.2162%</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>aux1 = find(sla2_TGB2_nomo_pre_aux &gt; (sla2_TGB2_nomo_pre_mean/100 - sla2_TGB2_nomo_pre_std/100)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    &amp; sla2_TGB2_nomo_pre_aux &lt; (sla2_TGB2_nomo_pre_mean/100 + sla2_TGB2_nomo_pre_std/100))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>aux2 = find(sla2_TGB2_nomo_pre_aux &gt; (sla2_TGB2_nomo_pre_mean/100 - 2*sla2_TGB2_nomo_pre_std/100)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    &amp; sla2_TGB2_nomo_pre_aux &lt; (sla2_TGB2_nomo_pre_mean/100 + 2*sla2_TGB2_nomo_pre_std/100))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>aux3 = find(sla2_TGB2_nomo_pre_aux &gt; (sla2_TGB2_nomo_pre_mean/100 - 3*sla2_TGB2_nomo_pre_std/100)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    &amp; sla2_TGB2_nomo_pre_aux &lt; (sla2_TGB2_nomo_pre_mean/100 + 3*sla2_TGB2_nomo_pre_std/100))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>100*length(aux1)/length(sla2_TGB2_nomo_pre)</span><span style="color: rgb(0, 191, 191);">%67.7419%, should be 68% for normal distribution</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>100*length(aux2)/length(sla2_TGB2_nomo_pre)</span><span style="color: rgb(0, 191, 191);">%95.6989%, should be 95% for normal distribution</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>100*length(aux3)/length(sla2_TGB2_nomo_pre)</span><span style="color: rgb(0, 191, 191);">%98.9247%, should be 99.7% for normal distribution</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>aux4 = find(sla2_TGB2_nomo_post_aux &gt; (sla2_TGB2_nomo_post_mean/100 - sla2_TGB2_nomo_post_std/100)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    &amp; sla2_TGB2_nomo_post_aux &lt; (sla2_TGB2_nomo_post_mean/100 + sla2_TGB2_nomo_post_std/100))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>aux5 = find(sla2_TGB2_nomo_post_aux &gt; (sla2_TGB2_nomo_post_mean/100 - 2*sla2_TGB2_nomo_post_std/100)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    &amp; sla2_TGB2_nomo_post_aux &lt; (sla2_TGB2_nomo_post_mean/100 + 2*sla2_TGB2_nomo_post_std/100))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>aux6 = find(sla2_TGB2_nomo_post_aux &gt; (sla2_TGB2_nomo_post_mean/100 - 3*sla2_TGB2_nomo_post_std/100)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    &amp; sla2_TGB2_nomo_post_aux &lt; (sla2_TGB2_nomo_post_mean/100 + 3*sla2_TGB2_nomo_post_std/100))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>100*length(aux4)/length(sla2_TGB2_nomo_post)</span><span style="color: rgb(0, 191, 191);">%65.8730%, should be 68% for normal distribution</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>100*length(aux5)/length(sla2_TGB2_nomo_post)</span><span style="color: rgb(0, 191, 191);">%95.2381%, should be 95% for normal distribution</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>100*length(aux6)/length(sla2_TGB2_nomo_post)</span><span style="color: rgb(0, 191, 191);">%99.2063%, should be 99.7% for normal distribution</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Histogram of SSH at TGB (sla2_TGB2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2_var = var(sla2_TGB2*100,</span><span style="color: rgb(255, 153, 200);">'omitnan'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sum(sla2_TGB2&lt;(nanmean(sla2_TGB2)-1.5*sla2_TGB2_std)) + </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    sum(sla2_TGB2&gt;(nanmean(sla2_TGB2)+1.5*sla2_TGB2_std))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2_pre = sla2_TGB2(1:ipt-1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2_pre_var = var(sla2_TGB2_pre*100,</span><span style="color: rgb(255, 153, 200);">'omitnan'</span><span>)</span><span style="color: rgb(0, 191, 191);">%50.5265cm^2</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2_pre_std = nanstd(sla2_TGB2_pre*100)</span><span style="color: rgb(0, 191, 191);">%7.1082 cm</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2_pre_mean = nanmean(sla2_TGB2_pre*100)</span><span style="color: rgb(0, 191, 191);">%-4.1972 cm</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2_post = sla2_TGB2(ipt:end);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2_post_var = var(sla2_TGB2_post*100,</span><span style="color: rgb(255, 153, 200);">'omitnan'</span><span>)</span><span style="color: rgb(0, 191, 191);">%63.6254 cm^2</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2_post_std = nanstd(sla2_TGB2_post*100)</span><span style="color: rgb(0, 191, 191);">%7.9766 cm</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2_post_mean = nanmean(sla2_TGB2_post*100)</span><span style="color: rgb(0, 191, 191);">%6.2454 cm</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2_pre_aux = [sla2_TGB2_pre',NaN(1,length(sla2_TGB2_post))];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_TGB2_post_aux = [sla2_TGB2_post',NaN(1,length(sla2_TGB2_pre))];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>100 * (sla2_TGB2_post_var - sla2_TGB2_pre_var)</span><span class="warning_squiggle_rte1619232262">/</span><span>sla2_TGB2_pre_var;</span><span style="color: rgb(0, 191, 191);">%25.9249%</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>100 * (sla2_TGB2_post_std - sla2_TGB2_pre_std)</span><span class="warning_squiggle_rte1619232262">/</span><span>sla2_TGB2_pre_std;</span><span style="color: rgb(0, 191, 191);">%12.2162%</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>aux1 = find(sla2_TGB2_pre_aux &gt; (sla2_TGB2_pre_mean/100 - sla2_TGB2_pre_std/100)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    &amp; sla2_TGB2_pre_aux &lt; (sla2_TGB2_pre_mean/100 + sla2_TGB2_pre_std/100))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>aux2 = find(sla2_TGB2_pre_aux &gt; (sla2_TGB2_pre_mean/100 - 2*sla2_TGB2_pre_std/100)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    &amp; sla2_TGB2_pre_aux &lt; (sla2_TGB2_pre_mean/100 + 2*sla2_TGB2_pre_std/100))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>aux3 = find(sla2_TGB2_pre_aux &gt; (sla2_TGB2_pre_mean/100 - 3*sla2_TGB2_pre_std/100)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    &amp; sla2_TGB2_pre_aux &lt; (sla2_TGB2_pre_mean/100 + 3*sla2_TGB2_pre_std/100))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>100*length(aux1)/length(sla2_TGB2_pre)</span><span style="color: rgb(0, 191, 191);">%67.7419%, should be 68% for normal distribution</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>100*length(aux2)/length(sla2_TGB2_pre)</span><span style="color: rgb(0, 191, 191);">%95.6989%, should be 95% for normal distribution</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>100*length(aux3)/length(sla2_TGB2_pre)</span><span style="color: rgb(0, 191, 191);">%98.9247%, should be 99.7% for normal distribution</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>aux4 = find(sla2_TGB2_post_aux &gt; (sla2_TGB2_post_mean/100 - sla2_TGB2_post_std/100)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    &amp; sla2_TGB2_post_aux &lt; (sla2_TGB2_post_mean/100 + sla2_TGB2_post_std/100))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>aux5 = find(sla2_TGB2_post_aux &gt; (sla2_TGB2_post_mean/100 - 2*sla2_TGB2_post_std/100)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    &amp; sla2_TGB2_post_aux &lt; (sla2_TGB2_post_mean/100 + 2*sla2_TGB2_post_std/100))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>aux6 = find(sla2_TGB2_post_aux &gt; (sla2_TGB2_post_mean/100 - 3*sla2_TGB2_post_std/100)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    &amp; sla2_TGB2_post_aux &lt; (sla2_TGB2_post_mean/100 + 3*sla2_TGB2_post_std/100))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>100*length(aux4)/length(sla2_TGB2_post)</span><span style="color: rgb(0, 191, 191);">%65.8730%, should be 68% for normal distribution</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>100*length(aux5)/length(sla2_TGB2_post)</span><span style="color: rgb(0, 191, 191);">%95.2381%, should be 95% for normal distribution</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>100*length(aux6)/length(sla2_TGB2_post)</span><span style="color: rgb(0, 191, 191);">%99.2063%, should be 99.7% for normal distribution</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% SSH fit</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_fit_aux = readtable(</span><span style="color: rgb(255, 153, 200);">'SSH.Fit.csv'</span><span>, </span><span style="color: rgb(255, 153, 200);">'HeaderLines'</span><span>,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_fit = table2array(sla2_fit_aux);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear </span><span style="color: rgb(255, 153, 200);">sla2_fit_aux</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_fit_std = nanstd(sla2_fit);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Histogram of SSH at TGB (sla2_fit)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_fit_var = var(sla2_fit*100,</span><span style="color: rgb(255, 153, 200);">'omitnan'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sum(sla2_fit&lt;(nanmean(sla2_fit)-1.5*sla2_fit_std)) + </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    sum(sla2_fit&gt;(nanmean(sla2_fit)+1.5*sla2_fit_std))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_fit_pre = sla2_fit(1:ipt-1,4);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_fit_pre_var = var(sla2_fit_pre*100,</span><span style="color: rgb(255, 153, 200);">'omitnan'</span><span>)</span><span style="color: rgb(0, 191, 191);">%54.0897cm^2</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_fit_pre_std = nanstd(sla2_fit_pre*100)</span><span style="color: rgb(0, 191, 191);">%7.3546 cm</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_fit_pre_mean = nanmean(sla2_fit_pre*100)</span><span style="color: rgb(0, 191, 191);">%-10.4645 cm</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_fit_post = sla2_fit(ipt:end,4);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_fit_post_var = var(sla2_fit_post*100,</span><span style="color: rgb(255, 153, 200);">'omitnan'</span><span>)</span><span style="color: rgb(0, 191, 191);">%52.4571 cm^2</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_fit_post_std = nanstd(sla2_fit_post*100)</span><span style="color: rgb(0, 191, 191);">%7.2427 cm</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_fit_post_mean = nanmean(sla2_fit_post*100)</span><span style="color: rgb(0, 191, 191);">%0.3160 cm</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_fit_pre_aux = [sla2_fit_pre',NaN(1,length(sla2_fit_post))];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sla2_fit_post_aux = [sla2_fit_post',NaN(1,length(sla2_fit_pre))];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>100 * (sla2_fit_post_var - sla2_fit_pre_var)/sla2_fit_pre_var</span><span style="color: rgb(0, 191, 191);">%25.9249%</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>100 * (sla2_fit_post_std - sla2_fit_pre_std)/sla2_fit_pre_std</span><span style="color: rgb(0, 191, 191);">%12.2162%</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>aux1 = find(sla2_fit_pre_aux &gt; (sla2_fit_pre_mean/100 - sla2_fit_pre_std/100)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    &amp; sla2_fit_pre_aux &lt; (sla2_fit_pre_mean/100 + sla2_fit_pre_std/100))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>aux2 = find(sla2_fit_pre_aux &gt; (sla2_fit_pre_mean/100 - 2*sla2_fit_pre_std/100)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    &amp; sla2_fit_pre_aux &lt; (sla2_fit_pre_mean/100 + 2*sla2_fit_pre_std/100))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>aux3 = find(sla2_fit_pre_aux &gt; (sla2_fit_pre_mean/100 - 3*sla2_fit_pre_std/100)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    &amp; sla2_fit_pre_aux &lt; (sla2_fit_pre_mean/100 + 3*sla2_fit_pre_std/100))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>100*length(aux1)/length(sla2_fit_pre)</span><span style="color: rgb(0, 191, 191);">%67.7419%, should be 68% for normal distribution</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>100*length(aux2)/length(sla2_fit_pre)</span><span style="color: rgb(0, 191, 191);">%95.6989%, should be 95% for normal distribution</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>100*length(aux3)/length(sla2_fit_pre)</span><span style="color: rgb(0, 191, 191);">%98.9247%, should be 99.7% for normal distribution</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>aux4 = find(sla2_fit_post_aux &gt; (sla2_fit_post_mean/100 - sla2_fit_post_std/100)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    &amp; sla2_fit_post_aux &lt; (sla2_fit_post_mean/100 + sla2_fit_post_std/100))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>aux5 = find(sla2_fit_post_aux &gt; (sla2_fit_post_mean/100 - 2*sla2_fit_post_std/100)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    &amp; sla2_fit_post_aux &lt; (sla2_fit_post_mean/100 + 2*sla2_fit_post_std/100))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>aux6 = find(sla2_fit_post_aux &gt; (sla2_fit_post_mean/100 - 3*sla2_fit_post_std/100)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    &amp; sla2_fit_post_aux &lt; (sla2_fit_post_mean/100 + 3*sla2_fit_post_std/100))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>100*length(aux4)/length(sla2_fit_post)</span><span style="color: rgb(0, 191, 191);">%65.8730%, should be 68% for normal distribution</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>100*length(aux5)/length(sla2_fit_post)</span><span style="color: rgb(0, 191, 191);">%95.2381%, should be 95% for normal distribution</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>100*length(aux6)/length(sla2_fit_post)</span><span style="color: rgb(0, 191, 191);">%99.2063%, should be 99.7% for normal distribution</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% ACF</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>acf_aux = readtable(</span><span style="color: rgb(255, 153, 200);">'SSH_ACF.csv'</span><span>, </span><span style="color: rgb(255, 153, 200);">'HeaderLines'</span><span>,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>acf = table2array(acf_aux);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear </span><span style="color: rgb(255, 153, 200);">acf_aux</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>figure(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>, [100, 200, 800, 600])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>subplot(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,[0.09 0.57 0.86 0.4])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>hold </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% histogram(sla2_TGB2_pre_aux*100,[-35:1:35],'normalization','pdf',...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%     'facecolor',rgb('SteelBlue'),'edgecolor','w','facealpha',0.2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% histogram(sla2_TGB2_post_aux*100,[-35:1:35],'normalization','pdf',...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%     'facecolor',rgb('DarkRed'),'edgecolor','w','facealpha',0.2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>histogram(sla2_fit_pre_aux*100,</span><span class="warning_squiggle_rte1619232262">[</span><span>-35:1:25],</span><span style="color: rgb(255, 153, 200);">'normalization'</span><span>,</span><span style="color: rgb(255, 153, 200);">'pdf'</span><span>,</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(255, 153, 200);">'facecolor'</span><span>,rgb(</span><span style="color: rgb(255, 153, 200);">'SteelBlue'</span><span>),</span><span style="color: rgb(255, 153, 200);">'edgecolor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>,</span><span style="color: rgb(255, 153, 200);">'facealpha'</span><span>,0.2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>histogram(sla2_fit_post_aux*100,</span><span class="warning_squiggle_rte1619232262">[</span><span>-35:1:25],</span><span style="color: rgb(255, 153, 200);">'normalization'</span><span>,</span><span style="color: rgb(255, 153, 200);">'pdf'</span><span>,</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(255, 153, 200);">'facecolor'</span><span>,rgb(</span><span style="color: rgb(255, 153, 200);">'DarkRed'</span><span>),</span><span style="color: rgb(255, 153, 200);">'edgecolor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>,</span><span style="color: rgb(255, 153, 200);">'facealpha'</span><span>,0.2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%plot([nanmean(sla2_TGB2_nomo)*100-1.5*sla2_TGB2_nomo_std*100 ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%    nanmean(sla2_TGB2_nomo)*100-1.5*sla2_TGB2_nomo_std*100],[0 0.04],'--k','linewidth',2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%plot([nanmean(sla2_TGB2_nomo)*100+1.5*sla2_TGB2_nomo_std*100 ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%    nanmean(sla2_TGB2_nomo)*100+1.5*sla2_TGB2_nomo_std*100],[0 0.04],'--k','linewidth',2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%y = -25:1:25;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% f_pre = exp(-(y-sla2_TGB2_nomo_pre_mean).^2./(2*sla2_TGB2_nomo_pre_std^2))./(sla2_TGB2_nomo_pre_std*sqrt(2*pi));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% plot(y,f_pre*length(sla2_TGB2_nomo_pre)/length(sla2_TGB2_nomo_pre_aux),'color',rgb('SteelBlue'),'LineWidth',1.5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% f_post = exp(-(y-sla2_TGB2_nomo_post_mean).^2./(2*sla2_TGB2_nomo_post_std^2))./(sla2_TGB2_nomo_post_std*sqrt(2*pi));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% plot(y,f_post*length(sla2_TGB2_nomo_post)/length(sla2_TGB2_nomo_post_aux),'color',rgb('DarkRed'),'LineWidth',1.5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% y = -30:1:30;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% f_pre = exp(-(y-sla2_TGB2_pre_mean).^2./(2*sla2_TGB2_pre_std^2))./(sla2_TGB2_pre_std*sqrt(2*pi));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% plot(y,f_pre*length(sla2_TGB2_pre)/length(sla2_TGB2_pre_aux),'color',rgb('SteelBlue'),'LineWidth',1.5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% f_post = exp(-(y-sla2_TGB2_post_mean).^2./(2*sla2_TGB2_post_std^2))./(sla2_TGB2_post_std*sqrt(2*pi));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% plot(y,f_post*length(sla2_TGB2_post)/length(sla2_TGB2_post_aux),'color',rgb('DarkRed'),'LineWidth',1.5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% y = -30:1:20;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% f_pre = exp(-(y-sla2_fit_pre_mean).^2./(2*sla2_fit_pre_std^2))./(sla2_fit_pre_std*sqrt(2*pi));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% plot(y,f_pre*length(sla2_fit_pre)/length(sla2_fit_pre_aux),'color',rgb('SteelBlue'),'LineWidth',1.5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% f_post = exp(-(y-sla2_fit_post_mean).^2./(2*sla2_fit_post_std^2))./(sla2_fit_post_std*sqrt(2*pi));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% plot(y,f_post*length(sla2_fit_post)/length(sla2_fit_post_aux),'color',rgb('DarkRed'),'LineWidth',1.5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%[f_pre,y_pre,bw_pre] = ksdensity(sla2_fit_pre);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%[f_post,y_post,bw_post] = ksdensity(sla2_fit_post);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%plot(y_pre*100,(f_pre/100)*length(sla2_fit_pre)/length(sla2_fit_pre_aux),'color',rgb('SteelBlue'),'LineWidth',1.5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%plot(y_post*100,(f_post/100)*length(sla2_fit_post)/length(sla2_fit_post_aux),'color',rgb('DarkRed'),'LineWidth',1.5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(gca,</span><span style="color: rgb(255, 153, 200);">'fontsize'</span><span>,14')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ytix = get(gca, </span><span style="color: rgb(255, 153, 200);">'YTick'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(gca, </span><span style="color: rgb(255, 153, 200);">'YTick'</span><span>,ytix, </span><span style="color: rgb(255, 153, 200);">'YTickLabel'</span><span>,ytix*100)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%ylim([0 0.04])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%xlim([-25 25])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ylim([0 0.04])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>xlim([-30 20])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>xlabel(</span><span style="color: rgb(255, 153, 200);">'Sea Surface Height Anomaly (cm)'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ylabel(</span><span style="color: rgb(255, 153, 200);">'Probability (%)'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>grid</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%axis('tight')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>box </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>subplot(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,[0.09 0.09 0.86 0.4])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>hold </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>bar(acf(1:25,1),acf(1:25,2),0.02,</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(255, 153, 200);">'facecolor'</span><span>,rgb(</span><span style="color: rgb(255, 153, 200);">'MidnightBlue'</span><span>),</span><span style="color: rgb(255, 153, 200);">'edgecolor'</span><span>,rgb(</span><span style="color: rgb(255, 153, 200);">'MidnightBlue'</span><span>),</span><span style="color: rgb(255, 153, 200);">'facealpha'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>scatter(acf(1:25,1),acf(1:25,2),40,</span><span style="color: rgb(255, 153, 200);">'filled'</span><span>,</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(255, 153, 200);">'MarkerFaceColor'</span><span>,rgb(</span><span style="color: rgb(255, 153, 200);">'MidnightBlue'</span><span>),</span><span style="color: rgb(255, 153, 200);">'MarkerEdgeColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>,</span><span style="color: rgb(255, 153, 200);">'MarkerFaceAlpha'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(gca,</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,14,</span><span style="color: rgb(255, 153, 200);">'xtick'</span><span>,[0,6,12,18,24])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>grid </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>xlabel(</span><span style="color: rgb(255, 153, 200);">'Lag (months)'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ylabel(</span><span style="color: rgb(255, 153, 200);">'Autocorrelation Function'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>box </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(gcf, </span><span style="color: rgb(255, 153, 200);">'Color'</span><span>, </span><span style="color: rgb(255, 153, 200);">'w'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>saveas(gcf,[output_dir,</span><span style="color: rgb(255, 153, 200);">'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_SupplementalFigure1_pre2'</span><span>],</span><span style="color: rgb(255, 153, 200);">'epsc'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clearvars </span><span style="color: rgb(255, 153, 200);">-except *_dir</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>close </span><span style="color: rgb(255, 153, 200);">all</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%% Supplemental Figure 2</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Set  directory to save data</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span class="warning_squiggle_rte1619232262">data_dir</span><span> = </span><span style="color: rgb(255, 153, 200);">'/Users/afonso/Documents/Research/TGB/data/'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Set directory to save figures and tables</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>output_dir = </span><span style="color: rgb(255, 153, 200);">'/Users/afonso/Documents/Research/TGB/output/'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>load([output_dir,</span><span style="color: rgb(255, 153, 200);">'etopo1_TGB.mat'</span><span>],</span><span style="color: rgb(255, 153, 200);">'lat_z'</span><span>,</span><span style="color: rgb(255, 153, 200);">'lon_z'</span><span>,</span><span style="color: rgb(255, 153, 200);">'z'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>load([output_dir,</span><span style="color: rgb(255, 153, 200);">'SSH_TGB.mat'</span><span>],</span><span style="color: rgb(255, 153, 200);">'time_month'</span><span>,</span><span style="color: rgb(255, 153, 200);">'lat_ssh'</span><span>,</span><span style="color: rgb(255, 153, 200);">'lon_ssh'</span><span>,</span><span style="color: rgb(255, 153, 200);">'u_g'</span><span>,</span><span style="color: rgb(255, 153, 200);">'v_g'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>figure(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>, [100, 200, 800, 600])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>axesm(</span><span style="color: rgb(255, 153, 200);">'MapProjection'</span><span>,</span><span style="color: rgb(255, 153, 200);">'eqdcylin'</span><span>,</span><span style="color: rgb(255, 153, 200);">'MapLatLimit'</span><span>,[30 60],</span><span style="color: rgb(255, 153, 200);">'MapLonLimit'</span><span>,[-80 -40])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>hold </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c1_aux = contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),[-1000 -1000],</span><span style="color: rgb(255, 153, 200);">'k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>linem([36 36],[360-75 360-47],</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>linem([46 46],[360-75 360-47],</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>linem([36 46],[360-75 360-75],</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>linem([36 46],[360-47 360-47],</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>geoshow(</span><span style="color: rgb(255, 153, 200);">'landareas.shp'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FaceColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span><span style="color: rgb(0, 191, 191);">%[.7 .7 .7])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>close </span><span style="color: rgb(255, 153, 200);">all</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c1 = NaN(2,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>j = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 2:length(c1_aux)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">if </span><span>c1_aux(1,i)&gt;=360-75 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">&amp;</span><span> c1_aux(1,i)&lt;=360-47 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">&amp;</span><span> c1_aux(2,i)&gt;=36 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">&amp;</span><span> c1_aux(2,i)&lt;=46</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        c1(:,j) = c1_aux(:,i);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">if </span><span>j&gt;1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            </span><span style="color: rgb(237, 177, 32);">if </span><span>abs(c1_aux(1,i)-c1(1,j-1))&lt;0.2</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>                j = j+1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            </span><span style="color: rgb(237, 177, 32);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>                c1(:,j) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            j = j+1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear </span><span style="color: rgb(255, 153, 200);">i j</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">if </span><span>isnan(c1(1,end))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    c1 = c1(:,1:end-1);</span><span style="color: rgb(0, 191, 191);">% lon,lat of 1000m isobath</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c1(3,:) = zeros;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c1_dist = gsw_distance(c1(1,:),c1(2,:));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 2:length(c1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    c1(3,i) = sum(c1_dist(1:i-1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear </span><span style="color: rgb(255, 153, 200);">c1_aux c1_dist i</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Lat and Lon for TGB, slope and shelf</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>lon_ssh2 = lon_ssh(lon_ssh&gt;=360-75 &amp; lon_ssh&lt;=360-45);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>lat_ssh2 = lat_ssh(lat_ssh&gt;=36 &amp; lat_ssh&lt;=46);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[lon_ssh2_mesh,lat_ssh2_mesh] = meshgrid(lon_ssh2,lat_ssh2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>lon_z2 = lon_z(lon_z&gt;=360-75 &amp; lon_z&lt;=360-45);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>lat_z2 = lat_z(lat_z&gt;=36 &amp; lat_z&lt;=46);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[lon_z2_mesh,lat_z2_mesh] = meshgrid(lon_z2,lat_z2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span class="warning_squiggle_rte1619232262">z2</span><span> = z(lat_z&gt;=36 &amp; lat_z&lt;=46,lon_z&gt;=360-75 &amp; lon_z&lt;=360-45)';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Define velocity on different isobaths</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[lon_mesh </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">lat_mesh</span><span>] = meshgrid(lon_ssh,lat_ssh);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>u_z = NaN(length(lat_z2),length(lon_z2),size(u_g,3));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>v_z = NaN(length(lat_z2),length(lon_z2),size(v_g,3));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>t = 1:length(time_month)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    u_z(:,:,t) = interp2(lon_mesh,lat_mesh,u_g(:,:,t)',lon_z2_mesh,lat_z2_mesh);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    v_z(:,:,t) = interp2(lon_mesh,lat_mesh,v_g(:,:,t)',lon_z2_mesh,lat_z2_mesh);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% 1000m </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>u_1 = NaN(length(c1),length(time_month));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>v_1 = NaN(length(c1),length(time_month));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>t = 1:length(time_month)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    u_1(:,t) = interp2(lon_z2_mesh,lat_z2_mesh,u_z(:,:,t),c1(1,:),c1(2,:));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    v_1(:,t) = interp2(lon_z2_mesh,lat_z2_mesh,v_z(:,:,t),c1(1,:),c1(2,:));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear </span><span style="color: rgb(255, 153, 200);">u_z v_z z2 lon_z2* lat_z2* lon_ssh2* lat_ssh2* u_g v_g t</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Rotating velocities</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% magnitude of input vector</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>uv_in = sqrt(u_1.^2 + v_1.^2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>cross_1 = NaN(size(u_1,1)-1,size(u_1,2));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>along_1 = NaN(size(u_1,1)-1,size(u_1,2));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>cross_1_u = NaN(size(u_1,1)-1,size(u_1,2));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>cross_1_v = NaN(size(u_1,1)-1,size(u_1,2));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>along_1_u = NaN(size(u_1,1)-1,size(u_1,2));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>along_1_v = NaN(size(u_1,1)-1,size(u_1,2));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>cross_1_anom = NaN(size(u_1,1)-1,size(u_1,2));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>along_1_anom = NaN(size(u_1,1)-1,size(u_1,2));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>t = 1:length(time_month)-1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">for </span><span>i = 1:size(c1,2)-1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>                </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(0, 191, 191);">% direction of input vector (angle relative to north, increases clockwise)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">if </span><span>u_1(i,t) &gt;= 0 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">&amp;</span><span> v_1(i,t) &gt;= 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            theta_in = atand(u_1(i,t)/v_1(i,t));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            </span><span style="color: rgb(0, 191, 191);">%theta_in_aux = theta_in</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">elseif </span><span>u_1(i,t) &gt;= 0 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">&amp;</span><span> v_1(i,t) &lt; 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            theta_in = 180 + atand(u_1(i,t)/v_1(i,t));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            </span><span style="color: rgb(0, 191, 191);">%theta_in_aux = theta_in - 90</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">elseif </span><span>u_1(i,t) &lt; 0 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">&amp;</span><span> v_1(i,t) &lt; 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            theta_in = 180 + atand(u_1(i,t)/v_1(i,t));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            </span><span style="color: rgb(0, 191, 191);">%theta_in_aux = theta_in - 180</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">elseif </span><span>u_1(i,t) &lt; 0 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">&amp;</span><span> v_1(i,t) &gt;= 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            theta_in = 360 + atand(u_1(i,t)/v_1(i,t));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            </span><span style="color: rgb(0, 191, 191);">%theta_in_aux = theta_in - 270</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(0, 191, 191);">% direction of speed (angle relative to north, increases clockwise)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">if </span><span>(c1(2,i+1)-c1(2,i)) &gt;= 0 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">&amp;</span><span> (c1(1,i+1)-c1(1,i)) &gt;= 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            theta_rot = atand((c1(1,i+1)-c1(1,i))/(c1(2,i+1)-c1(2,i)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            </span><span style="color: rgb(0, 191, 191);">%theta_rot_aux = 90 - theta_rot</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">elseif </span><span>(c1(2,i+1)-c1(2,i)) &lt; 0 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">&amp;</span><span> (c1(1,i+1)-c1(1,i)) &gt;= 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            theta_rot = 180 + atand((c1(1,i+1)-c1(1,i))/(c1(2,i+1)-c1(2,i)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            </span><span style="color: rgb(0, 191, 191);">%theta_rot_aux = 180 - theta_rot</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">elseif </span><span>(c1(2,i+1)-c1(2,i)) &lt; 0 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">&amp;</span><span> (c1(1,i+1)-c1(1,i)) &lt; 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            theta_rot = 180 + atand((c1(1,i+1)-c1(1,i))/(c1(2,i+1)-c1(2,i)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            </span><span style="color: rgb(0, 191, 191);">%theta_rot_aux = 270 - theta_rot</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">elseif </span><span>(c1(2,i+1)-c1(2,i)) &gt;= 0 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">&amp;</span><span> (c1(1,i+1)-c1(1,i)) &lt; 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            theta_rot = 360 + atand((c1(1,i+1)-c1(1,i))/(c1(2,i+1)-c1(2,i)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            </span><span style="color: rgb(0, 191, 191);">%theta_rot_aux = 360 - theta_rot</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(0, 191, 191);">% direction of speed relative to the new coordinate system</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">if </span><span>theta_in &gt; theta_rot</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            theta_out = theta_in - theta_rot;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            theta_out = 360 - theta_rot + theta_in;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        cross_1(i,t) = uv_in(i,t) * sind(theta_out);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        along_1(i,t) = uv_in(i,t) * cosd(theta_out);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        uv_out = sqrt(along_1.^2 + cross_1.^2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        along_1_u(i,t) = along_1(i,t) * sind(theta_rot);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        along_1_v(i,t) = along_1(i,t) * cosd(theta_rot);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">if </span><span>theta_rot + 90 &gt; 360</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            cross_1_u(i,t) = cross_1(i,t) * sind(theta_rot-270);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            cross_1_v(i,t) = cross_1(i,t) * cosd(theta_rot-270);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            cross_1_u(i,t) = cross_1(i,t) * sind(theta_rot+90);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            cross_1_v(i,t) = cross_1(i,t) * cosd(theta_rot+90);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        clear </span><span style="color: rgb(255, 153, 200);">theta*</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear </span><span style="color: rgb(255, 153, 200);">i t</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Calculate anomalies</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 1:size(c1,2)-1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    along_1_anom(i,:) = along_1(i,:) - nanmean(along_1(i,:));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    cross_1_anom(i,:) = cross_1(i,:) - nanmean(cross_1(i,:));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Remove seasonality</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% calculate monthly averages</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>along_1_mo = NaN(size(along_1,1),12);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>cross_1_mo = NaN(size(along_1,1),12);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>j = 1:size(along_1,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">for </span><span>i = 1:12</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        along_1_mo(j,i) = nanmean(along_1(j,i:12:25*12+i));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        cross_1_mo(j,i) = nanmean(cross_1(j,i:12:25*12+i));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% remove monthly averages</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>along_1_nomo = NaN(size(along_1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>cross_1_nomo = NaN(size(along_1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>j = 1:size(along_1,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">for </span><span>i = 1:26</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        along_1_nomo(j,i*12-11:i*12) = along_1(j,i*12-11:i*12) - along_1_mo(j,:);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        cross_1_nomo(j,i*12-11:i*12) = cross_1(j,i*12-11:i*12) - cross_1_mo(j,:);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Calculate lagged correlations (deseasonalized)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>along_nomo_corrlag = NaN(size(along_1_nomo,1)-40,61);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>along_nomo_p = NaN(size(along_1_nomo,1)-40,61);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>along_nomo_pl = NaN(size(along_1_nomo,1)-40,61);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>along_nomo_pu = NaN(size(along_1_nomo,1)-40,61);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 41:size(along_1,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">for </span><span>l = 0:60</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        [aux_corr,aux_p,aux_pl,aux_pu] = corrcoef(along_1_nomo(41,1:end-1-l),along_1_nomo(i,1+l:end-1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        along_nomo_corrlag(i-40,l+1) = aux_corr(1,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        along_nomo_p(i-40,l+1) = aux_p(1,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        along_nomo_pl(i-40,l+1) = aux_pl(1,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        along_nomo_pu(i-40,l+1) = aux_pu(1,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        clear </span><span style="color: rgb(255, 153, 200);">aux_corr aux_p aux_pl aux_pu</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>along_nomo_corrlag = NaN(size(along_1_nomo,1),61);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>along_nomo_p = NaN(size(along_1_nomo,1),61);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>along_nomo_pl = NaN(size(along_1_nomo,1),61);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>along_nomo_pu = NaN(size(along_1_nomo,1),61);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 1:size(along_1,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">for </span><span>l = -12:48</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">if </span><span>l&gt;=0</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            [aux_corr,aux_p,aux_pl,aux_pu] = corrcoef(along_1_nomo(41,1:end-1-l),along_1_nomo(i,1+l:end-1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            [aux_corr,aux_p,aux_pl,aux_pu] = corrcoef(along_1_nomo(41,1-l:end-1),along_1_nomo(i,1:end-1+l));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        along_nomo_corrlag(i,l+13) = aux_corr(1,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        along_nomo_p(i,l+13) = aux_p(1,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        along_nomo_pl(i,l+13) = aux_pl(1,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        along_nomo_pu(i,l+13) = aux_pu(1,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        clear </span><span style="color: rgb(255, 153, 200);">aux_corr aux_p aux_pl aux_pu</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% u_g_mean = nanmean(u_g,3);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% v_g_mean = nanmean(v_g,3);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% u_g_neg = u_g_mean;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% u_g_neg(u_g_mean&gt;0) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% v_g_neg = v_g_mean;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% v_g_neg(u_g_mean&gt;0) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% u_g_pos = u_g_mean;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% u_g_pos(u_g_mean&lt;=0) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% v_g_pos = v_g_mean;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% v_g_pos(u_g_mean&lt;=0) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>figure(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>, [100, 200, 800, 400])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>subplot(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,[0.08 0.08 0.88 0.88])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>axesm(</span><span style="color: rgb(255, 153, 200);">'MapProjection'</span><span>,</span><span style="color: rgb(255, 153, 200);">'eqdcylin'</span><span>,</span><span style="color: rgb(255, 153, 200);">'MapLatLimit'</span><span>,[35 47],</span><span style="color: rgb(255, 153, 200);">'MapLonLimit'</span><span>,[-76 -46],</span><span style="color: rgb(255, 153, 200);">'MLineLocation'</span><span>,2,</span><span style="color: rgb(255, 153, 200);">'PLineLocation'</span><span>,2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>hold </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>q1 = quivermc([c1(2,1:5:end);c1(2,1:5:end)+10],</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    [c1(1,1:5:end);c1(1,1:5:end)],</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    [u_1(1:5:end,1)';zeros(size(c1(2,1:5:end)))],</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    [v_1(1:5:end,1)';zeros(size(c1(2,1:5:end)))],</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(255, 153, 200);">'reference'</span><span>,10,</span><span style="color: rgb(255, 153, 200);">'arrowstyle'</span><span>,</span><span style="color: rgb(255, 153, 200);">'tail'</span><span>);</span><span style="color: rgb(0, 191, 191);">%,'density',100/10);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(q1,</span><span style="color: rgb(255, 153, 200);">'LineWidth'</span><span>,0.5,</span><span style="color: rgb(255, 153, 200);">'Color'</span><span>,rgb(</span><span style="color: rgb(255, 153, 200);">'Black'</span><span>))</span><span style="color: rgb(0, 191, 191);">%,'MaxHeadSize',0.5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>q2 = quivermc([c1(2,1:5:end);c1(2,1:5:end)+10],</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    [c1(1,1:5:end);c1(1,1:5:end)],</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    [along_1_u(1:5:end,1)';zeros(size(c1(2,1:5:end)))],</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    [along_1_v(1:5:end,1)';zeros(size(c1(2,1:5:end)))],</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(255, 153, 200);">'reference'</span><span>,10,</span><span style="color: rgb(255, 153, 200);">'arrowstyle'</span><span>,</span><span style="color: rgb(255, 153, 200);">'tail'</span><span>);</span><span style="color: rgb(0, 191, 191);">%,'density',100/10);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(q2,</span><span style="color: rgb(255, 153, 200);">'LineWidth'</span><span>,0.5,</span><span style="color: rgb(255, 153, 200);">'Color'</span><span>,rgb(</span><span style="color: rgb(255, 153, 200);">'DarkRed'</span><span>))</span><span style="color: rgb(0, 191, 191);">%,'MaxHeadSize',0.5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>q3 = quivermc([c1(2,1:5:end);c1(2,1:5:end)+10],</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    [c1(1,1:5:end);c1(1,1:5:end)],</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    [cross_1_u(1:5:end,1)';zeros(size(c1(2,1:5:end)))],</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    [cross_1_v(1:5:end,1)';zeros(size(c1(2,1:5:end)))],</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(255, 153, 200);">'reference'</span><span>,10,</span><span style="color: rgb(255, 153, 200);">'arrowstyle'</span><span>,</span><span style="color: rgb(255, 153, 200);">'tail'</span><span>);</span><span style="color: rgb(0, 191, 191);">%,'density',100/10);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(q3,</span><span style="color: rgb(255, 153, 200);">'LineWidth'</span><span>,0.5,</span><span style="color: rgb(255, 153, 200);">'Color'</span><span>,rgb(</span><span style="color: rgb(255, 153, 200);">'MidnightBlue'</span><span>))</span><span style="color: rgb(0, 191, 191);">%,'MaxHeadSize',0.5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%quiverm(c1(2,1:5:end),c1(1,1:5:end),v_1(1:5:end,1)',u_1(1:5:end,1)','k')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%quiverm(c1(2,1:5:end-1),c1(1,1:5:end-1),along_1_v(1:5:end,1)',along_1_u(1:5:end,1)','r')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%quiverm(c1(2,1:5:end-1),c1(1,1:5:end-1),cross_1_v(1:5:end,1)',cross_1_u(1:5:end,1)','b')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>q5 = quivermc([39.5 49.5;59.5 69.5],[-59.9 -69.9;-79.9 -89.9],</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    [0 0;0 0],[6 0;0 0],</span><span style="color: rgb(255, 153, 200);">'reference'</span><span>,6,</span><span style="color: rgb(255, 153, 200);">'arrowstyle'</span><span>,</span><span style="color: rgb(255, 153, 200);">'tail'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(q5,</span><span style="color: rgb(255, 153, 200);">'LineWidth'</span><span>,0.5,</span><span style="color: rgb(255, 153, 200);">'Color'</span><span>,rgb(</span><span style="color: rgb(255, 153, 200);">'Black'</span><span>))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>q6 = quivermc([38.75 49.5;59.5 69.5],[-59.9 -69.9;-79.9 -89.9],</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    [0 0;0 0],[6 0;0 0],</span><span style="color: rgb(255, 153, 200);">'reference'</span><span>,6,</span><span style="color: rgb(255, 153, 200);">'arrowstyle'</span><span>,</span><span style="color: rgb(255, 153, 200);">'tail'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(q6,</span><span style="color: rgb(255, 153, 200);">'LineWidth'</span><span>,0.5,</span><span style="color: rgb(255, 153, 200);">'Color'</span><span>,rgb(</span><span style="color: rgb(255, 153, 200);">'DarkRed'</span><span>))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>q7 = quivermc([38 49.5;59.5 69.5],[-59.9 -69.9;-79.9 -89.9],</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    [0 0;0 0],[6 0;0 0],</span><span style="color: rgb(255, 153, 200);">'reference'</span><span>,6,</span><span style="color: rgb(255, 153, 200);">'arrowstyle'</span><span>,</span><span style="color: rgb(255, 153, 200);">'tail'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(q6,</span><span style="color: rgb(255, 153, 200);">'LineWidth'</span><span>,0.5,</span><span style="color: rgb(255, 153, 200);">'Color'</span><span>,rgb(</span><span style="color: rgb(255, 153, 200);">'MidnightBlue'</span><span>))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%quiverm(39.5,-59.9,0,2,'Color',rgb('Black'))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%quiverm(38.75,-59.9,0,2,'Color',rgb('DarkRed'))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%quiverm(38,-59.9,0,2,'Color',rgb('MidnightBlue'))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>textm(39.5,-57.7,</span><span style="color: rgb(255, 153, 200);">'Mean Speed'</span><span>,</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,rgb(</span><span style="color: rgb(255, 153, 200);">'Black'</span><span>),</span><span style="color: rgb(255, 153, 200);">'fontsize'</span><span>,18)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>textm(38.75,-57.7,</span><span style="color: rgb(255, 153, 200);">'Along-slope component'</span><span>,</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,rgb(</span><span style="color: rgb(255, 153, 200);">'DarkRed'</span><span>),</span><span style="color: rgb(255, 153, 200);">'fontsize'</span><span>,18)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>textm(38,-57.7,</span><span style="color: rgb(255, 153, 200);">'Cross-slope component'</span><span>,</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,rgb(</span><span style="color: rgb(255, 153, 200);">'MidnightBlue'</span><span>),</span><span style="color: rgb(255, 153, 200);">'fontsize'</span><span>,18)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-100 -100],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[200/256 200/256 200/256],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-1000 -1000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[200/256 200/256 200/256],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>geoshow(</span><span style="color: rgb(255, 153, 200);">'GSHHS_i_L1.shp'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FaceColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%f1 = fillm([37,41,41,37],[-79.7,-79.7,-73.5,-73.5],'w');</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%f1.FaceColor = 'w';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%f1.EdgeColor = 'w';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%f1.FaceAlpha = 0.75;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%f1.EdgeAlpha = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>q4 = quivermc([36.3 36.3;35 36],[-72 -69;-72 -60],[2 0; 0 0],[0 0; 0 0],</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(255, 153, 200);">'reference'</span><span>,10,</span><span style="color: rgb(255, 153, 200);">'arrowstyle'</span><span>,</span><span style="color: rgb(255, 153, 200);">'tail'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(q4,</span><span style="color: rgb(255, 153, 200);">'LineWidth'</span><span>,2,</span><span style="color: rgb(255, 153, 200);">'Color'</span><span>,rgb(</span><span style="color: rgb(255, 153, 200);">'Black'</span><span>))</span><span style="color: rgb(0, 191, 191);">%,'MaxHeadSize',0.5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>textm(36.45,-70.7,</span><span style="color: rgb(255, 153, 200);">'2 cm s^{-1}'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Color'</span><span>,rgb(</span><span style="color: rgb(255, 153, 200);">'Black'</span><span>),</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,18)</span><span style="color: rgb(0, 191, 191);">%,'Fontweight','bold')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plabel(</span><span style="color: rgb(255, 153, 200);">'PLabelLocation'</span><span>,2,</span><span style="color: rgb(255, 153, 200);">'fontsize'</span><span>,14)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>mlabel(</span><span style="color: rgb(255, 153, 200);">'MLabelLocation'</span><span>,4,</span><span style="color: rgb(255, 153, 200);">'MLabelParallel'</span><span>,</span><span style="color: rgb(255, 153, 200);">'south'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>gridm</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>tightmap</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(gcf, </span><span style="color: rgb(255, 153, 200);">'Color'</span><span>, </span><span style="color: rgb(255, 153, 200);">'w'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>saveas(gcf,[output_dir,</span><span style="color: rgb(255, 153, 200);">'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_SupplementalFigure2_pre_revised'</span><span>],</span><span style="color: rgb(255, 153, 200);">'epsc'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clearvars </span><span style="color: rgb(255, 153, 200);">-except *_dir</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>close </span><span style="color: rgb(255, 153, 200);">all</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%% Supplemental Figure 3</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Set  directory to save data</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>data_dir = </span><span style="color: rgb(255, 153, 200);">'/Users/afonso/Documents/Research/TGB/data/'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Set directory to save figures and tables</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>output_dir = </span><span style="color: rgb(255, 153, 200);">'/Users/afonso/Documents/Research/TGB/output/'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%T2 = readtable('Z149mat2.xlsx','TreatAsEmpty',["NA"]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T = readtable(</span><span style="color: rgb(255, 153, 200);">'Z149mat22.csv'</span><span>, </span><span style="color: rgb(255, 153, 200);">'HeaderLines'</span><span>,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T1 = table2array(T);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T1(T1==0) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T149_change_point = NaN(1,1271);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T149_change = NaN(1,1271);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>j = 1:1271</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">if </span><span>sum(~isnan(T1(:,j))) &gt;= 1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        T149_change_point(1,j) = find(~isnan(T1(:,j)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        T149_change(1,j) = T1(T149_change_point(1,j),j);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%     aux = T1(:,j);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%     aux1 = ~isnan(T1(:,j))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%     for i = 1:264</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%         aux = ~isnan(T1(i,j));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%         %aux = strcmp(T1(i,j),{'NA'});</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%         if aux==0</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%             T149_change_point(1,j) = i;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%             T149_change(1,j) = T1(i,j);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%         end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%     end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T149_change_reshape = reshape(T149_change,41,31);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T149_change_point_reshape = reshape(T149_change_point,41,31);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Set window to Jan/2009 to Dec/2011</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T149_change_reshape_20092011 = T149_change_reshape;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T149_change_reshape_20092011(T149_change_point_reshape&lt;193 | T149_change_point_reshape&gt;228) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T149_change_point_reshape_20092011 = T149_change_point_reshape;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T149_change_point_reshape_20092011(T149_change_point_reshape&lt;193 | T149_change_point_reshape&gt;228) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Set window to Apr/2009 to Jun/2009</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T149_change_reshape_2009 = T149_change_reshape;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T149_change_reshape_2009(T149_change_point_reshape&lt;196 | T149_change_point_reshape&gt;198) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T149_change_point_reshape_2009 = T149_change_point_reshape;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T149_change_point_reshape_2009(T149_change_point_reshape&lt;196 | T149_change_point_reshape&gt;198) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>load([output_dir,</span><span style="color: rgb(255, 153, 200);">'etopo1_TGB.mat'</span><span>],</span><span style="color: rgb(255, 153, 200);">'lat_z'</span><span>,</span><span style="color: rgb(255, 153, 200);">'lon_z'</span><span>,</span><span style="color: rgb(255, 153, 200);">'z'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%load([output_dir,'SSH_TGB.mat'],'time_month','lat_ssh','lon_ssh','u_g','v_g')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>load([data_dir,</span><span style="color: rgb(255, 153, 200);">'en4_NWA2.mat'</span><span>],</span><span style="color: rgb(255, 153, 200);">'t_en4'</span><span>,</span><span style="color: rgb(255, 153, 200);">'t_unc_en4'</span><span>,</span><span style="color: rgb(255, 153, 200);">'lon_en4'</span><span>,</span><span style="color: rgb(255, 153, 200);">'lat_en4'</span><span>,</span><span style="color: rgb(255, 153, 200);">'time_en4'</span><span>,</span><span class="warning_squiggle_rte1619232262" style="color: rgb(255, 153, 200);">'depth_en4'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span class="warning_squiggle_rte1619232262">time_ssh</span><span> = time_en4(93*12+1:end-9);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>t_en4 = t_en4 - 273.15;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>figure(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>, [100, 200, 800, 600])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sp2 = subplot(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,[0.08 0.08 0.88 0.88]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>axesm(</span><span style="color: rgb(255, 153, 200);">'MapProjection'</span><span>,</span><span style="color: rgb(255, 153, 200);">'eqdcylin'</span><span>,</span><span style="color: rgb(255, 153, 200);">'MapLatLimit'</span><span>,[33 50],</span><span style="color: rgb(255, 153, 200);">'MapLonLimit'</span><span>,[-77 -48])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>hold </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%t_diff = t10002000_en4_2009_2018' - t10002000_en4_2001_2007';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>pcolorm(lat_en4,lon_en4,T149_change_reshape_20092011')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>shading </span><span style="color: rgb(255, 153, 200);">flat</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>caxis([min(min(T149_change_reshape_20092011)) max(max(T149_change_reshape_20092011))])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>colormap(sp2,cmocean(</span><span style="color: rgb(255, 153, 200);">'balance'</span><span>,8,</span><span style="color: rgb(255, 153, 200);">'pivot'</span><span>,0))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%h = colorbar;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>caxis([-1.5 2.5])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%ylabel(h,'Time of Change Point','Fontsize',14)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%set(h,'Fontsize',14,'ytick',[193;199;205;211;217;223],'yticklabel',[datestr(time_ssh(193),'mmmyy');datestr(time_ssh(199),'mmmyy');datestr(time_ssh(205),'mmmyy');datestr(time_ssh(211),'mmmyy');datestr(time_ssh(217),'mmmyy');datestr(time_ssh(223),'mmmyy')])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-100 -100],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-1000 -1000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-3000 -3000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-4000 -4000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>fillm([33.1,33.1,36.2,36.2],[-65,-48.1,-48.1,-65],</span><span style="color: rgb(255, 153, 200);">'facecolor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>,</span><span style="color: rgb(255, 153, 200);">'edgecolor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c = colorbar(</span><span style="color: rgb(255, 153, 200);">'Orientation'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Horizontal'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,[0.51 0.22 0.32 0.048],</span><span style="color: rgb(255, 153, 200);">'Color'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,10);</span><span style="color: rgb(0, 191, 191);">%colorbar over land</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c.Label.String = </span><span style="color: rgb(255, 153, 200);">'T_{149m} Change (\circC)'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(c,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,16)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%set(c,'Fontsize',14,'Fontweight','bold','ytick',[193;211;229],'yticklabel',[datestr(time_ssh(193),'mmmyy');datestr(time_ssh(211),'mmmyy');datestr(time_ssh(229),'mmmyy')])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>linem([44.5 46],[360-56.3 360-57.8],</span><span style="color: rgb(255, 153, 200);">':w'</span><span>,</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,3)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>linem([41.6 42.6],[360-65 360-67],</span><span style="color: rgb(255, 153, 200);">':w'</span><span>,</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,3)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>linem([41 41.9],[360-69 360-69],</span><span style="color: rgb(255, 153, 200);">':k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,3)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>linem([40.4 41],[360-69 360-69],</span><span style="color: rgb(255, 153, 200);">':w'</span><span>,</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,3)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>textm(46.5,360-58.5,</span><span style="color: rgb(255, 153, 200);">'LCh'</span><span>,</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,16,</span><span style="color: rgb(255, 153, 200);">'Fontweight'</span><span>,</span><span style="color: rgb(255, 153, 200);">'bold'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>textm(43,360-67,</span><span style="color: rgb(255, 153, 200);">'NECh'</span><span>,</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,16,</span><span style="color: rgb(255, 153, 200);">'Fontweight'</span><span>,</span><span style="color: rgb(255, 153, 200);">'bold'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>textm(40.5,360-71.3,</span><span style="color: rgb(255, 153, 200);">'GSCh'</span><span>,</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,16,</span><span style="color: rgb(255, 153, 200);">'Fontweight'</span><span>,</span><span style="color: rgb(255, 153, 200);">'bold'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>textm(35,360-75.3,</span><span style="color: rgb(255, 153, 200);">'CH'</span><span>,</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,16,</span><span style="color: rgb(255, 153, 200);">'Fontweight'</span><span>,</span><span style="color: rgb(255, 153, 200);">'bold'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(gca,</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,14)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>geoshow(</span><span style="color: rgb(255, 153, 200);">'GSHHS_i_L1.shp'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FaceColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span><span style="color: rgb(0, 191, 191);">%[.7 .7 .7])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plabel(</span><span style="color: rgb(255, 153, 200);">'PLabelLocation'</span><span>,5,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,14)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>mlabel(</span><span style="color: rgb(255, 153, 200);">'MLabelLocation'</span><span>,5,</span><span style="color: rgb(255, 153, 200);">'MLabelParallel'</span><span>,</span><span style="color: rgb(255, 153, 200);">'south'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,14)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%title('Change Point of 150-m Deseasonalized Temperature (1993-2018)','fontsize',16)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>framem</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>tightmap</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(gcf, </span><span style="color: rgb(255, 153, 200);">'Color'</span><span>, </span><span style="color: rgb(255, 153, 200);">'w'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>saveas(gcf,[output_dir,</span><span style="color: rgb(255, 153, 200);">'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_SupplementalFigure3_pre'</span><span>],</span><span style="color: rgb(255, 153, 200);">'epsc'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clearvars </span><span style="color: rgb(255, 153, 200);">-except *_dir</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>close </span><span style="color: rgb(255, 153, 200);">all</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%% Supplemental Figure 4</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Set  directory to save data</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>data_dir = </span><span style="color: rgb(255, 153, 200);">'/Users/afonso/Documents/Research/TGB/data/'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Set directory to save figures and tables</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>output_dir = </span><span style="color: rgb(255, 153, 200);">'/Users/afonso/Documents/Research/TGB/output/'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>load([data_dir,</span><span style="color: rgb(255, 153, 200);">'EN4_profiles_TGB_AMJ_dec_postQC.mat'</span><span>])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Create structure with all profiles</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>decade = 1930:10:2010;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>k = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 1:9</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    disp(num2str(decade(i)))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">for </span><span>j = 1:eval([</span><span style="color: rgb(255, 153, 200);">'length(EN4_profiles_TGB_AMJ_dec.d'</span><span>,num2str(decade(i)),</span><span style="color: rgb(255, 153, 200);">'.lat)'</span><span>])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        eval([</span><span style="color: rgb(255, 153, 200);">'tail_EN4(k).Latitude = EN4_profiles_TGB_AMJ_dec.d'</span><span>,num2str(decade(i)),</span><span style="color: rgb(255, 153, 200);">'.lat(j);'</span><span>])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        eval([</span><span style="color: rgb(255, 153, 200);">'tail_EN4(k).Longitude = EN4_profiles_TGB_AMJ_dec.d'</span><span>,num2str(decade(i)),</span><span style="color: rgb(255, 153, 200);">'.lon(j);'</span><span>])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        eval([</span><span style="color: rgb(255, 153, 200);">'tail_EN4(k).Time = EN4_profiles_TGB_AMJ_dec.d'</span><span>,num2str(decade(i)),</span><span style="color: rgb(255, 153, 200);">'.time(j);'</span><span>])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        eval([</span><span style="color: rgb(255, 153, 200);">'tail_EN4(k).Pressure = EN4_profiles_TGB_AMJ_dec.d'</span><span>,num2str(decade(i)),</span><span style="color: rgb(255, 153, 200);">'.depth(:,j);'</span><span>])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        eval([</span><span style="color: rgb(255, 153, 200);">'tail_EN4(k).Temperature = EN4_profiles_TGB_AMJ_dec.d'</span><span>,num2str(decade(i)),</span><span style="color: rgb(255, 153, 200);">'.temperature(:,j);'</span><span>])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        eval([</span><span style="color: rgb(255, 153, 200);">'tail_EN4(k).Salinity = EN4_profiles_TGB_AMJ_dec.d'</span><span>,num2str(decade(i)),</span><span style="color: rgb(255, 153, 200);">'.salinity(:,j);'</span><span>])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        k = k + 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear </span><span style="color: rgb(255, 153, 200);">EN4* i j k </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>p_interp = [0:5:100,125:25:250,300:50:1500,1550:250:2050]';</span><span style="color: rgb(0, 191, 191);">%in the manuscript as of Jun 9, 2020</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>year = 1930:10:2020;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Average profiles over depths determined in p_interp (only 5,153 valid</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% profiles)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>tail_EN4_1 = tail_EN4(1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>k_yes = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>k_no = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 1:length(tail_EN4)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">if </span><span>sum(isnan(tail_EN4(i).Temperature)) == length(tail_EN4(i).Temperature)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        k_no = k_no + 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">elseif </span><span>~isempty(find(diff(tail_EN4(i).Pressure)&lt;=0,1))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        k_no = k_no + 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        k_yes = k_yes + 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        tail_EN4_1(k_yes).Latitude = tail_EN4(i).Latitude;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        tail_EN4_1(k_yes).Longitude = tail_EN4(i).Longitude;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        tail_EN4_1(k_yes).Time = tail_EN4(i).Time;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        tail_EN4_1(k_yes).Pressure = p_interp;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        tail_EN4_1(k_yes).Temperature = interp1(tail_EN4(i).Pressure(~isnan(tail_EN4(i).Pressure)),tail_EN4(i).Temperature(~isnan(tail_EN4(i).Pressure)),p_interp);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        tail_EN4_1(k_yes).Salinity = interp1(tail_EN4(i).Pressure(~isnan(tail_EN4(i).Pressure)),tail_EN4(i).Salinity(~isnan(tail_EN4(i).Pressure)),p_interp);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear </span><span style="color: rgb(255, 153, 200);">p_interp s_tail_series t_tail_series tail_EN4 i k_no decade</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Load ETOPO1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%ncdisp('/Users/afonso/Documents/Data/ETOPO1_Bed_g_gmt4.grd')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>x = ncread(</span><span style="color: rgb(255, 153, 200);">'/Users/afonso/Google Drive/Data/ETOPO1_Bed_g_gmt4.grd'</span><span>,</span><span style="color: rgb(255, 153, 200);">'x'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>lon_z = x(x&lt;=(320-360) &amp; x&gt;=(280-360)); </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>lon_z = lon_z+360;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>y = ncread(</span><span style="color: rgb(255, 153, 200);">'/Users/afonso/Google Drive/Data/ETOPO1_Bed_g_gmt4.grd'</span><span>,</span><span style="color: rgb(255, 153, 200);">'y'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>lat_z = y(y&lt;=60 &amp; y&gt;=30); </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>z_aux = ncread(</span><span style="color: rgb(255, 153, 200);">'/Users/afonso/Google Drive/Data/ETOPO1_Bed_g_gmt4.grd'</span><span>,</span><span style="color: rgb(255, 153, 200);">'z'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>z = z_aux(x&lt;=(320-360) &amp; x&gt;=(280-360),y&lt;=60 &amp; y&gt;=30); z = z';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%z = z(8:15:end-7,8:15:end-8);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear </span><span style="color: rgb(255, 153, 200);">x y z_aux</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plotcolor = linspecer(3);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>pos_9panel = [0.08,0.7,0.27,0.27;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    0.39,0.7,0.27,0.27;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    0.70,0.7,0.27,0.27;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    0.08,0.39,0.27,0.27;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    0.39,0.39,0.27,0.27;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    0.70,0.39,0.27,0.27;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    0.08,0.08,0.27,0.27;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    0.39,0.08,0.27,0.27;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    0.70,0.08,0.27,0.27];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Color-coded by year</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>figure(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>, [100, 200, 1100, 700])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%subplot('Position',[0.06 0.15 0.88 0.78])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 1:length(year)-1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 191, 191);">%subplot(3,3,i-3)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    subplot(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,pos_9panel(i,:))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    axesm(</span><span style="color: rgb(255, 153, 200);">'MapProjection'</span><span>,</span><span style="color: rgb(255, 153, 200);">'eqdcylin'</span><span>,</span><span style="color: rgb(255, 153, 200);">'MapLatLimit'</span><span>,[41 44],</span><span style="color: rgb(255, 153, 200);">'MapLonLimit'</span><span>,[-53 -48])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    hold </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    contourm(lat_z(1:2:end),lon_z(1:2:end),z(1:2:end,1:2:end),</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        [-100 -100],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    contourm(lat_z(1:2:end),lon_z(1:2:end),z(1:2:end,1:2:end),</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        [-1000 -1000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    contourm(lat_z(1:2:end),lon_z(1:2:end),z(1:2:end,1:2:end),</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        [-3000 -3000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    contourm(lat_z(1:2:end),lon_z(1:2:end),z(1:2:end,1:2:end),</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        [-4000 -4000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    profile_aux1 = find([tail_EN4_1.Time] &gt;= datenum([num2str(year(i)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>) &amp; </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        [tail_EN4_1.Time] &lt; datenum([num2str(year(i+1)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>) &amp; </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span class="warning_squiggle_rte1619232262">str2num</span><span>(datestr([tail_EN4_1.Time],</span><span style="color: rgb(255, 153, 200);">'mm'</span><span>))' == 4);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    profile_aux2 = find([tail_EN4_1.Time] &gt;= datenum([num2str(year(i)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>) &amp; </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        [tail_EN4_1.Time] &lt; datenum([num2str(year(i+1)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>) &amp; </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span class="warning_squiggle_rte1619232262">str2num</span><span>(datestr([tail_EN4_1.Time],</span><span style="color: rgb(255, 153, 200);">'mm'</span><span>))' == 5);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    profile_aux3 = find([tail_EN4_1.Time] &gt;= datenum([num2str(year(i)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>) &amp; </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        [tail_EN4_1.Time] &lt; datenum([num2str(year(i+1)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>) &amp; </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span class="warning_squiggle_rte1619232262">str2num</span><span>(datestr([tail_EN4_1.Time],</span><span style="color: rgb(255, 153, 200);">'mm'</span><span>))' == 6);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    lat_aux1 = [tail_EN4_1(profile_aux1).Latitude];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    lat_aux2 = [tail_EN4_1(profile_aux2).Latitude];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    lat_aux3 = [tail_EN4_1(profile_aux3).Latitude];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    lon_aux1 = [tail_EN4_1(profile_aux1).Longitude];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    lon_aux2 = [tail_EN4_1(profile_aux2).Longitude];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    lon_aux3 = [tail_EN4_1(profile_aux3).Longitude];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    count_profiles = length(lat_aux1) + length(lat_aux2) + length(lat_aux3);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    scatterm(lat_aux1,lon_aux1,20,plotcolor(1,:),</span><span style="color: rgb(255, 153, 200);">'filled'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    scatterm(lat_aux2,lon_aux2,20,plotcolor(2,:),</span><span style="color: rgb(255, 153, 200);">'filled'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    scatterm(lat_aux3,lon_aux3,20,plotcolor(3,:),</span><span style="color: rgb(255, 153, 200);">'filled'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%     for j = 1:10</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%         scatter(</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%         eval(['scatterm(EN4_profiles_TGB.y',num2str(decade(i)+j-1),'.m04.lat,EN4_profiles_TGB.y',num2str(decade(i)+j-1),'.m04.lon,20,plotcolor(1,:),''filled'')'])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%         eval(['scatterm(EN4_profiles_TGB.y',num2str(decade(i)+j-1),'.m05.lat,EN4_profiles_TGB.y',num2str(decade(i)+j-1),'.m05.lon,20,plotcolor(2,:),''filled'')'])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%         eval(['scatterm(EN4_profiles_TGB.y',num2str(decade(i)+j-1),'.m06.lat,EN4_profiles_TGB.y',num2str(decade(i)+j-1),'.m06.lon,20,plotcolor(3,:),''filled'')'])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%         eval(['count_profiles = count_profiles + length(EN4_profiles_TGB.y',num2str(decade(i)+j-1),'.m04.lat);'])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%         eval(['count_profiles = count_profiles + length(EN4_profiles_TGB.y',num2str(decade(i)+j-1),'.m05.lat);'])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%         eval(['count_profiles = count_profiles + length(EN4_profiles_TGB.y',num2str(decade(i)+j-1),'.m06.lat);'])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%     end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    set(gca,</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,16)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    title([num2str(year(i)),</span><span style="color: rgb(255, 153, 200);">'s: '</span><span>,num2str(count_profiles),</span><span style="color: rgb(255, 153, 200);">' profiles'</span><span>])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 191, 191);">%geoshow('GSHHS_l_L1.shp','FaceColor','k')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">if </span><span>i == 1 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">|</span><span> i == 4 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">|</span><span> i == 7</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    plabel(</span><span style="color: rgb(255, 153, 200);">'PLabelLocation'</span><span>,1,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,16)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        plabel(</span><span style="color: rgb(255, 153, 200);">'off'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">if </span><span>i == 7 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">|</span><span> i == 8 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">|</span><span> i == 9</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        mlabel(</span><span style="color: rgb(255, 153, 200);">'MLabelLocation'</span><span>,2,</span><span style="color: rgb(255, 153, 200);">'MLabelParallel'</span><span>,</span><span style="color: rgb(255, 153, 200);">'south'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,16)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        mlabel(</span><span style="color: rgb(255, 153, 200);">'off'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 191, 191);">%title('Change Point of 150-m Deseasonalized Temperature (1993-2018)','fontsize',16)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    framem</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    tightmap</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    set(gcf, </span><span style="color: rgb(255, 153, 200);">'Color'</span><span>, </span><span style="color: rgb(255, 153, 200);">'w'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    clear </span><span style="color: rgb(255, 153, 200);">*aux* count_profiles</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear </span><span style="color: rgb(255, 153, 200);">i plotcolor</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>saveas(gcf,[output_dir,</span><span style="color: rgb(255, 153, 200);">'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_SupplementalFigure4_pre'</span><span>],</span><span style="color: rgb(255, 153, 200);">'epsc'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clearvars </span><span style="color: rgb(255, 153, 200);">-except *_dir</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>close </span><span style="color: rgb(255, 153, 200);">all</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%% Supplemental Figure 5</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Set  directory to save data</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>data_dir = </span><span style="color: rgb(255, 153, 200);">'/Users/afonso/Documents/Research/TGB/data/'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Set directory to save figures and tables</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>output_dir = </span><span style="color: rgb(255, 153, 200);">'/Users/afonso/Documents/Research/TGB/output/'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>load([output_dir,</span><span style="color: rgb(255, 153, 200);">'etopo1_TGB.mat'</span><span>],</span><span style="color: rgb(255, 153, 200);">'lat_z'</span><span>,</span><span style="color: rgb(255, 153, 200);">'lon_z'</span><span>,</span><span style="color: rgb(255, 153, 200);">'z'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>load([data_dir,</span><span style="color: rgb(255, 153, 200);">'en4_NWA2.mat'</span><span>],</span><span style="color: rgb(255, 153, 200);">'lon_en4'</span><span>,</span><span style="color: rgb(255, 153, 200);">'lat_en4'</span><span>,</span><span style="color: rgb(255, 153, 200);">'time_en4'</span><span>,</span><span style="color: rgb(255, 153, 200);">'depth_en4'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>time_ssh = time_en4(93*12+1:end-9);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% T122 from Joe</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T = readtable(</span><span style="color: rgb(255, 153, 200);">'Z122mat2.csv'</span><span>, </span><span style="color: rgb(255, 153, 200);">'HeaderLines'</span><span>,0);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T1 = table2array(T);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T1(T1==0) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T122_change_point = NaN(1,1271);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T122_change = NaN(1,1271);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>j = 1:1271</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">if </span><span>sum(~isnan(T1(:,j))) &gt;= 1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        T122_change_point(1,j) = find(~isnan(T1(:,j)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        T122_change(1,j) = T1(T122_change_point(1,j),j);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T122_change_reshape = reshape(T122_change,41,31);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T122_change_point_reshape = reshape(T122_change_point,41,31);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear </span><span style="color: rgb(255, 153, 200);">T T1 j</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% T135 from Joe</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T = readtable(</span><span style="color: rgb(255, 153, 200);">'Z135mat2.csv'</span><span>, </span><span style="color: rgb(255, 153, 200);">'HeaderLines'</span><span>,0);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T1 = table2array(T);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T1(T1==0) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T135_change_point = NaN(1,1271);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T135_change = NaN(1,1271);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>j = 1:1271</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">if </span><span>sum(~isnan(T1(:,j))) &gt;= 1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        T135_change_point(1,j) = find(~isnan(T1(:,j)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        T135_change(1,j) = T1(T135_change_point(1,j),j);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T135_change_reshape = reshape(T135_change,41,31);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T135_change_point_reshape = reshape(T135_change_point,41,31);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear </span><span style="color: rgb(255, 153, 200);">T T1 j</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% T166 from Joe</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T = readtable(</span><span style="color: rgb(255, 153, 200);">'Z166mat2.csv'</span><span>, </span><span style="color: rgb(255, 153, 200);">'HeaderLines'</span><span>,0);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T1 = table2array(T);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T1(T1==0) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T166_change_point = NaN(1,1271);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T166_change = NaN(1,1271);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>j = 1:1271</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">if </span><span>sum(~isnan(T1(:,j))) &gt;= 1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        T166_change_point(1,j) = find(~isnan(T1(:,j)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        T166_change(1,j) = T1(T166_change_point(1,j),j);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T166_change_reshape = reshape(T166_change,41,31);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T166_change_point_reshape = reshape(T166_change_point,41,31);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear </span><span style="color: rgb(255, 153, 200);">T T1 j</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% T185 from Joe</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T = readtable(</span><span style="color: rgb(255, 153, 200);">'Z185mat2.csv'</span><span>, </span><span style="color: rgb(255, 153, 200);">'HeaderLines'</span><span>,0);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T1 = table2array(T);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T1(T1==0) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T185_change_point = NaN(1,1271);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T185_change = NaN(1,1271);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>j = 1:1271</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">if </span><span>sum(~isnan(T1(:,j))) &gt;= 1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        T185_change_point(1,j) = find(~isnan(T1(:,j)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        T185_change(1,j) = T1(T185_change_point(1,j),j);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T185_change_reshape = reshape(T185_change,41,31);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T185_change_point_reshape = reshape(T185_change_point,41,31);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear </span><span style="color: rgb(255, 153, 200);">T T1 j</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Set window to Jan/2009 to Dec/2011</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T122_change_reshape_20092011 = T122_change_reshape;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T122_change_reshape_20092011(T122_change_point_reshape&lt;193 | T122_change_point_reshape&gt;228) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T122_change_point_reshape_20092011 = T122_change_point_reshape;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T122_change_point_reshape_20092011(T122_change_point_reshape&lt;193 | T122_change_point_reshape&gt;228) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T135_change_reshape_20092011 = T135_change_reshape;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T135_change_reshape_20092011(T135_change_point_reshape&lt;193 | T135_change_point_reshape&gt;228) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T135_change_point_reshape_20092011 = T135_change_point_reshape;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T135_change_point_reshape_20092011(T135_change_point_reshape&lt;193 | T135_change_point_reshape&gt;228) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T166_change_reshape_20092011 = T166_change_reshape;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T166_change_reshape_20092011(T166_change_point_reshape&lt;193 | T166_change_point_reshape&gt;228) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T166_change_point_reshape_20092011 = T166_change_point_reshape;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T166_change_point_reshape_20092011(T166_change_point_reshape&lt;193 | T166_change_point_reshape&gt;228) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T185_change_reshape_20092011 = T185_change_reshape;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T185_change_reshape_20092011(T185_change_point_reshape&lt;193 | T185_change_point_reshape&gt;228) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T185_change_point_reshape_20092011 = T185_change_point_reshape;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T185_change_point_reshape_20092011(T185_change_point_reshape&lt;193 | T185_change_point_reshape&gt;228) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Create negative value outside of the plotted area to avoid crashing because pivot=0</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T185_change_reshape_20092011(end,end) = -0.5;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>figure(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>, [100, 200, 600, 650])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% 122-m change point</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sp1 = subplot(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,[0.08 0.79 0.4 0.19]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>axesm(</span><span style="color: rgb(255, 153, 200);">'MapProjection'</span><span>,</span><span style="color: rgb(255, 153, 200);">'eqdcylin'</span><span>,</span><span style="color: rgb(255, 153, 200);">'MapLatLimit'</span><span>,[33 50],</span><span style="color: rgb(255, 153, 200);">'MapLonLimit'</span><span>,[-77 -48])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>hold </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>pcolorm(lat_en4,lon_en4,T122_change_point_reshape_20092011')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>shading </span><span style="color: rgb(255, 153, 200);">flat</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>colormap(sp1,crameri(</span><span style="color: rgb(255, 153, 200);">'nuuk'</span><span>,12))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>caxis([193 229])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-100 -100],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-1000 -1000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-3000 -3000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-4000 -4000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>fillm([33.1,33.1,36.2,36.2],[-65,-48.1,-48.1,-65],</span><span style="color: rgb(255, 153, 200);">'facecolor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>,</span><span style="color: rgb(255, 153, 200);">'edgecolor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>textm(45,-75,</span><span style="color: rgb(255, 153, 200);">'122 m'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,12,</span><span style="color: rgb(255, 153, 200);">'FontWeight'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Bold'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Color'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c = colorbar(</span><span style="color: rgb(255, 153, 200);">'Orientation'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Horizontal'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,[0.08 0.07 0.4 0.02],</span><span style="color: rgb(255, 153, 200);">'Color'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,10);</span><span style="color: rgb(0, 191, 191);">%colorbar over land</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c.Label.String = </span><span style="color: rgb(255, 153, 200);">'T Change Point'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(c,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,12,</span><span style="color: rgb(255, 153, 200);">'ytick'</span><span>,[193;211;229],</span><span style="color: rgb(255, 153, 200);">'yticklabel'</span><span>,[datestr(time_ssh(193),</span><span style="color: rgb(255, 153, 200);">'mmmyy'</span><span>);datestr(time_ssh(211),</span><span style="color: rgb(255, 153, 200);">'mmmyy'</span><span>);datestr(time_ssh(229),</span><span style="color: rgb(255, 153, 200);">'mmmyy'</span><span>)])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(gca,</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,12)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>geoshow(</span><span style="color: rgb(255, 153, 200);">'GSHHS_i_L1.shp'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FaceColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span><span style="color: rgb(0, 191, 191);">%[.7 .7 .7])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plabel(</span><span style="color: rgb(255, 153, 200);">'PLabelLocation'</span><span>,5,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,12,</span><span style="color: rgb(255, 153, 200);">'FontColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>mlabel(</span><span style="color: rgb(255, 153, 200);">'MLabelLocation'</span><span>,100,</span><span style="color: rgb(255, 153, 200);">'MLabelParallel'</span><span>,</span><span style="color: rgb(255, 153, 200);">'south'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,12,</span><span style="color: rgb(255, 153, 200);">'FontColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>framem</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>tightmap</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% 122-m T change</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sp2 = subplot(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,[0.56 0.79 0.4 0.19]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>axesm(</span><span style="color: rgb(255, 153, 200);">'MapProjection'</span><span>,</span><span style="color: rgb(255, 153, 200);">'eqdcylin'</span><span>,</span><span style="color: rgb(255, 153, 200);">'MapLatLimit'</span><span>,[33 50],</span><span style="color: rgb(255, 153, 200);">'MapLonLimit'</span><span>,[-77 -48])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>hold </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%t_diff = t10002000_en4_2009_2018' - t10002000_en4_2001_2007';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>pcolorm(lat_en4,lon_en4,T122_change_reshape_20092011')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>shading </span><span style="color: rgb(255, 153, 200);">flat</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>colormap(sp2,cmocean(</span><span style="color: rgb(255, 153, 200);">'balance'</span><span>,8,</span><span style="color: rgb(255, 153, 200);">'pivot'</span><span>,0))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>caxis([-1.5 2.5])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-100 -100],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-1000 -1000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-3000 -3000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-4000 -4000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>fillm([33.1,33.1,36.2,36.2],[-65,-48.1,-48.1,-65],</span><span style="color: rgb(255, 153, 200);">'facecolor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>,</span><span style="color: rgb(255, 153, 200);">'edgecolor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>textm(45,-75,</span><span style="color: rgb(255, 153, 200);">'122 m'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,12,</span><span style="color: rgb(255, 153, 200);">'FontWeight'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Bold'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Color'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c = colorbar(</span><span style="color: rgb(255, 153, 200);">'Orientation'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Horizontal'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,[0.56 0.07 0.4 0.02],</span><span style="color: rgb(255, 153, 200);">'Color'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,10);</span><span style="color: rgb(0, 191, 191);">%colorbar over land</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>c.Label.String = </span><span style="color: rgb(255, 153, 200);">'T Change (\circC)'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(c,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,12)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(gca,</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,12)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>geoshow(</span><span style="color: rgb(255, 153, 200);">'GSHHS_i_L1.shp'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FaceColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span><span style="color: rgb(0, 191, 191);">%[.7 .7 .7])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plabel(</span><span style="color: rgb(255, 153, 200);">'PLabelLocation'</span><span>,100,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,12,</span><span style="color: rgb(255, 153, 200);">'FontColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>mlabel(</span><span style="color: rgb(255, 153, 200);">'MLabelLocation'</span><span>,100,</span><span style="color: rgb(255, 153, 200);">'MLabelParallel'</span><span>,</span><span style="color: rgb(255, 153, 200);">'south'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,12,</span><span style="color: rgb(255, 153, 200);">'FontColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>framem</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>tightmap</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% 135-m change point</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sp1 = subplot(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,[0.08 0.58 0.4 0.19]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>axesm(</span><span style="color: rgb(255, 153, 200);">'MapProjection'</span><span>,</span><span style="color: rgb(255, 153, 200);">'eqdcylin'</span><span>,</span><span style="color: rgb(255, 153, 200);">'MapLatLimit'</span><span>,[33 50],</span><span style="color: rgb(255, 153, 200);">'MapLonLimit'</span><span>,[-77 -48])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>hold </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>pcolorm(lat_en4,lon_en4,T135_change_point_reshape_20092011')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>shading </span><span style="color: rgb(255, 153, 200);">flat</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>colormap(sp1,crameri(</span><span style="color: rgb(255, 153, 200);">'nuuk'</span><span>,12))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>caxis([193 229])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-100 -100],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-1000 -1000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-3000 -3000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-4000 -4000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>fillm([33.1,33.1,36.2,36.2],[-65,-48.1,-48.1,-65],</span><span style="color: rgb(255, 153, 200);">'facecolor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>,</span><span style="color: rgb(255, 153, 200);">'edgecolor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>textm(45,-75,</span><span style="color: rgb(255, 153, 200);">'135 m'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,12,</span><span style="color: rgb(255, 153, 200);">'FontWeight'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Bold'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Color'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% c = colorbar('Orientation','Horizontal','Position',[0.08 0.07 0.4 0.02],'Color','k','Fontsize',10);%colorbar over land</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% c.Label.String = 'T_{150m} Change Point';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% set(c,'Fontsize',12,'ytick',[193;211;229],'yticklabel',[datestr(time_ssh(193),'mmmyy');datestr(time_ssh(211),'mmmyy');datestr(time_ssh(229),'mmmyy')])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(gca,</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,12)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>geoshow(</span><span style="color: rgb(255, 153, 200);">'GSHHS_i_L1.shp'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FaceColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span><span style="color: rgb(0, 191, 191);">%[.7 .7 .7])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plabel(</span><span style="color: rgb(255, 153, 200);">'PLabelLocation'</span><span>,5,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,12)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>mlabel(</span><span style="color: rgb(255, 153, 200);">'MLabelLocation'</span><span>,100,</span><span style="color: rgb(255, 153, 200);">'MLabelParallel'</span><span>,</span><span style="color: rgb(255, 153, 200);">'south'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,12,</span><span style="color: rgb(255, 153, 200);">'FontColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>framem</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>tightmap</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% 135-m T change</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sp2 = subplot(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,[0.56 0.58 0.4 0.19]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>axesm(</span><span style="color: rgb(255, 153, 200);">'MapProjection'</span><span>,</span><span style="color: rgb(255, 153, 200);">'eqdcylin'</span><span>,</span><span style="color: rgb(255, 153, 200);">'MapLatLimit'</span><span>,[33 50],</span><span style="color: rgb(255, 153, 200);">'MapLonLimit'</span><span>,[-77 -48])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>hold </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>pcolorm(lat_en4,lon_en4,T135_change_reshape_20092011')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>shading </span><span style="color: rgb(255, 153, 200);">flat</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>colormap(sp2,cmocean(</span><span style="color: rgb(255, 153, 200);">'balance'</span><span>,8,</span><span style="color: rgb(255, 153, 200);">'pivot'</span><span>,0))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>caxis([-1.5 2.5])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-100 -100],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-1000 -1000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-3000 -3000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-4000 -4000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>fillm([33.1,33.1,36.2,36.2],[-65,-48.1,-48.1,-65],</span><span style="color: rgb(255, 153, 200);">'facecolor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>,</span><span style="color: rgb(255, 153, 200);">'edgecolor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>textm(45,-75,</span><span style="color: rgb(255, 153, 200);">'135 m'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,12,</span><span style="color: rgb(255, 153, 200);">'FontWeight'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Bold'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Color'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% c = colorbar('Orientation','Horizontal','Position',[0.56 0.07 0.4 0.02],'Color','k','Fontsize',10);%colorbar over land</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% c.Label.String = 'T_{150m} Change (\circC)';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% set(c,'Fontsize',12)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(gca,</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,12)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>geoshow(</span><span style="color: rgb(255, 153, 200);">'GSHHS_i_L1.shp'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FaceColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span><span style="color: rgb(0, 191, 191);">%[.7 .7 .7])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plabel(</span><span style="color: rgb(255, 153, 200);">'PLabelLocation'</span><span>,100,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,12,</span><span style="color: rgb(255, 153, 200);">'FontColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>mlabel(</span><span style="color: rgb(255, 153, 200);">'MLabelLocation'</span><span>,100,</span><span style="color: rgb(255, 153, 200);">'MLabelParallel'</span><span>,</span><span style="color: rgb(255, 153, 200);">'south'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,12,</span><span style="color: rgb(255, 153, 200);">'FontColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>framem</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>tightmap</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% 166-m change point</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sp1 = subplot(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,[0.08 0.37 0.4 0.19]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>axesm(</span><span style="color: rgb(255, 153, 200);">'MapProjection'</span><span>,</span><span style="color: rgb(255, 153, 200);">'eqdcylin'</span><span>,</span><span style="color: rgb(255, 153, 200);">'MapLatLimit'</span><span>,[33 50],</span><span style="color: rgb(255, 153, 200);">'MapLonLimit'</span><span>,[-77 -48])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>hold </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>pcolorm(lat_en4,lon_en4,T166_change_point_reshape_20092011')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>shading </span><span style="color: rgb(255, 153, 200);">flat</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>colormap(sp1,crameri(</span><span style="color: rgb(255, 153, 200);">'nuuk'</span><span>,12))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>caxis([193 229])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-100 -100],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-1000 -1000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-3000 -3000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-4000 -4000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>fillm([33.1,33.1,36.2,36.2],[-65,-48.1,-48.1,-65],</span><span style="color: rgb(255, 153, 200);">'facecolor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>,</span><span style="color: rgb(255, 153, 200);">'edgecolor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>textm(45,-75,</span><span style="color: rgb(255, 153, 200);">'166 m'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,12,</span><span style="color: rgb(255, 153, 200);">'FontWeight'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Bold'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Color'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% c = colorbar('Orientation','Horizontal','Position',[0.08 0.07 0.4 0.02],'Color','k','Fontsize',10);%colorbar over land</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% c.Label.String = 'T_{150m} Change Point';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% set(c,'Fontsize',12,'ytick',[193;211;229],'yticklabel',[datestr(time_ssh(193),'mmmyy');datestr(time_ssh(211),'mmmyy');datestr(time_ssh(229),'mmmyy')])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(gca,</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,12)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>geoshow(</span><span style="color: rgb(255, 153, 200);">'GSHHS_i_L1.shp'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FaceColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span><span style="color: rgb(0, 191, 191);">%[.7 .7 .7])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plabel(</span><span style="color: rgb(255, 153, 200);">'PLabelLocation'</span><span>,5,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,12)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>mlabel(</span><span style="color: rgb(255, 153, 200);">'MLabelLocation'</span><span>,100,</span><span style="color: rgb(255, 153, 200);">'MLabelParallel'</span><span>,</span><span style="color: rgb(255, 153, 200);">'south'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,12,</span><span style="color: rgb(255, 153, 200);">'FontColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>framem</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>tightmap</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% 166-m T change</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sp2 = subplot(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,[0.56 0.37 0.4 0.19]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>axesm(</span><span style="color: rgb(255, 153, 200);">'MapProjection'</span><span>,</span><span style="color: rgb(255, 153, 200);">'eqdcylin'</span><span>,</span><span style="color: rgb(255, 153, 200);">'MapLatLimit'</span><span>,[33 50],</span><span style="color: rgb(255, 153, 200);">'MapLonLimit'</span><span>,[-77 -48])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>hold </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>pcolorm(lat_en4,lon_en4,T166_change_reshape_20092011')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>shading </span><span style="color: rgb(255, 153, 200);">flat</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>colormap(sp2,cmocean(</span><span style="color: rgb(255, 153, 200);">'balance'</span><span>,8,</span><span style="color: rgb(255, 153, 200);">'pivot'</span><span>,0))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>caxis([-1.5 2.5])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-100 -100],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-1000 -1000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-3000 -3000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-4000 -4000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>fillm([33.1,33.1,36.2,36.2],[-65,-48.1,-48.1,-65],</span><span style="color: rgb(255, 153, 200);">'facecolor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>,</span><span style="color: rgb(255, 153, 200);">'edgecolor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>textm(45,-75,</span><span style="color: rgb(255, 153, 200);">'166 m'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,12,</span><span style="color: rgb(255, 153, 200);">'FontWeight'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Bold'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Color'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% c = colorbar('Orientation','Horizontal','Position',[0.56 0.07 0.4 0.02],'Color','k','Fontsize',10);%colorbar over land</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% c.Label.String = 'T_{150m} Change (\circC)';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% set(c,'Fontsize',12)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(gca,</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,12)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>geoshow(</span><span style="color: rgb(255, 153, 200);">'GSHHS_i_L1.shp'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FaceColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span><span style="color: rgb(0, 191, 191);">%[.7 .7 .7])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plabel(</span><span style="color: rgb(255, 153, 200);">'PLabelLocation'</span><span>,100,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,12,</span><span style="color: rgb(255, 153, 200);">'FontColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>mlabel(</span><span style="color: rgb(255, 153, 200);">'MLabelLocation'</span><span>,100,</span><span style="color: rgb(255, 153, 200);">'MLabelParallel'</span><span>,</span><span style="color: rgb(255, 153, 200);">'south'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,12,</span><span style="color: rgb(255, 153, 200);">'FontColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>framem</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>tightmap</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(gcf, </span><span style="color: rgb(255, 153, 200);">'Color'</span><span>, </span><span style="color: rgb(255, 153, 200);">'w'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% 185-m change point</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sp1 = subplot(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,[0.08 0.16 0.4 0.19]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>axesm(</span><span style="color: rgb(255, 153, 200);">'MapProjection'</span><span>,</span><span style="color: rgb(255, 153, 200);">'eqdcylin'</span><span>,</span><span style="color: rgb(255, 153, 200);">'MapLatLimit'</span><span>,[33 50],</span><span style="color: rgb(255, 153, 200);">'MapLonLimit'</span><span>,[-77 -48])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>hold </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>pcolorm(lat_en4,lon_en4,T185_change_point_reshape_20092011')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>shading </span><span style="color: rgb(255, 153, 200);">flat</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>colormap(sp1,crameri(</span><span style="color: rgb(255, 153, 200);">'nuuk'</span><span>,12))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>caxis([193 229])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-100 -100],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-1000 -1000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-3000 -3000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-4000 -4000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>fillm([33.1,33.1,36.2,36.2],[-65,-48.1,-48.1,-65],</span><span style="color: rgb(255, 153, 200);">'facecolor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>,</span><span style="color: rgb(255, 153, 200);">'edgecolor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>textm(45,-75,</span><span style="color: rgb(255, 153, 200);">'185 m'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,12,</span><span style="color: rgb(255, 153, 200);">'FontWeight'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Bold'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Color'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% c = colorbar('Orientation','Horizontal','Position',[0.08 0.07 0.4 0.02],'Color','k','Fontsize',10);%colorbar over land</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% c.Label.String = 'T_{150m} Change Point';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% set(c,'Fontsize',12,'ytick',[193;211;229],'yticklabel',[datestr(time_ssh(193),'mmmyy');datestr(time_ssh(211),'mmmyy');datestr(time_ssh(229),'mmmyy')])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(gca,</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,12)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>geoshow(</span><span style="color: rgb(255, 153, 200);">'GSHHS_i_L1.shp'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FaceColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span><span style="color: rgb(0, 191, 191);">%[.7 .7 .7])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plabel(</span><span style="color: rgb(255, 153, 200);">'PLabelLocation'</span><span>,5,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,12)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>mlabel(</span><span style="color: rgb(255, 153, 200);">'MLabelLocation'</span><span>,10,</span><span style="color: rgb(255, 153, 200);">'MLabelParallel'</span><span>,</span><span style="color: rgb(255, 153, 200);">'south'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,12,</span><span style="color: rgb(255, 153, 200);">'FontColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>framem</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>tightmap</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% 185-m T change</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sp2 = subplot(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,[0.56 0.16 0.4 0.19]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>axesm(</span><span style="color: rgb(255, 153, 200);">'MapProjection'</span><span>,</span><span style="color: rgb(255, 153, 200);">'eqdcylin'</span><span>,</span><span style="color: rgb(255, 153, 200);">'MapLatLimit'</span><span>,[33 50],</span><span style="color: rgb(255, 153, 200);">'MapLonLimit'</span><span>,[-77 -48])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>hold </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>pcolorm(lat_en4,lon_en4,T185_change_reshape_20092011')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>shading </span><span style="color: rgb(255, 153, 200);">flat</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>colormap(sp2,cmocean(</span><span style="color: rgb(255, 153, 200);">'balance'</span><span>,8,</span><span style="color: rgb(255, 153, 200);">'pivot'</span><span>,0))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>caxis([-1.5 2.5])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-100 -100],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-1000 -1000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-3000 -3000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-4000 -4000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>fillm([33.1,33.1,36.2,36.2],[-65,-48.1,-48.1,-65],</span><span style="color: rgb(255, 153, 200);">'facecolor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>,</span><span style="color: rgb(255, 153, 200);">'edgecolor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>textm(45,-75,</span><span style="color: rgb(255, 153, 200);">'185 m'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,12,</span><span style="color: rgb(255, 153, 200);">'FontWeight'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Bold'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Color'</span><span>,</span><span style="color: rgb(255, 153, 200);">'w'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% c = colorbar('Orientation','Horizontal','Position',[0.56 0.07 0.4 0.02],'Color','k','Fontsize',10);%colorbar over land</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% c.Label.String = 'T_{150m} Change (\circC)';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% set(c,'Fontsize',12)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(gca,</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,12)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>geoshow(</span><span style="color: rgb(255, 153, 200);">'GSHHS_i_L1.shp'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FaceColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span><span style="color: rgb(0, 191, 191);">%[.7 .7 .7])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plabel(</span><span style="color: rgb(255, 153, 200);">'PLabelLocation'</span><span>,100,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,12,</span><span style="color: rgb(255, 153, 200);">'FontColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>mlabel(</span><span style="color: rgb(255, 153, 200);">'MLabelLocation'</span><span>,10,</span><span style="color: rgb(255, 153, 200);">'MLabelParallel'</span><span>,</span><span style="color: rgb(255, 153, 200);">'south'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,12,</span><span style="color: rgb(255, 153, 200);">'FontColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>framem</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>tightmap</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>saveas(gcf,[output_dir,</span><span style="color: rgb(255, 153, 200);">'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_SupplementalFigure5_pre'</span><span>],</span><span style="color: rgb(255, 153, 200);">'epsc'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clearvars </span><span style="color: rgb(255, 153, 200);">-except *_dir</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>close </span><span style="color: rgb(255, 153, 200);">all</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%% Supplementary Figure 6</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Set  directory to save data</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>data_dir = </span><span style="color: rgb(255, 153, 200);">'/Users/afonso/Documents/Research/TGB/data/'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Set directory to save figures and tables</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>output_dir = </span><span style="color: rgb(255, 153, 200);">'/Users/afonso/Documents/Research/TGB/output/'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>load([data_dir,</span><span style="color: rgb(255, 153, 200);">'EN4_profiles_TGB_AMJ_dec_postQC_T_only.mat'</span><span>])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Load ETOPO1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%ncdisp('/Users/afonso/Documents/Data/ETOPO1_Bed_g_gmt4.grd')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>x = ncread(</span><span style="color: rgb(255, 153, 200);">'/Users/afonso/Google Drive/Data/ETOPO1_Bed_g_gmt4.grd'</span><span>,</span><span style="color: rgb(255, 153, 200);">'x'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>lon_z = x(x&lt;=(320-360) &amp; x&gt;=(280-360)); </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>y = ncread(</span><span style="color: rgb(255, 153, 200);">'/Users/afonso/Google Drive/Data/ETOPO1_Bed_g_gmt4.grd'</span><span>,</span><span style="color: rgb(255, 153, 200);">'y'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>lat_z = y(y&lt;=60 &amp; y&gt;=30); </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>z_aux = ncread(</span><span style="color: rgb(255, 153, 200);">'/Users/afonso/Google Drive/Data/ETOPO1_Bed_g_gmt4.grd'</span><span>,</span><span style="color: rgb(255, 153, 200);">'z'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>z = z_aux(x&lt;=(320-360) &amp; x&gt;=(280-360),y&lt;=60 &amp; y&gt;=30); z = z';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear </span><span style="color: rgb(255, 153, 200);">x y z_aux</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Create structure with all profiles</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>decade = 1930:10:2010;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>k = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 1:9</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    disp(num2str(decade(i)))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">for </span><span>j = 1:eval([</span><span style="color: rgb(255, 153, 200);">'length(EN4_profiles_TGB_AMJ_dec.d'</span><span>,num2str(decade(i)),</span><span style="color: rgb(255, 153, 200);">'.lat)'</span><span>])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        eval([</span><span style="color: rgb(255, 153, 200);">'tail_EN4(k).Latitude = EN4_profiles_TGB_AMJ_dec.d'</span><span>,num2str(decade(i)),</span><span style="color: rgb(255, 153, 200);">'.lat(j);'</span><span>])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        eval([</span><span style="color: rgb(255, 153, 200);">'tail_EN4(k).Longitude = EN4_profiles_TGB_AMJ_dec.d'</span><span>,num2str(decade(i)),</span><span style="color: rgb(255, 153, 200);">'.lon(j);'</span><span>])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        eval([</span><span style="color: rgb(255, 153, 200);">'tail_EN4(k).Time = EN4_profiles_TGB_AMJ_dec.d'</span><span>,num2str(decade(i)),</span><span style="color: rgb(255, 153, 200);">'.time(j);'</span><span>])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        eval([</span><span style="color: rgb(255, 153, 200);">'tail_EN4(k).Pressure = EN4_profiles_TGB_AMJ_dec.d'</span><span>,num2str(decade(i)),</span><span style="color: rgb(255, 153, 200);">'.depth(:,j);'</span><span>])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        eval([</span><span style="color: rgb(255, 153, 200);">'tail_EN4(k).Temperature = EN4_profiles_TGB_AMJ_dec.d'</span><span>,num2str(decade(i)),</span><span style="color: rgb(255, 153, 200);">'.temperature(:,j);'</span><span>])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        eval([</span><span style="color: rgb(255, 153, 200);">'tail_EN4(k).Salinity = EN4_profiles_TGB_AMJ_dec.d'</span><span>,num2str(decade(i)),</span><span style="color: rgb(255, 153, 200);">'.salinity(:,j);'</span><span>])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        k = k + 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear </span><span style="color: rgb(255, 153, 200);">EN4* i j k </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Vertical levels to inpterpolate</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>p_interp = </span><span class="warning_squiggle_rte1619232262">[</span><span>350]';</span><span style="color: rgb(0, 191, 191);">%in the manuscript as of Jun 9, 2020</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Isopycnals to interpolate</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%d_interp = [26.5;27;27.25;27.5];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Define spatial and temporal boundaries and deltas</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>lat_n = 44;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>lat_s = 41;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>lat_delta = 0.5;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>lon_w = -53;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>lon_e = -48;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>lon_delta = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>lat_box = lat_s:lat_delta:lat_n;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>lon_box = lon_w:lon_delta:lon_e;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>year = 1930:10:2020;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>time_delta = 10;</span><span style="color: rgb(0, 191, 191);">%year</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Average profiles over depths determined in p_interp (only 5,153 valid</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% profiles)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>tail_EN4_1 = tail_EN4(1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>k_yes = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>k_no = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 1:length(tail_EN4)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">if </span><span>sum(isnan(tail_EN4(i).Temperature)) == length(tail_EN4(i).Temperature)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        k_no = k_no + 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">elseif </span><span>sum(isnan(tail_EN4(i).Temperature)) + 1 == length(tail_EN4(i).Temperature)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        k_no = k_no + 1;    </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">elseif </span><span>~isempty(find(diff(tail_EN4(i).Pressure)&lt;=0,1))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        k_no = k_no + 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        k_yes = k_yes + 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        tail_EN4_1(k_yes).Latitude = tail_EN4(i).Latitude;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        tail_EN4_1(k_yes).Longitude = tail_EN4(i).Longitude;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        tail_EN4_1(k_yes).Time = tail_EN4(i).Time;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        tail_EN4_1(k_yes).Pressure = p_interp;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        tail_EN4_1(k_yes).Temperature = interp1(tail_EN4(i).Pressure(~isnan(tail_EN4(i).Temperature)),tail_EN4(i).Temperature(~isnan(tail_EN4(i).Temperature)),p_interp);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        tail_EN4_1(k_yes).Salinity = interp1(tail_EN4(i).Pressure(~isnan(tail_EN4(i).Temperature)),tail_EN4(i).Salinity(~isnan(tail_EN4(i).Temperature)),p_interp);           </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%         s_abs = gsw_SA_from_SP(tail_EN4_1(k_yes).Salinity,tail_EN4_1(k_yes).Pressure,...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%             tail_EN4_1(k_yes).Latitude,tail_EN4_1(k_yes).Longitude);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%         t_cons = gsw_CT_from_t(s_abs,tail_EN4_1(k_yes).Temperature,tail_EN4_1(k_yes).Pressure);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%         tail_EN4_1(k_yes).Sigmatheta = gsw_sigma0(s_abs,t_cons);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%         if sum(isnan(tail_EN4_1(k_yes).Temperature)) == length(tail_EN4_1(k_yes).Temperature) | ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%                 sum(isnan(tail_EN4_1(k_yes).Temperature)) + 1 == length(tail_EN4_1(k_yes).Temperature)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%             tail_EN4_1(k_yes).T_dens = NaN(length(d_interp),1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%             tail_EN4_1(k_yes).S_dens = NaN(length(d_interp),1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%             tail_EN4_1(k_yes).P_dens = NaN(length(d_interp),1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%         else</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%             tail_EN4_1(k_yes).T_dens = interp1(tail_EN4_1(k_yes).Sigmatheta(~isnan(s_abs)),...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%                 tail_EN4_1(k_yes).Temperature(~isnan(s_abs)),d_interp);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%             tail_EN4_1(k_yes).S_dens = interp1(tail_EN4_1(k_yes).Sigmatheta(~isnan(s_abs)),...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%                 tail_EN4_1(k_yes).Salinity(~isnan(s_abs)),d_interp);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%             tail_EN4_1(k_yes).P_dens = interp1(tail_EN4_1(k_yes).Sigmatheta(~isnan(s_abs)),...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%                 tail_EN4_1(k_yes).Pressure(~isnan(s_abs)),d_interp);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%         end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%         clear s_abs t_cons</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Load bathymetry data needed for computing effective distance</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>indla = lat_z&gt;=40.98 &amp; lat_z&lt;=44.01;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>indlo = lon_z&gt;=-53 &amp; lon_z&lt;=-48;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>bathy = z(indla,indlo);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Define position of profiles</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>xpos = [tail_EN4_1.Longitude];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ypos = [tail_EN4_1.Latitude];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Define center of squared boxes</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 1:length(lon_box)-1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span class="warning_squiggle_rte1619232262">ggx1</span><span>(i) = mean(lon_box(i:i+1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>j = 1:length(lat_box)-1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span class="warning_squiggle_rte1619232262">ggy1</span><span>(j) = mean(lat_box(j:j+1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[ggx </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">ggy</span><span>] = meshgrid(ggx1,ggy1); </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear </span><span style="color: rgb(255, 153, 200);">i j </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Meshgrid of the bathymetry.</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[xBathy,yBathy] = meshgrid(lon_z(lon_z&gt;=-53 &amp; lon_z&lt;=-48),lat_z(lat_z&gt;=40.98 &amp; lat_z&lt;=44.01));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Vector of the bathymetry at every data point location.</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>bathyi = interp2(xBathy,yBathy,bathy,xpos,ypos);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>bathtarget = interp2(xBathy,yBathy,bathy,ggx,ggy);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Define Lamda as in Lavender et al. 2005, equation 3</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>lambda = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Loop on every data point. I try to give a grid point location to every</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% data point.  Assign grid point based on effective distance criterion from</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% equation 3, Lavender et al 2005</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 1:length(tail_EN4_1)  </span><span style="color: rgb(0, 191, 191);">%This loops on every float profile</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 191, 191);">% Compute the distance (to find nearest points) on the initial square grid </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    dist2 = (xpos(i)-ggx).^2 + (ypos(i)-ggy).^2;  </span><span style="color: rgb(0, 191, 191);">%here xpos(i), ypos(i) is the float profile position and ggx, ggy are the grid cell centers for a standard x,y grid</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 191, 191);">% Put distances in a vector and sort it.</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    dist2vec = reshape(dist2,size(dist2,1)*size(dist2,2),1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    dist2sorted = sort(dist2vec);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 191, 191);">% Find the 9 nearest grid cell centers to the individual float profile (this is a time-saving step, so you don't have to find the effective distance to every point in a big grid)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    mindists = dist2sorted(1:9);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    dist2mvec = zeros(length(mindists),1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    hdist2 = zeros(length(mindists),1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    deff2vec = zeros(length(mindists),1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    ind = zeros(length(mindists),1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 191, 191);">% Loop on these 9 nearest points.</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">for </span><span>minindex = 1:length(mindists)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(0, 191, 191);">% Find the index of the current point.</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        ind(minindex) = find(dist2 == mindists(minindex),1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(0, 191, 191);">% Find the real distance in meters. Square it.</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        dist2mvec(minindex) = gsw_distance([xpos(i) ggx(ind(minindex))],[ypos(i) ggy(ind(minindex))]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(0, 191, 191);">%dist2mvec(minindex) = distance(ypos(i),xpos(i),ggy(ind(minindex)),ggx(ind(minindex)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(0, 191, 191);">%(greatCircleDistance(pi/180*xpos(i),pi/180*ypos(i),pi/180*ggx(ind(minindex)),pi/180*gy(ind(minindex)))).^2;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(0, 191, 191);">% Find the correction using the bathymetry according to Lavender</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(0, 191, 191);">% (2005).</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(0, 191, 191);">%hdist2(minindex) = (3*lambda*(bathyi(i)-bathtarget(ind(minindex)))./(bathyi(i)+bathtarget(ind(minindex)))).^2;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        hdist2(minindex) = (3*lambda*(bathtarget(ind(minindex))-bathyi(i))./(bathyi(i)+bathtarget(ind(minindex)))).^2;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(0, 191, 191);">% Calculate the effective distance between the data point and the</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(0, 191, 191);">% grid point considered here.</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        deff2vec(minindex) = dist2mvec(minindex)+hdist2(minindex);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 191, 191);">% Find the minimum effective distance and the location in the grid.</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span class="warning_squiggle_rte1619232262">deff</span><span>(i) = sqrt(min(deff2vec));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span class="warning_squiggle_rte1619232262">indexFin</span><span>(i) = min(ind(deff2vec == min(deff2vec)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 191, 191);">% Display where we are in the loop.</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">if </span><span>rand() &lt; 0.005</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        disp(i)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[aux_un1,aux_un2,aux_un3] = unique(indexFin);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>tail_EN4_n = NaN(length(aux_un1),1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i=1:length(aux_un1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    tail_EN4_n(i) = sum(aux_un3==i);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Create new fields in structure to receive anomalies</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>tail_EN4_1(1).T_anom = [];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>tail_EN4_1(1).S_anom = [];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>tail_EN4_1(1).T_anom_norm = [];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>tail_EN4_1(1).S_anom_norm = [];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Calculate T and S anomalies of each profile</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T_mean_bin = NaN(length(p_interp),length(tail_EN4_n));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>S_mean_bin = NaN(length(p_interp),length(tail_EN4_n));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T_std_bin = NaN(length(p_interp),length(tail_EN4_n));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>S_std_bin = NaN(length(p_interp),length(tail_EN4_n));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 1:length(aux_un3)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    aux5(i,1) = length(tail_EN4_1(i).Temperature);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>find(aux5 ~=1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 1:length(tail_EN4_n)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    bin_pos = find(aux_un3==i);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    T_mean_bin(:,i) = nanmean(reshape([tail_EN4_1(aux_un3==i).Temperature],</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        length(p_interp),length(find(aux_un3==i))),2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    S_mean_bin(:,i) = nanmean(reshape([tail_EN4_1(aux_un3==i).Salinity],</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        length(p_interp),length(find(aux_un3==i))),2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    T_std_bin(:,i) = nanstd(reshape([tail_EN4_1(aux_un3==i).Temperature],</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        length(p_interp),length(find(aux_un3==i))),0,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    S_std_bin(:,i) = nanstd(reshape([tail_EN4_1(aux_un3==i).Salinity],</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        length(p_interp),length(find(aux_un3==i))),0,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">for </span><span>k = 1:tail_EN4_n(i)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        tail_EN4_1(bin_pos(k)).T_anom = tail_EN4_1(bin_pos(k)).Temperature</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            - T_mean_bin(:,i);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        tail_EN4_1(bin_pos(k)).S_anom = tail_EN4_1(bin_pos(k)).Salinity</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            - S_mean_bin(:,i);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        tail_EN4_1(bin_pos(k)).T_anom_norm = (tail_EN4_1(bin_pos(k)).Temperature</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            - T_mean_bin(:,i))./T_std_bin(:,i);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        tail_EN4_1(bin_pos(k)).S_anom_norm = (tail_EN4_1(bin_pos(k)).Salinity</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            - S_mean_bin(:,i))./S_std_bin(:,i);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    clear </span><span style="color: rgb(255, 153, 200);">bin_pos k</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ydelta = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>year_delta = 1930:ydelta:2020;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Spatially average anomaly profiles for each 3-yr period</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T_anom = NaN(length(p_interp),length(year_delta)-1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T_std = NaN(length(p_interp),length(year_delta)-1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T_anom_norm = NaN(length(p_interp),length(year_delta)-1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>S_anom = NaN(length(p_interp),length(year_delta)-1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>S_std = NaN(length(p_interp),length(year_delta)-1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>S_anom_norm = NaN(length(p_interp),length(year_delta)-1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T_n = NaN(length(p_interp),length(year_delta)-1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>S_n = NaN(length(p_interp),length(year_delta)-1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T_ste = NaN(length(p_interp),length(year_delta)-1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>S_ste = NaN(length(p_interp),length(year_delta)-1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>t = 1:length(year_delta)-1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">if </span><span>~isempty([tail_EN4_1([tail_EN4_1.Time] &gt;= </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta(t)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            &amp; [tail_EN4_1.Time] &lt; </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta(t+1)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)).T_anom])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        T_anom(:,t) = nanmean([tail_EN4_1([tail_EN4_1.Time] &gt;= </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta(t)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            &amp; [tail_EN4_1.Time] &lt; </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta(t+1)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)).T_anom],2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        T_std(:,t) = nanstd([tail_EN4_1([tail_EN4_1.Time] &gt;= </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta(t)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            &amp; [tail_EN4_1.Time] &lt; </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta(t+1)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)).T_anom],0,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        T_anom_norm(:,t) = nanmean([tail_EN4_1([tail_EN4_1.Time] &gt;= </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta(t)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            &amp; [tail_EN4_1.Time] &lt; </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta(t+1)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)).T_anom_norm],2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        T_n(:,t) = sum(~isnan([tail_EN4_1([tail_EN4_1.Time] &gt;= </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta(t)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            &amp; [tail_EN4_1.Time] &lt; </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta(t+1)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)).T_anom]),2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        T_ste(:,t) = T_std(:,t)./sqrt(T_n(:,t));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        T_n(:,t) = zeros(length(p_interp),1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">if </span><span>~isempty([tail_EN4_1([tail_EN4_1.Time] &gt;= </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta(t)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            &amp; [tail_EN4_1.Time] &lt; </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta(t+1)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)).S_anom])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        S_anom(:,t) = nanmean([tail_EN4_1([tail_EN4_1.Time] &gt;= </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta(t)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            &amp; [tail_EN4_1.Time] &lt; </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta(t+1)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)).S_anom],2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        S_std(:,t) = nanstd([tail_EN4_1([tail_EN4_1.Time] &gt;= </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta(t)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            &amp; [tail_EN4_1.Time] &lt; </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta(t+1)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)).S_anom],0,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        S_anom_norm(:,t) = nanmean([tail_EN4_1([tail_EN4_1.Time] &gt;= </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta(t)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            &amp; [tail_EN4_1.Time] &lt; </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta(t+1)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)).S_anom_norm],2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        S_n(:,t) = sum(~isnan([tail_EN4_1([tail_EN4_1.Time] &gt;= </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta(t)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            &amp; [tail_EN4_1.Time] &lt; </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta(t+1)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)).S_anom]),2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        S_ste(:,t) = S_std(:,t)./sqrt(S_n(:,t));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        S_n(:,t) = zeros(length(p_interp),1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ydelta = 3;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>year_delta3 = 1930:ydelta:2020;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Spatially average anomaly profiles for each 3-yr period</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T_anom3 = NaN(length(p_interp),length(year_delta3)-1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T_std3 = NaN(length(p_interp),length(year_delta3)-1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T_anom_norm3 = NaN(length(p_interp),length(year_delta3)-1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>S_anom3 = NaN(length(p_interp),length(year_delta3)-1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>S_std3 = NaN(length(p_interp),length(year_delta3)-1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>S_anom_norm3 = NaN(length(p_interp),length(year_delta3)-1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T_n3 = NaN(length(p_interp),length(year_delta3)-1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>S_n3 = NaN(length(p_interp),length(year_delta3)-1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T_ste3 = NaN(length(p_interp),length(year_delta3)-1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>S_ste3 = NaN(length(p_interp),length(year_delta3)-1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>t = 1:length(year_delta3)-1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">if </span><span>~isempty([tail_EN4_1([tail_EN4_1.Time] &gt;= </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta3(t)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            &amp; [tail_EN4_1.Time] &lt; </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta3(t+1)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)).T_anom])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        T_anom3(:,t) = nanmean([tail_EN4_1([tail_EN4_1.Time] &gt;= </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta3(t)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            &amp; [tail_EN4_1.Time] &lt; </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta3(t+1)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)).T_anom],2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        T_std3(:,t) = nanstd([tail_EN4_1([tail_EN4_1.Time] &gt;= </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta3(t)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            &amp; [tail_EN4_1.Time] &lt; </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta3(t+1)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)).T_anom],0,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        T_anom_norm3(:,t) = nanmean([tail_EN4_1([tail_EN4_1.Time] &gt;= </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta3(t)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            &amp; [tail_EN4_1.Time] &lt; </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta3(t+1)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)).T_anom_norm],2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        T_n3(:,t) = sum(~isnan([tail_EN4_1([tail_EN4_1.Time] &gt;= </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta3(t)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            &amp; [tail_EN4_1.Time] &lt; </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta3(t+1)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)).T_anom]),2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        T_ste3(:,t) = T_std3(:,t)./sqrt(T_n3(:,t));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        T_n3(:,t) = zeros(length(p_interp),1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">if </span><span>~isempty([tail_EN4_1([tail_EN4_1.Time] &gt;= </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta3(t)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            &amp; [tail_EN4_1.Time] &lt; </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta3(t+1)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)).S_anom])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        S_anom3(:,t) = nanmean([tail_EN4_1([tail_EN4_1.Time] &gt;= </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta3(t)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            &amp; [tail_EN4_1.Time] &lt; </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta3(t+1)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)).S_anom],2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        S_std3(:,t) = nanstd([tail_EN4_1([tail_EN4_1.Time] &gt;= </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta3(t)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            &amp; [tail_EN4_1.Time] &lt; </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta3(t+1)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)).S_anom],0,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        S_anom_norm3(:,t) = nanmean([tail_EN4_1([tail_EN4_1.Time] &gt;= </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta3(t)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            &amp; [tail_EN4_1.Time] &lt; </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta3(t+1)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)).S_anom_norm],2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        S_n3(:,t) = sum(~isnan([tail_EN4_1([tail_EN4_1.Time] &gt;= </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta3(t)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            &amp; [tail_EN4_1.Time] &lt; </span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            datenum([num2str(year_delta3(t+1)),</span><span style="color: rgb(255, 153, 200);">'0101'</span><span>],</span><span style="color: rgb(255, 153, 200);">'yyyymmdd'</span><span>)).S_anom]),2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        S_ste3(:,t) = S_std3(:,t)./sqrt(S_n3(:,t));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        S_n3(:,t) = zeros(length(p_interp),1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Plot 3-yr temperature, anomalies, normalized (350 m)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%T_dens_anom = filtfilt(ones(5,1)/5,1,T_dens_anom);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T_anom_norm1 = T_anom_norm;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T_anom_norm1(T_anom_norm &gt; 1) = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T_anom_norm1(T_anom_norm &lt; -1) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>figure(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>, [100, 200, 750, 250])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span class="warning_squiggle_rte1619232262">sp2</span><span> = subplot(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,[0.08 0.16 0.88 0.74]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>hold </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% scatter([tail_EN4_1.Time],[tail_EN4_1.T_dens_anom],'filled',...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%     'MarkerEdgeColor',rgb('DarkSlateGray'),'MarkerFaceColor',rgb('DarkSlateGray'),...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%     'MarkerEdgeAlpha',0.25,'MarkerFaceAlpha',0.25)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>scatter(datenum(num2str(year_delta(1:end-1)'),</span><span style="color: rgb(255, 153, 200);">'yyyy'</span><span>),T_anom_norm,</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    30,rgb(</span><span style="color: rgb(255, 153, 200);">'gray'</span><span>),</span><span style="color: rgb(255, 153, 200);">'filled'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%plot(datenum(num2str(year_delta(1:end-1)'),'yyyy'),T_anom_norm,'k','LineWidth',1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>fill([datenum(num2str(year_delta3(1:4)'),</span><span style="color: rgb(255, 153, 200);">'yyyy'</span><span>);flipud(datenum(num2str(year_delta3(1:4)'),</span><span style="color: rgb(255, 153, 200);">'yyyy'</span><span>))],</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    [T_anom_norm3(1:4)'-T_ste3(1:4)';flipud(T_anom_norm3(1:4)'+T_ste3(1:4)')],</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    rgb(</span><span style="color: rgb(255, 153, 200);">'FireBrick'</span><span>),</span><span style="color: rgb(255, 153, 200);">'EdgeColor'</span><span>,rgb(</span><span style="color: rgb(255, 153, 200);">'FireBrick'</span><span>),</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(255, 153, 200);">'FaceAlpha'</span><span>,0.4,</span><span style="color: rgb(255, 153, 200);">'EdgeAlpha'</span><span>,0.05)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>fill([datenum(num2str(year_delta3(7:end-1)'),</span><span style="color: rgb(255, 153, 200);">'yyyy'</span><span>);flipud(datenum(num2str(year_delta3(7:end-1)'),</span><span style="color: rgb(255, 153, 200);">'yyyy'</span><span>))],</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    [T_anom_norm3(7:end)'-T_ste3(7:end)';flipud(T_anom_norm3(7:end)'+T_ste3(7:end)')],</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    rgb(</span><span style="color: rgb(255, 153, 200);">'FireBrick'</span><span>),</span><span style="color: rgb(255, 153, 200);">'EdgeColor'</span><span>,rgb(</span><span style="color: rgb(255, 153, 200);">'FireBrick'</span><span>),</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(255, 153, 200);">'FaceAlpha'</span><span>,0.4,</span><span style="color: rgb(255, 153, 200);">'EdgeAlpha'</span><span>,0.05)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plot(datenum(num2str(year_delta3(1:end-1)'),</span><span style="color: rgb(255, 153, 200);">'yyyy'</span><span>),T_anom_norm3,</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,rgb(</span><span style="color: rgb(255, 153, 200);">'DarkRed'</span><span>),</span><span style="color: rgb(255, 153, 200);">'LineWidth'</span><span>,2.5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%eb = errorbar(datenum(num2str(year_delta(1:end-1)'),'yyyy'),T_anom_norm(p_interp==350,:),T_ste(p_interp==350,:));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%eb.Marker = '.';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%eb.MarkerSize = 12;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%eb.Color = 'k';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>grid </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ylabel(</span><span style="color: rgb(255, 153, 200);">'Temperature Std. Dev.'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>xlabel(</span><span style="color: rgb(255, 153, 200);">'Time (yr)'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ylim([-1.3 1.3])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>xlim([datenum(num2str(year_delta(1)),</span><span style="color: rgb(255, 153, 200);">'yyyy'</span><span>) datenum(num2str(year_delta(end)),</span><span style="color: rgb(255, 153, 200);">'yyyy'</span><span>)])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>datetick(</span><span style="color: rgb(255, 153, 200);">'x'</span><span>,</span><span style="color: rgb(255, 153, 200);">'yyyy'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(gca,</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,14)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%title('Normalized 3-yr T anomalies at 350 m at the TGB')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>saveas(gcf,[output_dir,</span><span style="color: rgb(255, 153, 200);">'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_SupplementalFigure6_pre'</span><span>],</span><span style="color: rgb(255, 153, 200);">'epsc'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T_anom_norm33 = NaN(size(T_anom_norm));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T_anom_norm33(5:12) = filtfilt(ones(3,1)/3,1,T_anom_norm(5:12));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T_anom_norm33(19:end) = filtfilt(ones(3,1)/3,1,T_anom_norm(19:end));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T_ste33 = NaN(size(T_ste));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T_ste33(5:12) = filtfilt(ones(3,1)/3,1,T_ste(5:12));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T_ste33(19:end) = filtfilt(ones(3,1)/3,1,T_ste(19:end));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>figure(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>, [100, 200, 750, 250])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>sp2 = subplot(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,[0.08 0.16 0.88 0.74]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>hold </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% scatter([tail_EN4_1.Time],[tail_EN4_1.T_dens_anom],'filled',...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%     'MarkerEdgeColor',rgb('DarkSlateGray'),'MarkerFaceColor',rgb('DarkSlateGray'),...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%     'MarkerEdgeAlpha',0.25,'MarkerFaceAlpha',0.25)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>scatter(datenum(num2str(year_delta(1:end-1)'),</span><span style="color: rgb(255, 153, 200);">'yyyy'</span><span>),T_anom_norm,</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    30,rgb(</span><span style="color: rgb(255, 153, 200);">'gray'</span><span>),</span><span style="color: rgb(255, 153, 200);">'filled'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%plot(datenum(num2str(year_delta(1:end-1)'),'yyyy'),T_anom_norm,'k','LineWidth',1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>fill([datenum(num2str(year_delta(5:11)'),</span><span style="color: rgb(255, 153, 200);">'yyyy'</span><span>);flipud(datenum(num2str(year_delta(5:11)'),</span><span style="color: rgb(255, 153, 200);">'yyyy'</span><span>))],</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    [T_anom_norm33(5:11)'-T_ste33(5:11)';flipud(T_anom_norm33(5:11)'+T_ste33(5:11)')],</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    rgb(</span><span style="color: rgb(255, 153, 200);">'FireBrick'</span><span>),</span><span style="color: rgb(255, 153, 200);">'EdgeColor'</span><span>,rgb(</span><span style="color: rgb(255, 153, 200);">'FireBrick'</span><span>),</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(255, 153, 200);">'FaceAlpha'</span><span>,0.4,</span><span style="color: rgb(255, 153, 200);">'EdgeAlpha'</span><span>,0.05)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>fill([datenum(num2str(year_delta(20:end-2)'),</span><span style="color: rgb(255, 153, 200);">'yyyy'</span><span>);flipud(datenum(num2str(year_delta(20:end-2)'),</span><span style="color: rgb(255, 153, 200);">'yyyy'</span><span>))],</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    [T_anom_norm33(20:end-1)'-T_ste33(20:end-1)';flipud(T_anom_norm33(20:end-1)'+T_ste33(20:end-1)')],</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    rgb(</span><span style="color: rgb(255, 153, 200);">'FireBrick'</span><span>),</span><span style="color: rgb(255, 153, 200);">'EdgeColor'</span><span>,rgb(</span><span style="color: rgb(255, 153, 200);">'FireBrick'</span><span>),</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(255, 153, 200);">'FaceAlpha'</span><span>,0.4,</span><span style="color: rgb(255, 153, 200);">'EdgeAlpha'</span><span>,0.05)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plot(datenum(num2str(year_delta(5:11)'),</span><span style="color: rgb(255, 153, 200);">'yyyy'</span><span>),T_anom_norm33(5:11),</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,rgb(</span><span style="color: rgb(255, 153, 200);">'DarkRed'</span><span>),</span><span style="color: rgb(255, 153, 200);">'LineWidth'</span><span>,2.5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plot(datenum(num2str(year_delta(20:end-2)'),</span><span style="color: rgb(255, 153, 200);">'yyyy'</span><span>),T_anom_norm33(20:end-1),</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,rgb(</span><span style="color: rgb(255, 153, 200);">'DarkRed'</span><span>),</span><span style="color: rgb(255, 153, 200);">'LineWidth'</span><span>,2.5)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%eb = errorbar(datenum(num2str(year_delta(1:end-1)'),'yyyy'),T_anom_norm(p_interp==350,:),T_ste(p_interp==350,:));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%eb.Marker = '.';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%eb.MarkerSize = 12;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%eb.Color = 'k';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>grid </span><span style="color: rgb(255, 153, 200);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ylabel(</span><span style="color: rgb(255, 153, 200);">'Temperature Std. Dev.'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>xlabel(</span><span style="color: rgb(255, 153, 200);">'Time (yr)'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ylim([-1.3 1.3])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>xlim([datenum(num2str(year_delta(1)),</span><span style="color: rgb(255, 153, 200);">'yyyy'</span><span>) datenum(num2str(year_delta(end)),</span><span style="color: rgb(255, 153, 200);">'yyyy'</span><span>)])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>datetick(</span><span style="color: rgb(255, 153, 200);">'x'</span><span>,</span><span style="color: rgb(255, 153, 200);">'yyyy'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>set(gca,</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,14)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%title('Normalized 3-yr T anomalies at 350 m at the TGB')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>saveas(gcf,[output_dir,</span><span style="color: rgb(255, 153, 200);">'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_SupplementalFigure6_pre2'</span><span>],</span><span style="color: rgb(255, 153, 200);">'epsc'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%% Supplemental Figure 7</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Set  directory to save data</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>data_dir = </span><span style="color: rgb(255, 153, 200);">'/Users/afonso/Documents/Research/TGB/data/'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Set directory to save figures and tables</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>output_dir = </span><span style="color: rgb(255, 153, 200);">'/Users/afonso/Documents/Research/TGB/output/'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>load([data_dir,</span><span style="color: rgb(255, 153, 200);">'EN4_profiles_NWAsmall_postQC.mat'</span><span>],</span><span style="color: rgb(255, 153, 200);">'EN4_profiles_NWAsmall_n'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>load([output_dir,</span><span style="color: rgb(255, 153, 200);">'etopo1_TGB.mat'</span><span>],</span><span style="color: rgb(255, 153, 200);">'lat_z'</span><span>,</span><span style="color: rgb(255, 153, 200);">'lon_z'</span><span>,</span><span style="color: rgb(255, 153, 200);">'z'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>decade = 1900:10:2010;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>lat = 30:60;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>lon = -80:-40;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% get number of profiles at each bin per decade</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>aux = zeros(30,40,12);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>t = 1:12</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    aux(:,:,t) = nansum(EN4_profiles_NWAsmall_n(:,:,t*120-119:t*120),3);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear </span><span style="color: rgb(255, 153, 200);">t</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% get profiles used in Fig 3, 4 and Table 1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T = readtable(</span><span style="color: rgb(255, 153, 200);">'Z149mat22.csv'</span><span>, </span><span style="color: rgb(255, 153, 200);">'HeaderLines'</span><span>,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T1 = table2array(T);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T1(T1==0) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T149_change_point = NaN(1,1271);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T149_change = NaN(1,1271);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>j = 1:1271</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">if </span><span>sum(~isnan(T1(:,j))) &gt;= 1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        T149_change_point(1,j) = find(~isnan(T1(:,j)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        T149_change(1,j) = T1(T149_change_point(1,j),j);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T149_change_reshape = reshape(T149_change,41,31);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T149_change_point_reshape = reshape(T149_change_point,41,31);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T149_change_reshape_20092011 = T149_change_reshape;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>T149_change_reshape_20092011(T149_change_point_reshape&lt;193 | T149_change_point_reshape&gt;228) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>EN4_profiles_NWAsmall_n2 = nansum(EN4_profiles_NWAsmall_n,3)';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>EN4_profiles_NWAsmall_n2(isnan(T149_change_reshape_20092011(1:end-1,1:end-1))) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>nansum(nansum(nansum(EN4_profiles_NWAsmall_n)));</span><span style="color: rgb(0, 191, 191);">%  1,310,811 profiles in the small box</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>nansum(nansum(EN4_profiles_NWAsmall_n2));</span><span style="color: rgb(0, 191, 191);">%  741,373 profiles on the shelf</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>100*nansum(nansum(EN4_profiles_NWAsmall_n2))/nansum(nansum(nansum(EN4_profiles_NWAsmall_n)))</span><span style="color: rgb(0, 191, 191);">%57% on the shelf</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% positions in Fig</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>pos_9panel = [0.08,0.72,0.27,0.24;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    0.39,0.72,0.27,0.24;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    0.70,0.72,0.27,0.24;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    0.08,0.44,0.27,0.24;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    0.39,0.44,0.27,0.24;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    0.70,0.44,0.27,0.24;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    0.08,0.16,0.27,0.24;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    0.39,0.16,0.27,0.24;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    0.70,0.16,0.27,0.24];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>colormap_nonlinear = [254/256,217/256,118/256;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    161/256,217/256,155/256;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    65/256,171/256,93/256;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    0/256,109/256,44/256;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    0/256,68/256,27/256;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    188/256,189/256,220/256;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    128/256,125/256,186/256;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    84/256,39/256,143/256;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    63/256,0/256,125/256;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    252/256,146/256,114/256;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    239/256,59/256,44/256;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    165/256,15/256,21/256;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    103/256,0/256,13/256];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>colormap_nonlinear2 = [255/256,255/256,217/256;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    199/256,233/256,192/256;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    161/256,217/256,155/256;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    116/256,196/256,118/256;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    65/256,171/256,93/256;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    198/256,219/256,239/256;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    158/256,202/256,225/256;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    107/256,174/256,214/256;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    66/256,146/256,198/256;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    150/256,150/256,150/256;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    115/256,115/256,115/256;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    82/256,82/256,82/256;</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    37/256,37/256,37/256];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Wave colormap 1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>colormap_aux = readtable(</span><span style="color: rgb(255, 153, 200);">'convertcsv.csv'</span><span>, </span><span style="color: rgb(255, 153, 200);">'HeaderLines'</span><span>,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>colormap_wave = table2array(colormap_aux(:,1:5));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear </span><span style="color: rgb(255, 153, 200);">colormap_aux</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>colormap_wave_trim = colormap_wave([9:14,31:54,59:82,83:106],3:5);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% Wave colormap 2</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>colormap_aux = readtable(</span><span style="color: rgb(255, 153, 200);">'4Wmed8.csv'</span><span>, </span><span style="color: rgb(255, 153, 200);">'HeaderLines'</span><span>,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>colormap_wave2 = table2array(colormap_aux(:,1:5));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear </span><span style="color: rgb(255, 153, 200);">colormap_aux</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>colormap_wave2_trim = colormap_wave2([20:34,67:126,129:188,189:248],3:5);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% transform to nonlinear scale (13 color)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>L = [1,10,25,50,75,100,250,500,750,1000,2500,5000,10^4,10^5];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>aux1 = zeros(size(aux));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 1:length(L)-1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    aux1(aux&gt;=L(i) &amp; aux&lt;L(i+1)) = i;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>aux1(aux1 ==0) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% transform to nonlinear scale (wave colormap 1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span class="warning_squiggle_rte1619232262">L</span><span> = [1,10,25,50,75,100,250,500,750,1000,2500,5000,10^4,10^5];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>L_wave1 = [1:9/6:10,10+90/24:90/24:100,100+900/24:900/24:1000,1000+4000/12:4000/12:5000,5000+5000/6:5000/6:10000,10000+90000/6:90000/6:100000];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>aux1_wave1 = zeros(size(aux));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 1:length(L_wave1)-1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    aux1_wave1(aux&gt;=L_wave1(i) &amp; aux&lt;L_wave1(i+1)) = i;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>aux1_wave1(aux1_wave1 == 0) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% transform to nonlinear scale (wave colormap 2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>L = [1,10,25,50,75,100,250,500,750,1000,2500,5000,10^4,10^5];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>L_wave2 = [1:9/15:10,10+90/60:90/60:100,100+900/60:900/60:1000,1000+4000/30:4000/30:5000,5000+5000/15:5000/15:10000,10000+90000/15:90000/15:100000];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>aux1_wave2 = zeros(size(aux));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>i = 1:length(L_wave2)-1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    aux1_wave2(aux&gt;=L_wave2(i) &amp; aux&lt;L_wave2(i+1)) = i;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>aux1_wave2(aux1_wave2 == 0) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%py cm_xml_to_matplotlib.py -m -f /Users/afonso/Documents/MATLAB/fourwave-bgyGr.xml</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% number of profiles by 1 degree x 1 degree bin (nonlinear colomarp)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>figure(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>, [100, 200, 900, 700])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%subplot('Position',[0.06 0.15 0.88 0.78])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>t = 4:12</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 191, 191);">%count_profiles = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    subplot(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,pos_9panel(t-3,:))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    axesm(</span><span style="color: rgb(255, 153, 200);">'MapProjection'</span><span>,</span><span style="color: rgb(255, 153, 200);">'eqdcylin'</span><span>,</span><span style="color: rgb(255, 153, 200);">'MapLatLimit'</span><span>,[33 50],</span><span style="color: rgb(255, 153, 200);">'MapLonLimit'</span><span>,[-77 -48])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    hold </span><span style="color: rgb(255, 153, 200);">on</span><span>    </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    pcolorm(lat(1:end-1)+0.5,lon(1:end-1)+0.5,aux1(:,:,t))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    shading </span><span style="color: rgb(255, 153, 200);">flat</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    caxis([1,14])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 191, 191);">%set(gca,'ColorScale','log')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 191, 191);">%colormap(crameri('-hawaii',13))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 191, 191);">%colormap(cmocean('speed',13))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    colormap(colormap_nonlinear2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 191, 191);">%colormap(colormap_wave_trim)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">if </span><span>t == 4</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        c = colorbar(</span><span style="color: rgb(255, 153, 200);">'Orientation'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Horizontal'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,[0.12 0.07 0.8 0.02],</span><span style="color: rgb(255, 153, 200);">'Color'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,14);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        set(c,</span><span style="color: rgb(255, 153, 200);">'ytick'</span><span>,1:14,</span><span style="color: rgb(255, 153, 200);">'yticklabel'</span><span>,string(L))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        c.Label.String = </span><span style="color: rgb(255, 153, 200);">'Number of profiles'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        [-100 -100],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        [-1000 -1000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        [-3000 -3000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        [-4000 -4000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    set(gca,</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,14)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    title([num2str(decade(t)),</span><span style="color: rgb(255, 153, 200);">'s: '</span><span>,num2str(nansum(nansum(nansum(EN4_profiles_NWAsmall_n(:,:,t*120-119:t*120))))),</span><span style="color: rgb(255, 153, 200);">' profiles'</span><span>])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    geoshow(</span><span style="color: rgb(255, 153, 200);">'GSHHS_l_L1.shp'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FaceColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">if </span><span>t == 4 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">|</span><span> t == 7 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">|</span><span> t == 10</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    plabel(</span><span style="color: rgb(255, 153, 200);">'PLabelLocation'</span><span>,5,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,16)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        plabel(</span><span style="color: rgb(255, 153, 200);">'off'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">if </span><span>t == 10 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">|</span><span> t == 11 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">|</span><span> t == 12</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        mlabel(</span><span style="color: rgb(255, 153, 200);">'MLabelLocation'</span><span>,10,</span><span style="color: rgb(255, 153, 200);">'MLabelParallel'</span><span>,</span><span style="color: rgb(255, 153, 200);">'south'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,16)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        mlabel(</span><span style="color: rgb(255, 153, 200);">'off'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    framem</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    tightmap</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    set(gcf, </span><span style="color: rgb(255, 153, 200);">'Color'</span><span>, </span><span style="color: rgb(255, 153, 200);">'w'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>saveas(gcf,[output_dir,</span><span style="color: rgb(255, 153, 200);">'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_SupplementalFigure7_pre_option3'</span><span>],</span><span style="color: rgb(255, 153, 200);">'epsc'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% number of profiles by 1 degree x 1 degree bin (wave colomarp 1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>figure(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>, [100, 200, 900, 700])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%subplot('Position',[0.06 0.15 0.88 0.78])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>t = 4:12</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 191, 191);">%count_profiles = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    subplot(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,pos_9panel(t-3,:))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    axesm(</span><span style="color: rgb(255, 153, 200);">'MapProjection'</span><span>,</span><span style="color: rgb(255, 153, 200);">'eqdcylin'</span><span>,</span><span style="color: rgb(255, 153, 200);">'MapLatLimit'</span><span>,[33 50],</span><span style="color: rgb(255, 153, 200);">'MapLonLimit'</span><span>,[-77 -48])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    hold </span><span style="color: rgb(255, 153, 200);">on</span><span>    </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    pcolorm(lat(1:end-1)+0.5,lon(1:end-1)+0.5,aux1_wave1(:,:,t))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    shading </span><span style="color: rgb(255, 153, 200);">flat</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    caxis([1,79])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 191, 191);">%set(gca,'ColorScale','log')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 191, 191);">%colormap(crameri('-hawaii',13))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 191, 191);">%colormap(cmocean('speed',13))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 191, 191);">%colormap(colormap_nonlinear2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    colormap(colormap_wave_trim)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">if </span><span>t == 4</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        c = colorbar(</span><span style="color: rgb(255, 153, 200);">'Orientation'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Horizontal'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,[0.12 0.07 0.8 0.02],</span><span style="color: rgb(255, 153, 200);">'Color'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,14);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        set(c,</span><span style="color: rgb(255, 153, 200);">'ytick'</span><span>,[1,7,11,16.667,24.333,31,35,41.667,48.333,55,59.5,67,73,79],</span><span style="color: rgb(255, 153, 200);">'yticklabel'</span><span>,string(L))</span><span style="color: rgb(0, 191, 191);">%string(L_wave1([1,7,11,19,27,31,35,43,51,55,61,67,73,79])))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        c.Label.String = </span><span style="color: rgb(255, 153, 200);">'Number of profiles'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        [-100 -100],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        [-1000 -1000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        [-3000 -3000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        [-4000 -4000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    set(gca,</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,14)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    title([num2str(decade(t)),</span><span style="color: rgb(255, 153, 200);">'s: '</span><span>,num2str(nansum(nansum(nansum(EN4_profiles_NWAsmall_n(:,:,t*120-119:t*120))))),</span><span style="color: rgb(255, 153, 200);">' profiles'</span><span>])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    geoshow(</span><span style="color: rgb(255, 153, 200);">'GSHHS_l_L1.shp'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FaceColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">if </span><span>t == 4 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">|</span><span> t == 7 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">|</span><span> t == 10</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    plabel(</span><span style="color: rgb(255, 153, 200);">'PLabelLocation'</span><span>,5,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,16)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        plabel(</span><span style="color: rgb(255, 153, 200);">'off'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">if </span><span>t == 10 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">|</span><span> t == 11 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">|</span><span> t == 12</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        mlabel(</span><span style="color: rgb(255, 153, 200);">'MLabelLocation'</span><span>,10,</span><span style="color: rgb(255, 153, 200);">'MLabelParallel'</span><span>,</span><span style="color: rgb(255, 153, 200);">'south'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,16)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        mlabel(</span><span style="color: rgb(255, 153, 200);">'off'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    framem</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    tightmap</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    set(gcf, </span><span style="color: rgb(255, 153, 200);">'Color'</span><span>, </span><span style="color: rgb(255, 153, 200);">'w'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>saveas(gcf,[output_dir,</span><span style="color: rgb(255, 153, 200);">'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_SupplementalFigure7_pre_option1'</span><span>],</span><span style="color: rgb(255, 153, 200);">'epsc'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">% number of profiles by 1 degree x 1 degree bin (wave colomarp 2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>figure(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>, [100, 200, 900, 700])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 191, 191);">%subplot('Position',[0.06 0.15 0.88 0.78])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">for </span><span>t = 4:12</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 191, 191);">%count_profiles = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    subplot(</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,pos_9panel(t-3,:))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    axesm(</span><span style="color: rgb(255, 153, 200);">'MapProjection'</span><span>,</span><span style="color: rgb(255, 153, 200);">'eqdcylin'</span><span>,</span><span style="color: rgb(255, 153, 200);">'MapLatLimit'</span><span>,[33 50],</span><span style="color: rgb(255, 153, 200);">'MapLonLimit'</span><span>,[-77 -48])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    hold </span><span style="color: rgb(255, 153, 200);">on</span><span>    </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    pcolorm(lat(1:end-1)+0.5,lon(1:end-1)+0.5,aux1_wave2(:,:,t))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    shading </span><span style="color: rgb(255, 153, 200);">flat</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    caxis([1,196])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 191, 191);">%set(gca,'ColorScale','log')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 191, 191);">%colormap(crameri('-hawaii',13))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 191, 191);">%colormap(cmocean('speed',13))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 191, 191);">%colormap(colormap_nonlinear2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    colormap(colormap_wave2_trim)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">if </span><span>t == 4</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        c = colorbar(</span><span style="color: rgb(255, 153, 200);">'Orientation'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Horizontal'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Position'</span><span>,[0.12 0.07 0.8 0.02],</span><span style="color: rgb(255, 153, 200);">'Color'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,14);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        set(c,</span><span style="color: rgb(255, 153, 200);">'ytick'</span><span>,[1,16,26,42.667,59.333,76,86,102.667,119.333,136,147.25,166,181,196],</span><span style="color: rgb(255, 153, 200);">'yticklabel'</span><span>,string(L))</span><span style="color: rgb(0, 191, 191);">%string(L_wave2([1,16,26,46,66,76,86,106,126,136,151,166,181,196])))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        c.Label.String = </span><span style="color: rgb(255, 153, 200);">'Number of profiles'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        [-100 -100],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        [-1000 -1000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        [-3000 -3000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),</span><span style="color: rgb(237, 177, 32);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        [-4000 -4000],</span><span style="color: rgb(255, 153, 200);">'color'</span><span>,[.7 .7 .7],</span><span style="color: rgb(255, 153, 200);">'linewidth'</span><span>,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    set(gca,</span><span style="color: rgb(255, 153, 200);">'FontSize'</span><span>,14)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    title([num2str(decade(t)),</span><span style="color: rgb(255, 153, 200);">'s: '</span><span>,num2str(nansum(nansum(nansum(EN4_profiles_NWAsmall_n(:,:,t*120-119:t*120))))),</span><span style="color: rgb(255, 153, 200);">' profiles'</span><span>])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    geoshow(</span><span style="color: rgb(255, 153, 200);">'GSHHS_l_L1.shp'</span><span>,</span><span style="color: rgb(255, 153, 200);">'FaceColor'</span><span>,</span><span style="color: rgb(255, 153, 200);">'k'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">if </span><span>t == 4 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">|</span><span> t == 7 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">|</span><span> t == 10</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    plabel(</span><span style="color: rgb(255, 153, 200);">'PLabelLocation'</span><span>,5,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,16)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        plabel(</span><span style="color: rgb(255, 153, 200);">'off'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">if </span><span>t == 10 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">|</span><span> t == 11 </span><span class="warning_squiggle_rte1619232262 warningHighlight1619232262">|</span><span> t == 12</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        mlabel(</span><span style="color: rgb(255, 153, 200);">'MLabelLocation'</span><span>,10,</span><span style="color: rgb(255, 153, 200);">'MLabelParallel'</span><span>,</span><span style="color: rgb(255, 153, 200);">'south'</span><span>,</span><span style="color: rgb(255, 153, 200);">'Fontsize'</span><span>,16)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        mlabel(</span><span style="color: rgb(255, 153, 200);">'off'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    framem</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    tightmap</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    set(gcf, </span><span style="color: rgb(255, 153, 200);">'Color'</span><span>, </span><span style="color: rgb(255, 153, 200);">'w'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(237, 177, 32);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>saveas(gcf,[output_dir,</span><span style="color: rgb(255, 153, 200);">'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_SupplementalFigure7_pre_option2'</span><span>],</span><span style="color: rgb(255, 153, 200);">'epsc'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clearvars </span><span style="color: rgb(255, 153, 200);">-except *_dir</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>close </span><span style="color: rgb(255, 153, 200);">all</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S2'></div></div></div></div>
<br>
<!-- 
##### SOURCE BEGIN #####
%% GoncalvesNeto_et_al_2021_CommsEarth

% Afonso Goncalves Neto
% December 1, 2020

% In this script, all of the figures in Gon√ßalves Neto, Langan & Palter
% (2021) are created. Additional steps in Adobe Illustrator were applied to
% generate the final formatting in the manuscript.

%% Figure 1
% Schematic of the circulation in the Northwest Atlantic Ocean and the water 
% column temperature change in the period 2009-2018 relative to 2001-2007. The 
% filled red (blue) contours indicate warming (cooling) of the vertically-
% averaged ocean temperature from the EN4 objective analysis (Good et al., 2013)
% to 2,000 m or the seafloor if it is shallower than 2,000 m in 0.5oC increments
% (change in the unshaded region is <0.25oC). Background in grayscale shows the
% bathymetry of the region, with darker shades representing shallower areas. The
% main surface circulation patterns associated with the Gulf Stream (red) and 
% the Labrador Current (blue) systems are identified with arrows. Coastal and 
% shelf areas of interest are indicated. TGB stands for Tail of the Grand Banks 
% and SENR, for Southeastern Newfoundland Ridge.

% Set  directory to save data
data_dir = '/Users/afonso/Documents/Research/TGB/data/';
% Set directory to save figures and tables
output_dir = '/Users/afonso/Documents/Research/TGB/output/';

% Bathymetry (first layer)

load([output_dir,'etopo1_TGB.mat'],'lat_z','lon_z','z')

figure('Position', [100, 200, 800, 600])
subplot('Position',[0.06 0.09 0.88 0.85])
axesm('MapProjection','eqdcylin','MapLatLimit',[30 60],'MapLonLimit',[-80 -40])
hold on
pcolorm(lat_z,lon_z,z)
shading flat
colormap(cmocean('gray','negative'))
caxis([-4500 2000])
geoshow('GSHHS_i_L1.shp','FaceColor','k')%[.7 .7 .7])
plabel('PLabelLocation',5,'fontsize',14)
mlabel('MLabelLocation',10,'MLabelParallel','south','fontsize',14)
framem
tightmap
set(gcf, 'Color', 'w')
saveas(gcf,[output_dir,'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_Figure1_layer1'],'epsc')
%export_fig(gcf,[output_dir,'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_Figure1_layer1'],'-eps','-transparent')

% Temperature change (second layer)

load([data_dir,'en4_NWA.mat'],'t_en4','s_en4','lon_en4','lat_en4','time_en4')

[~,in1] = min(abs(time_en4 - datenum('20010115','yyyymmdd')));
[~,out1] = min(abs(time_en4 - datenum('20071215','yyyymmdd')));
[~,in2] = min(abs(time_en4 - datenum('20090115','yyyymmdd')));
[~,out2] = min(abs(time_en4 - datenum('20181215','yyyymmdd')));

t_en4_2001_2007 = nanmean(nanmean(t_en4(:,:,1:30,in1:out1),4),3);
t_en4_2009_2018 = nanmean(nanmean(t_en4(:,:,1:30,in2:out2),4),3);

figure('Position', [100, 200, 800, 600])
subplot('Position',[0.06 0.09 0.88 0.85])
axesm('MapProjection','eqdcylin','MapLatLimit',[30 60],'MapLonLimit',[-80 -40])
hold on
t_diff = t_en4_2009_2018' - t_en4_2001_2007';
pcolorm(lat_en4,lon_en4,t_diff)
shading flat
fillm([53,53,55,55],[-67,-63,-63,-67],'k')
%rectangle('Position',[0.2,0.8,0.1,0.1],'FaceColor','k','EdgeColor','k')
%rectangle('Position',[52,-68,2,4],'FaceColor','k','EdgeColor','k')
colormap([5/256,113/256,175/256;...
    5/256,113/256,176/256;...
    247/256,247/256,247/256;...
    247/256,247/256,247/256;...
    244/256,165/256,130/256;...
    244/256,165/256,130/256;...
    214/256,96/256,77/256;...
    214/256,96/256,77/256;...
    178/256,24/256,43/256;...
    178/256,24/256,43/256])

set(gca,'FontSize',14)
geoshow('GSHHS_i_L1.shp','FaceColor','k')%[.7 .7 .7])
plabel('PLabelLocation',5,'Fontsize',14)
mlabel('MLabelLocation',10,'MLabelParallel','south','Fontsize',14)
framem
tightmap
%cbarrow

c = colorbar('Orientation','Horizontal','Position',[0.2 0.7 0.27 0.04],'Color',[1-eps,1,1],'Fontsize',10);%colorbar over land
c.Label.String = 'Temperature Difference (^\circC)';
c.Ticks = [-0.75 -0.25 0.25 0.75 1.25 1.75];
set(c,'Fontsize',14)
caxis([-0.75 1.75])

set(gcf, 'Color', 'w')
saveas(gcf,[output_dir,'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_Figure1_layer2'],'epsc')

clearvars -except *_dir
close all

%% Figure 2

% Set  directory to save data
data_dir = '/Users/afonso/Documents/Research/TGB/data/';
% Set directory to save figures and tables
output_dir = '/Users/afonso/Documents/Research/TGB/output/';

load([output_dir,'etopo1_TGB.mat'],'lat_z','lon_z','z')
load([output_dir,'SSH_TGB.mat'],'time_month','lat_ssh','lon_ssh','adt')

figure('Position', [100, 200, 800, 600])
axesm('MapProjection','eqdcylin','MapLatLimit',[30 60],'MapLonLimit',[-80 -40])
hold on
c1_aux = contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),[-500 -500],'k','linewidth',1);
%c1_aux = contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),[-1000 -1000],'k','linewidth',1);
%c01_aux = contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),[-100 -100],'k','linewidth',1);
linem([36 36],[360-75 360-47],'k')
linem([46 46],[360-75 360-47],'k')
linem([36 46],[360-75 360-75],'k')
linem([36 46],[360-47 360-47],'k')
geoshow('landareas.shp','FaceColor','k')%[.7 .7 .7])

close all

c1 = NaN(2,1);
j = 1;
for i = 2:length(c1_aux)
    if c1_aux(1,i)>=360-75 & c1_aux(1,i)<=360-47 & c1_aux(2,i)>=36 & c1_aux(2,i)<=46
        c1(:,j) = c1_aux(:,i);
        if j>1
            if abs(c1_aux(1,i)-c1(1,j-1))<0.2
                j = j+1;
            else
                c1(:,j) = NaN;
            end
        else
            j = j+1;
        end
    end
end
clear i j

if isnan(c1(1,end))
    c1 = c1(:,1:end-1);% lon,lat of 1000m isobath
end

c1(3,:) = zeros;
c1_dist = gsw_distance(c1(1,:),c1(2,:));
for i = 2:length(c1)
    c1(3,i) = sum(c1_dist(1:i-1));
end
clear c1_aux c1_dist i

% Lat and Lon for TGB, slope and shelf

lon_ssh2 = lon_ssh(lon_ssh>=360-75 & lon_ssh<=360-45);
lat_ssh2 = lat_ssh(lat_ssh>=36 & lat_ssh<=46);
[lon_ssh2_mesh,lat_ssh2_mesh] = meshgrid(lon_ssh2,lat_ssh2);

lon_z2 = lon_z(lon_z>=360-75 & lon_z<=360-45);
lat_z2 = lat_z(lat_z>=36 & lat_z<=46);
[lon_z2_mesh,lat_z2_mesh] = meshgrid(lon_z2,lat_z2);

z2 = z(lat_z>=36 & lat_z<=46,lon_z>=360-75 & lon_z<=360-45)';

% Define area at TGB between 3000m and 4000 isobaths (for time series)

[lon_mesh,lat_mesh] = meshgrid(lon_ssh,lat_ssh);

[lon_z_mesh,lat_z_mesh] = meshgrid(lon_z,lat_z);
lon_z_tgb = lon_z(lon_z>=360-51 & lon_z<=360-46);
lat_z_tgb = lat_z(lat_z>=39 & lat_z<=43);

z_ssh = interp2(lon_z_mesh,lat_z_mesh,z,lon_mesh,lat_mesh);
z_tgb = z_ssh(lat_ssh>=39 & lat_ssh<=43,lon_ssh>=360-51 & lon_ssh<=360-46);
[z_aux1,z_aux2] = find(z_tgb>=-4000 & z_tgb<=-3000);
z_aux3 = z_aux1+36;
z_aux4 = z_aux2+116;

% SLA at TGB

adt_TGB = nan(length(time_month),length(z_aux4));
for i=1:length(z_aux4)
    adt_TGB(:,i) = squeeze(adt(z_aux4(i),z_aux3(i),:));
end
adt_TGB2 = nanmean(adt_TGB,2);
adt_TGB2_lp = filtfilt(ones(12,1)/12,1,adt_TGB2(1:end-1));

% ADT time series

sla_TGB2_std = nanstd(adt_TGB2);
sla_TGB2_mean = nanmean(adt_TGB2);
sla2_TGB2 = adt_TGB2;%-sla_TGB2_mean;
sla2_TGB2_lp = filtfilt(ones(12,1)/12,1,sla2_TGB2(1:end-1));

slahigh = find(sla2_TGB2>(1.5*sla_TGB2_std));
slalow = find(sla2_TGB2<-(1.5*sla_TGB2_std));

% annual averages
sla2_TGB2_yr = NaN(26,1);
for i = 1:26
    sla2_TGB2_yr(i,1) = nanmean(sla2_TGB2(i*12-11:i*12));
end

% monthly averages
sla2_TGB2_mo = NaN(12,1);
for i = 1:12
    sla2_TGB2_mo(i,1) = nanmean(sla2_TGB2(i:12:16*12+i));
    sla2_TGB2_mo_std(i,1) = nanstd(sla2_TGB2(i:12:16*12+i));
end

for i = 1:26
    sla2_TGB2_nomo(i*12-11:i*12) = sla2_TGB2(i*12-11:i*12) - sla2_TGB2_mo;
end

sla2_TGB2_nomo_mean = nanmean(sla2_TGB2_nomo);
sla2_TGB2_nomo_std = nanstd(sla2_TGB2_nomo);
sla2_TGB2_nomo = sla2_TGB2_nomo - sla2_TGB2_nomo_mean;
slahigh_nomo = find(sla2_TGB2_nomo>(1.5*(sla2_TGB2_nomo_std)));
slalow_nomo = find(sla2_TGB2_nomo<(1.5*(-sla2_TGB2_nomo_std)));
sla2_TGB2_nomo_lp = filtfilt(ones(12,1)/12,1,sla2_TGB2_nomo(1:end-1));

[ipt,ipt_res] = findchangepts(sla2_TGB2_nomo(1:end-1));

% TGB SSH increase: 0.1043 m
nanmean(sla2_TGB2_nomo(1:12*15))% -0.0409 m
nanmean(sla2_TGB2_nomo(12*16+1:end))% 0.0634 m
round(100*nanmean(sla2_TGB2_nomo(1:ipt)),1)% -0.0417 m
nanmean(sla2_TGB2_nomo(ipt:end))% 0.0625 m

save('SSH_TGB_anom.mat','sla2_TGB2','sla2_TGB2_nomo','sla2_TGB2_mo','sla2_TGB2_mo_std')

% Basin SSH increase: 0.0450
nanmean(nanmean(nanmean(adt(:,:,1:12*15),3)))% - 0.0066 m
nanmean(nanmean(nanmean(adt(:,:,12*16+1:end),3)))% 0.0384 m

%csvwrite([output_dir,'SSH_TGB_1993-2018.csv'],sla2_TGB2_nomo')

% SSH fit
sla2_fit_aux = readtable('SSH.Fit.csv', 'HeaderLines',1);
sla2_fit = table2array(sla2_fit_aux);
clear sla2_fit_aux

mycolors = linspecer(2);

adt_mean = nanmean(adt,3);
figure('Position', [100, 200, 800, 600])
subplot('Position',[0.05 0.52 0.46 0.46])
axesm('MapProjection','eqdcylin','MapLatLimit',[30 60],'MapLonLimit',[-80 -40])
hold on
pcolorm(lat_ssh,lon_ssh,(adt_mean')*100)
shading interp
colormap(cmocean('balance',32))
c = colorbar('Orientation','Horizontal','Position',[0.12 0.84 0.1 0.02],'Color',[1-eps,1,1],'Fontsize',10);%colorbar over land
c.Label.String = 'SSH (cm)';
set(c,'Fontsize',14)%,'Fontweight','bold')
c.Ticks = [-80 0 80];
caxis([-80 80])
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-100 -100],'color',[77/256 77/256 77/256],'linewidth',0.5)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-1000 -1000],'color',[77/256 77/256 77/256],'linewidth',0.5)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-3000 -3000],'color',[77/256 77/256 77/256],'linewidth',0.5)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-4000 -4000],'color',[77/256 77/256 77/256],'linewidth',0.5)
contourm(lat_z2(1:2:end),lon_z2(1:2:end-120),z2(1:2:end-120,1:2:end)',[-1000 -1000],'r','linewidth',2)
contourm(lat_z2(lat_z2>=39 & lat_z2<43),lon_z2(lon_z2>=360-51 & lon_z2<=360-46),z2(lon_z2>=360-51 & lon_z2<=360-46,lat_z2>=39 & lat_z2<43)',[-3000 -3000],'k','linewidth',2)
contourm(lat_z2(lat_z2>=39 & lat_z2<43),lon_z2(lon_z2>=360-51 & lon_z2<=360-46),z2(lon_z2>=360-51 & lon_z2<=360-46,lat_z2>=39 & lat_z2<43)',[-4000 -4000],'k','linewidth',2)
[aux1 aux2] = min(abs(lon_z2-360+51));
[a1 b1] = min(abs(z2(aux2,:)+3000));
[a2 b2] = min(abs(z2(aux2,:)+4000));
[aux1 aux2] = min(abs(lat_z2-43));
[a3 b3] = min(abs(z2(1300:end,aux2)+3000));
[a4 b4] = min(abs(z2(1300:end,aux2)+4000));
linem([lat_z2(b1) lat_z2(b2)],[-51 -51],'k','linewidth',2)
linem([43 43],[lon_z2(b3+1300) lon_z2(b4+1300)],'k','linewidth',2)
linem([43 46],[360-55 360-57.5],':k','linewidth',2)
linem([40.8 43],[360-64 360-67.5],':k','linewidth',2)
linem([38.6 41.6],[360-68.8 360-68.8],':k','linewidth',2)
textm(42.5,360-55,'LCh','color','k','Fontsize',14,'Fontweight','bold')
textm(40.8,360-63.5,'NECh','color','k','Fontsize',14,'Fontweight','bold')
textm(39,360-68.3,'GSCh','color','k','Fontsize',14,'Fontweight','bold')
%contourm(lat_ssh,lon_ssh,(adt_mean')*100,[25 25],'m','linewidth',2)
geoshow('GSHHS_i_L1.shp','FaceColor','k')%[.7 .7 .7])
plabel('PLabelLocation',5,'Fontsize',14)
mlabel('MLabelLocation',10,'MLabelParallel','south')
framem
tightmap

adt_diff = nanmean(adt(:,:,12*16+1:end),3)-nanmean(adt(:,:,1:12*15),3);
subplot('Position',[0.52 0.52 0.46 0.46])
axesm('MapProjection','eqdcylin','MapLatLimit',[30 60],'MapLonLimit',[-80 -40])
hold on
pcolorm(lat_ssh,lon_ssh,(adt_diff'-nanmean(nanmean(adt_diff)))*100)
shading interp
colormap(cmocean('balance',15))
c = colorbar('Orientation','Horizontal','Position',[0.59 0.84 0.1 0.02],'Color',[1-eps,1,1],'Fontsize',10);%colorbar over land
c.Label.String = 'SSH Diff (cm)';
set(c,'Fontsize',14)%,'Fontweight','bold')
c.Ticks = [-15 0 15]
caxis([-15 15])
contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),[-100 -100],'color',[77/256 77/256 77/256],'linewidth',0.5)
contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),[-1000 -1000],'color',[77/256 77/256 77/256],'linewidth',0.5)
contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),[-3000 -3000],'color',[77/256 77/256 77/256],'linewidth',0.5)
contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),[-4000 -4000],'color',[77/256 77/256 77/256],'linewidth',0.5)
%contourm(lat_ssh,lon_ssh,(adt_mean')*100,[25 25],'m','linewidth',2)
geoshow('GSHHS_i_L1.shp','FaceColor','k')%[.7 .7 .7])
plabel('off')
mlabel('MLabelLocation',10,'MLabelParallel','south','fontsize',14)
framem
tightmap

subplot('Position',[0.08 0.075 0.88 0.38])
hold on
%plot(time_month,sla2_TGB2_nomo*100,'color',[120/256,120/256,120/256],'LineWidth',1)
%plot(time_month(7:end-6),sla2_TGB2_nomo_lp(7:end-5)*100,'color',[60/256,60/256,60/256],'LineWidth',2)
%plot([time_month(1) time_month(ipt)],[nanmean(sla2_TGB2_nomo(1:ipt))*100 nanmean(sla2_TGB2_nomo(1:ipt))*100],'color',mycolors(1,:),'LineWidth',3)
%plot([time_month(ipt) time_month(end)],[nanmean(sla2_TGB2_nomo(ipt:end))*100 nanmean(sla2_TGB2_nomo(ipt:end))*100],'color',mycolors(2,:),'LineWidth',3)
plot(time_month(1:end-1),sla2_fit(:,4)*100,'color',rgb('DarkGray'),'LineWidth',1.5)
plot(time_month(1:end-1),sla2_fit(:,3)*100,'color',rgb('DarkSlateGray'),'LineWidth',1.5)
plot([time_month(1) time_month(ipt)],[nanmean(sla2_fit(1:ipt,3))*100 nanmean(sla2_fit(1:ipt,3))*100],'color',mycolors(1,:),'LineWidth',3)
plot([time_month(ipt) time_month(end)],[nanmean(sla2_fit(ipt:end,3))*100 nanmean(sla2_fit(ipt:end,3))*100],'color',mycolors(2,:),'LineWidth',3)
%text(datenum('19930701','yyyymmdd'),15,...
%    ['$\bf{\overline{SSH}_{pre-shift} = ',num2str(round(100*nanmean(sla2_TGB2_nomo(1:ipt)),1)),' cm}$'],...
%    'Interpreter','latex','FontName','Helvetica','FontSize',16,'color',mycolors(1,:))
%text(datenum('20120101','yyyymmdd'),-15,...
%    ['$\bf{\overline{SSH}_{post-shift} = ',num2str(round(100*nanmean(sla2_TGB2_nomo(ipt:end)),1)),' cm}$'],...
%    'Interpreter','latex','FontName','Helvetica','FontSize',16,'color',mycolors(2,:))
datetick('x','yy')
grid on
%ylim([-25 30]);
ylim([-30 30]);
xlim([time_month(1) time_month(end)]);
set(gca,'FontSize',14)%,'xtick',[])
ylabel('SSH Anomaly (cm)')
xlabel('Time (years)')
box on
set(gcf, 'Color', 'w')

saveas(gcf,[output_dir,'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_Figure2revised_pre'],'epsc')

clearvars -except *_dir
close all

figure('Position', [100, 200, 800, 350])
axesm('MapProjection','eqdcylin','MapLatLimit',[36 46],'MapLonLimit',[-75 -47])
hold on
c1_aux = contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),[-1000 -1000],'k','linewidth',1);
c01_aux = contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),[-500 -500],'k','linewidth',1);
linem([36 36],[360-75 360-47],'k')
linem([46 46],[360-75 360-47],'k')
linem([36 46],[360-75 360-75],'k')
linem([36 46],[360-47 360-47],'k')
geoshow('landareas.shp','FaceColor','k')%[.7 .7 .7])
plabel('PLabelLocation',0.5)
mlabel('MLabelLocation',0.5,'MLabelParallel','south','fontsize',14)
framem
tightmap
gridm
set(gcf, 'Color', 'w')

%saveas(gcf,[output_dir,'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_isobaths'],'png')

%% Figure 3

% Set  directory to save data
data_dir = '/Users/afonso/Documents/Research/TGB/data/';
% Set directory to save figures and tables
output_dir = '/Users/afonso/Documents/Research/TGB/output/';

load([output_dir,'etopo1_TGB.mat'],'lat_z','lon_z','z')
load([output_dir,'SSH_TGB.mat'],'time_month','lat_ssh','lon_ssh','u_g','v_g')
load([data_dir,'en4_NWA2.mat'],'lon_en4','lat_en4')

figure('Position', [100, 200, 800, 600])
axesm('MapProjection','eqdcylin','MapLatLimit',[30 60],'MapLonLimit',[-80 -40])
hold on
c1_aux = contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),[-500 -500],'k','linewidth',1);
%c1_aux = contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),[-1000 -1000],'k','linewidth',1);
linem([36 36],[360-75 360-47],'k')
linem([46 46],[360-75 360-47],'k')
linem([36 46],[360-75 360-75],'k')
linem([36 46],[360-47 360-47],'k')
geoshow('landareas.shp','FaceColor','k')%[.7 .7 .7])

close all

c1 = NaN(2,1);
j = 1;
for i = 2:length(c1_aux)
    if c1_aux(1,i)>=360-75 & c1_aux(1,i)<=360-47 & c1_aux(2,i)>=36 & c1_aux(2,i)<=46
        c1(:,j) = c1_aux(:,i);
        if j>1
            if abs(c1_aux(1,i)-c1(1,j-1))<0.2
                j = j+1;
            else
                c1(:,j) = NaN;
            end
        else
            j = j+1;
        end
    end
end
clear i j

if isnan(c1(1,end))
    c1 = c1(:,1:end-1);% lon,lat of 1000m isobath
end

c1(3,:) = zeros;
c1_dist = gsw_distance(c1(1,:),c1(2,:));
for i = 2:length(c1)
    c1(3,i) = sum(c1_dist(1:i-1));
end
clear c1_aux c1_dist i

% Lat and Lon for TGB, slope and shelf

lon_ssh2 = lon_ssh(lon_ssh>=360-75 & lon_ssh<=360-45);
lat_ssh2 = lat_ssh(lat_ssh>=36 & lat_ssh<=46);
[lon_ssh2_mesh,lat_ssh2_mesh] = meshgrid(lon_ssh2,lat_ssh2);

lon_z2 = lon_z(lon_z>=360-75 & lon_z<=360-45);
lat_z2 = lat_z(lat_z>=36 & lat_z<=46);
[lon_z2_mesh,lat_z2_mesh] = meshgrid(lon_z2,lat_z2);

z2 = z(lat_z>=36 & lat_z<=46,lon_z>=360-75 & lon_z<=360-45)';

% Define velocity on different isobaths

[lon_mesh lat_mesh] = meshgrid(lon_ssh,lat_ssh);

u_z = NaN(length(lat_z2),length(lon_z2),size(u_g,3));
v_z = NaN(length(lat_z2),length(lon_z2),size(v_g,3));

for t = 1:length(time_month)
    u_z(:,:,t) = interp2(lon_mesh,lat_mesh,u_g(:,:,t)',lon_z2_mesh,lat_z2_mesh);
    v_z(:,:,t) = interp2(lon_mesh,lat_mesh,v_g(:,:,t)',lon_z2_mesh,lat_z2_mesh);
end

% 1000m 
u_1 = NaN(length(c1),length(time_month));
v_1 = NaN(length(c1),length(time_month));

for t = 1:length(time_month)
    u_1(:,t) = interp2(lon_z2_mesh,lat_z2_mesh,u_z(:,:,t),c1(1,:),c1(2,:));
    v_1(:,t) = interp2(lon_z2_mesh,lat_z2_mesh,v_z(:,:,t),c1(1,:),c1(2,:));
end

clear u_z v_z z2 lon_z2* lat_z2* lon_ssh2* lat_ssh2* u_g v_g t

% Rotating velocities

% magnitude of input vector
uv_in = sqrt(u_1.^2 + v_1.^2);

cross_1 = NaN(size(u_1,1)-1,size(u_1,2));
along_1 = NaN(size(u_1,1)-1,size(u_1,2));
cross_1_u = NaN(size(u_1,1)-1,size(u_1,2));
cross_1_v = NaN(size(u_1,1)-1,size(u_1,2));
along_1_u = NaN(size(u_1,1)-1,size(u_1,2));
along_1_v = NaN(size(u_1,1)-1,size(u_1,2));
cross_1_anom = NaN(size(u_1,1)-1,size(u_1,2));
along_1_anom = NaN(size(u_1,1)-1,size(u_1,2));

for t = 1:length(time_month)-1
    for i = 1:size(c1,2)-1
                
        % direction of input vector (angle relative to north, increases clockwise)
        if u_1(i,t) >= 0 & v_1(i,t) >= 0
            theta_in = atand(u_1(i,t)/v_1(i,t));
            %theta_in_aux = theta_in
        elseif u_1(i,t) >= 0 & v_1(i,t) < 0
            theta_in = 180 + atand(u_1(i,t)/v_1(i,t));
            %theta_in_aux = theta_in - 90
        elseif u_1(i,t) < 0 & v_1(i,t) < 0
            theta_in = 180 + atand(u_1(i,t)/v_1(i,t));
            %theta_in_aux = theta_in - 180
        elseif u_1(i,t) < 0 & v_1(i,t) >= 0
            theta_in = 360 + atand(u_1(i,t)/v_1(i,t));
            %theta_in_aux = theta_in - 270
        end
        
        % direction of speed (angle relative to north, increases clockwise)
        if (c1(2,i+1)-c1(2,i)) >= 0 & (c1(1,i+1)-c1(1,i)) >= 0
            theta_rot = atand((c1(1,i+1)-c1(1,i))/(c1(2,i+1)-c1(2,i)));
            %theta_rot_aux = 90 - theta_rot
        elseif (c1(2,i+1)-c1(2,i)) < 0 & (c1(1,i+1)-c1(1,i)) >= 0
            theta_rot = 180 + atand((c1(1,i+1)-c1(1,i))/(c1(2,i+1)-c1(2,i)));
            %theta_rot_aux = 180 - theta_rot
        elseif (c1(2,i+1)-c1(2,i)) < 0 & (c1(1,i+1)-c1(1,i)) < 0
            theta_rot = 180 + atand((c1(1,i+1)-c1(1,i))/(c1(2,i+1)-c1(2,i)));
            %theta_rot_aux = 270 - theta_rot
        elseif (c1(2,i+1)-c1(2,i)) >= 0 & (c1(1,i+1)-c1(1,i)) < 0
            theta_rot = 360 + atand((c1(1,i+1)-c1(1,i))/(c1(2,i+1)-c1(2,i)));
            %theta_rot_aux = 360 - theta_rot
        end
        
        % direction of speed relative to the new coordinate system
        if theta_in > theta_rot
            theta_out = theta_in - theta_rot;
        else
            theta_out = 360 - theta_rot + theta_in;
        end
        
        
        cross_1(i,t) = uv_in(i,t) * sind(theta_out);
        along_1(i,t) = uv_in(i,t) * cosd(theta_out);
        uv_out = sqrt(along_1.^2 + cross_1.^2);
        
        along_1_u(i,t) = along_1(i,t) * sind(theta_rot);
        along_1_v(i,t) = along_1(i,t) * cosd(theta_rot);
        
        if theta_rot + 90 > 360
            cross_1_u(i,t) = cross_1(i,t) * sind(theta_rot-270);
            cross_1_v(i,t) = cross_1(i,t) * cosd(theta_rot-270);
        else
            cross_1_u(i,t) = cross_1(i,t) * sind(theta_rot+90);
            cross_1_v(i,t) = cross_1(i,t) * cosd(theta_rot+90);
        end
        clear theta*
    end
end
clear i t

% Calculate anomalies

for i = 1:size(c1,2)-1
    along_1_anom(i,:) = along_1(i,:) - nanmean(along_1(i,:));
    cross_1_anom(i,:) = cross_1(i,:) - nanmean(cross_1(i,:));
end

% Remove seasonality

% calculate monthly averages
along_1_mo = NaN(size(along_1,1),12);
cross_1_mo = NaN(size(along_1,1),12);
for j = 1:size(along_1,1)
    for i = 1:12
        along_1_mo(j,i) = nanmean(along_1(j,i:12:25*12+i));
        cross_1_mo(j,i) = nanmean(cross_1(j,i:12:25*12+i));
    end
end

% remove monthly averages
along_1_nomo = NaN(size(along_1));
cross_1_nomo = NaN(size(along_1));
for j = 1:size(along_1,1)
    for i = 1:26
        along_1_nomo(j,i*12-11:i*12) = along_1(j,i*12-11:i*12) - along_1_mo(j,:);
        cross_1_nomo(j,i*12-11:i*12) = cross_1(j,i*12-11:i*12) - cross_1_mo(j,:);
    end
end

% Calculate lagged correlations (deseasonalized)

% along_nomo_corrlag = NaN(size(along_1_nomo,1)-40,61);
% along_nomo_p = NaN(size(along_1_nomo,1)-40,61);
% along_nomo_pl = NaN(size(along_1_nomo,1)-40,61);
% along_nomo_pu = NaN(size(along_1_nomo,1)-40,61);
% for i = 41:size(along_1,1)
%     for l = 0:60
%         [aux_corr,aux_p,aux_pl,aux_pu] = corrcoef(along_1_nomo(41,1:end-1-l),along_1_nomo(i,1+l:end-1));
%         along_nomo_corrlag(i-40,l+1) = aux_corr(1,2);
%         along_nomo_p(i-40,l+1) = aux_p(1,2);
%         along_nomo_pl(i-40,l+1) = aux_pl(1,2);
%         along_nomo_pu(i-40,l+1) = aux_pu(1,2);
%         clear aux_corr aux_p aux_pl aux_pu
%     end
% end

along_nomo_corrlag = NaN(size(along_1_nomo,1),61);
along_nomo_p = NaN(size(along_1_nomo,1),61);
along_nomo_pl = NaN(size(along_1_nomo,1),61);
along_nomo_pu = NaN(size(along_1_nomo,1),61);
for i = 1:size(along_1,1)
    for l = -12:48
        if l>=0
            [aux_corr,aux_p,aux_pl,aux_pu] = corrcoef(along_1_nomo(41,1:end-1-l),along_1_nomo(i,1+l:end-1));
        else
            [aux_corr,aux_p,aux_pl,aux_pu] = corrcoef(along_1_nomo(41,1-l:end-1),along_1_nomo(i,1:end-1+l));
        end
        along_nomo_corrlag(i,l+13) = aux_corr(1,2);
        along_nomo_p(i,l+13) = aux_p(1,2);
        along_nomo_pl(i,l+13) = aux_pl(1,2);
        along_nomo_pu(i,l+13) = aux_pu(1,2);
        clear aux_corr aux_p aux_pl aux_pu
    end
end

% T149 from Joe

%T2 = readtable('Z149mat2.xlsx','TreatAsEmpty',["NA"]);
T = readtable('Z149mat22.csv', 'HeaderLines',1);
T1 = table2array(T);
T1(T1==0) = NaN;
T149_change_point = NaN(1,1271);
T149_change = NaN(1,1271);
for j = 1:1271
    if sum(~isnan(T1(:,j))) >= 1
        T149_change_point(1,j) = find(~isnan(T1(:,j)));
        T149_change(1,j) = T1(T149_change_point(1,j),j);
    end
end
%     aux = T1(:,j);
%     aux1 = ~isnan(T1(:,j))
%     for i = 1:264
%         aux = ~isnan(T1(i,j));
%         %aux = strcmp(T1(i,j),{'NA'});
%         if aux==0
%             T149_change_point(1,j) = i;
%             T149_change(1,j) = T1(i,j);
%         end
%     end
% end

T149_change_reshape = reshape(T149_change,41,31);
T149_change_point_reshape = reshape(T149_change_point,41,31);

% Set window to Jan/2009 to Dec/2011
T149_change_reshape_20092011 = T149_change_reshape;
T149_change_reshape_20092011(T149_change_point_reshape<193 | T149_change_point_reshape>228) = NaN;
T149_change_point_reshape_20092011 = T149_change_point_reshape;
T149_change_point_reshape_20092011(T149_change_point_reshape<193 | T149_change_point_reshape>228) = NaN;

[lon_en4_mesh,lat_en4_mesh] = meshgrid(lon_en4,lat_en4);
[lon_mab,lat_mab] = find(T149_change_point_reshape_20092011>=217 & lon_en4_mesh' < 295 & lon_en4_mesh' > 283 & lat_en4_mesh' > 33);
[lon_gom,lat_gom] = find(T149_change_point_reshape_20092011>=202 & T149_change_point_reshape_20092011<=213 & lon_en4_mesh' < 298);

[lon_ss,lat_ss] = find(T149_change_point_reshape_20092011>=193 & T149_change_point_reshape_20092011<=201 & lon_en4_mesh' <= 299);% & lat_en4_mesh' < 46);
[lon_lc,lat_lc] = find(T149_change_point_reshape_20092011>=193 & T149_change_point_reshape_20092011<=201 & lon_en4_mesh' >= 300);% & lat_en4_mesh' < 46);

figure('Position', [100, 200, 600, 650])

sp1 = subplot('Position',[0.08 0.69 0.82 0.25]);
hold on
%pcolor(c1(3,41:end-1)/1000,0:20,along_nomo_corrlag(:,1:21)')
pcolor(c1(3,1:end-1)/1000,-6:18,along_nomo_corrlag(:,7:31)')
shading interp
%colormap jet
%colormap(sp1,cmocean('balance',28,'pivot',0.18))
colormap(sp1,crameri('vik',28,'pivot',0.18))
c = colorbar;
c.Label.String = 'Corr Coef';
%c.Ticks = [-0.2 -0.16 -0.12 -0.08 -0.04 0 0.04 0.08 0.12 0.20 0.28 0.36 0.44 0.52 0.60 0.68 0.76 0.84 0.92 1]
set(c,'Fontsize',14)
caxis([-0.1 0.6])
%cbarrow
%contour(c1(3,41:end-1)/1000,0:20,along_nomo_p(:,1:21)',[0.05 0.05],'w','linewidth',3)
contour(c1(3,1:end-1)/1000,-6:18,along_nomo_p(:,7:31)',[0.05 0.05],'w','linewidth',3)
%contour(c1(3,41:end-1)/1000,0:20,along_nomo_corrlag(:,1:21)',[0.12 0.12],'y','linewidth',3)
%contour(0:60,c1(3,41:end-1)/1000,along_nomo_corrlag,[0.18 0.18],'y','linewidth',3)
dd = linspace(500,2283,10);
tt = linspace(0,13,10);
plot(dd,tt,'kREPLACE_WITH_DASH_DASH','LineWidth',4)
plot([c1(3,36)/1000 c1(3,36)/1000],[-6 18],':k','LineWidth',2)
plot([c1(3,94)/1000 c1(3,94)/1000],[-6 18],':k','LineWidth',2)
%text(c1(3,94)/1000,20.2,'Laurentian Channel','FontSize',14,'FontWeight','bold')
plot([c1(3,165)/1000 c1(3,165)/1000],[-6 18],':k','LineWidth',2)
%text(c1(3,165)/1000,20.2,'Northeast Channel','FontSize',14,'FontWeight','bold')
plot([c1(3,196)/1000 c1(3,196)/1000],[-6 18],':k','LineWidth',2)
%text(c1(3,196)/1000,20.2,'Great South Channel','FontSize',14,'FontWeight','bold')
%set(gca,'xdir','reverse','FontSize',14)
ax1=gca;
set(ax1,'xdir','reverse','xtick',[c1(3,36)/1000,(c1(3,36)/1000)+500,...
    (c1(3,36)/1000)+1000,(c1(3,36)/1000)+1500,(c1(3,36)/1000)+2000,...
    (c1(3,36)/1000)+2500],'xticklabel',...
    [{0};{500};{1000};{1500};{2000};{2500};],'FontSize',14)
xlabel('Distance (km)','FontSize',14)
ylabel('Lag (months)','FontSize',14)
ax2 = axes('Position', get(ax1, 'Position'),'Color', 'none');
set(ax2, 'XLim', get(ax1, 'XLim'),'YLim', get(ax1, 'YLim'));
set(ax2, 'XTick', get(ax1, 'XTick'), 'YTick', get(ax1, 'YTick'));
set(ax2, 'XAxisLocation','top','ytick',[],'xdir','reverse','xtick',[c1(3,36)/1000,c1(3,94)/1000,c1(3,165)/1000,c1(3,196)/1000,c1(3,end-1)/1000],...
    'xticklabel',[{'TGB'};{'LCh'};{'NECh'};{'GSCh'};{'CH'}],'FontSize',14)
%title('Along-slope velocity from TGB')
set(gcf, 'Color', 'w')

sp2 = subplot('Position',[0.08 0.06 0.86 0.6]);
axesm('MapProjection','eqdcylin','MapLatLimit',[33 50],'MapLonLimit',[-77 -48])
hold on
%t_diff = t10002000_en4_2009_2018' - t10002000_en4_2001_2007';
pcolorm(lat_en4,lon_en4,T149_change_point_reshape_20092011')
shading flat
%caxis([min(min(T149_change_point_reshape)) max(max(T149_change_point_reshape))])
%colormap(sp2,cmocean('curl',12))
colormap(sp2,crameri('nuuk',12))
%colormap(sp2,linspecer(12,'sequential'))
%h = colorbar;
caxis([193 229])
%ylabel(h,'Time of Change Point','Fontsize',14)
%set(h,'Fontsize',14,'ytick',[193;199;205;211;217;223],'yticklabel',[datestr(time_ssh(193),'mmmyy');datestr(time_ssh(199),'mmmyy');datestr(time_ssh(205),'mmmyy');datestr(time_ssh(211),'mmmyy');datestr(time_ssh(217),'mmmyy');datestr(time_ssh(223),'mmmyy')])
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-100 -100],'color',[.7 .7 .7],'linewidth',1)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-1000 -1000],'color',[.7 .7 .7],'linewidth',1)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-3000 -3000],'color',[.7 .7 .7],'linewidth',1)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-4000 -4000],'color',[.7 .7 .7],'linewidth',1)
fillm([33.1,33.1,36.2,36.2],[-65,-48.1,-48.1,-65],'facecolor','w','edgecolor','w')
c = colorbar('Orientation','Horizontal','Position',[0.51 0.162 0.32 0.048],'Color','k','Fontsize',10);%colorbar over land
c.Label.String = 'T_{149m} Change Point';
set(c,'Fontsize',14,'ytick',[193;211;229],'yticklabel',[datestr(time_month(193),'mmmyy');datestr(time_month(211),'mmmyy');datestr(time_month(229),'mmmyy')])
%scatterm(lat_en4(lat_mab)+0.5,lon_en4(lon_mab)+0.5,20,plotcolor(2,:),'o','filled')
%scatterm(lat_en4(lat_gom)+0.5,lon_en4(lon_gom)+0.5,20,plotcolor(4,:),'o','filled')
scatterm(lat_en4(lat_lc)+0.5,lon_en4(lon_lc)+0.5,20,'w','o','filled')
scatterm(lat_en4(lat_ss)+0.5,lon_en4(lon_ss)+0.5,20,'k','+','LineWidth',1.5)
scatterm(lat_en4(lat_gom)+0.5,lon_en4(lon_gom)+0.5,20,'w','^','filled')
scatterm(lat_en4(lat_mab)+0.5,lon_en4(lon_mab)+0.5,20,'k','x','LineWidth',2)
linem([44.5 46],[360-56.3 360-57.8],':w','linewidth',3)
linem([41.6 42.6],[360-65 360-67],':w','linewidth',3)
linem([41 41.9],[360-69 360-69],':k','linewidth',3)
linem([40.4 41],[360-69 360-69],':k','linewidth',3)
textm(46,360-57,'LCh','color','w','Fontsize',14,'Fontweight','bold')
textm(43,360-67,'NECh','color','w','Fontsize',14,'Fontweight','bold')
textm(40,360-71.3,'GSCh','color','k','Fontsize',14,'Fontweight','bold')
textm(35,360-75.3,'CH','color','k','Fontsize',14,'Fontweight','bold')
set(gca,'FontSize',14)
geoshow('GSHHS_i_L1.shp','FaceColor','k')%[.7 .7 .7])
plabel('PLabelLocation',5,'Fontsize',14)
mlabel('MLabelLocation',5,'MLabelParallel','south','Fontsize',14)
%title('Change Point of 150-m Deseasonalized Temperature (1993-2018)','fontsize',16)
framem
tightmap
set(gcf, 'Color', 'w')
saveas(gcf,[output_dir,'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_Figure3revised_pre'],'epsc')

clearvars -except *_dir
close all

%% Figure 4

% Set  directory to save data
data_dir = '/Users/afonso/Documents/Research/TGB/data/';
% Set directory to save figures and tables
output_dir = '/Users/afonso/Documents/Research/TGB/output/';

load([data_dir,'EN4_profiles_TGB_AMJ_dec_postQC_toplot.mat'],...
    'T_series1','S_series1','p_interp',...
    't_lc_series1','s_lc_series1',...
    't_gs_series1','s_gs_series1')
load([output_dir,'etopo1_TGB.mat'],'lat_z','lon_z','z')

year = [1930:10:2020];

% Joe's temperature maps

T2 = readtable('Z149mat2.xlsx','TreatAsEmpty',["NA"]);
T = readtable('Z149mat2.csv', 'HeaderLines',1);
T1 = table2array(T);
T1(T1==0) = NaN;
T149_change_point = NaN(1,1271);
T149_change = NaN(1,1271);
for j = 1:1271
    if sum(~isnan(T1(:,j))) >= 1
        T149_change_point(1,j) = find(~isnan(T1(:,j)));
        T149_change(1,j) = T1(T149_change_point(1,j),j);
    end
end
%     aux = T1(:,j);
%     aux1 = ~isnan(T1(:,j))
%     for i = 1:264
%         aux = ~isnan(T1(i,j));
%         %aux = strcmp(T1(i,j),{'NA'});
%         if aux==0
%             T149_change_point(1,j) = i;
%             T149_change(1,j) = T1(i,j);
%         end
%     end
% end

T149_change_reshape = reshape(T149_change,41,31);
T149_change_point_reshape = reshape(T149_change_point,41,31);

% Set window to Jan/2009 to Dec/2011
T149_change_reshape_20092011 = T149_change_reshape;
T149_change_reshape_20092011(T149_change_point_reshape<193 | T149_change_point_reshape>228) = NaN;
T149_change_point_reshape_20092011 = T149_change_point_reshape;
T149_change_point_reshape_20092011(T149_change_point_reshape<193 | T149_change_point_reshape>228) = NaN;

%load([output_dir,'etopo1_TGB.mat'],'lat_z','lon_z','z')
%load([output_dir,'SSH_TGB.mat'],'time_month','lat_ssh','lon_ssh','u_g','v_g')
load([data_dir,'en4_NWA2.mat'],'t_en4','t_unc_en4','lon_en4','lat_en4','time_en4','depth_en4')
time_ssh = time_en4(93*12+1:end-9);
t_en4 = t_en4 - 273.15;

[lon_en4_mesh,lat_en4_mesh] = meshgrid(lon_en4,lat_en4);
[lon_mab,lat_mab] = find(T149_change_point_reshape_20092011>=217 & lon_en4_mesh' < 295);
[lon_gom,lat_gom] = find(T149_change_point_reshape_20092011>=202 & T149_change_point_reshape_20092011<=213 & lon_en4_mesh' < 298);
[lon_ss,lat_ss] = find(T149_change_point_reshape_20092011>=196 & T149_change_point_reshape_20092011<=201 & lon_en4_mesh' <= 299);% & lat_en4_mesh' < 46);
[lon_lc,lat_lc] = find(T149_change_point_reshape_20092011>=196 & T149_change_point_reshape_20092011<=201 & lon_en4_mesh' >= 300);% & lat_en4_mesh' < 46);
[lon_sslc,lat_sslc] = find(T149_change_point_reshape_20092011>=193 & T149_change_point_reshape_20092011<=201 & lon_en4_mesh' < 310);


t149_1930_2018 = squeeze(t_en4(:,:,14,30*12+1:end-9));
t149_1930_2018_unc = squeeze(t_unc_en4(:,:,14,30*12+1:end-9));
time_1930_2018 = time_en4(30*12+1:end-9);

% MAB
for i = 1:length(lat_mab)
    t149_mab_aux(i,:) = squeeze(t149_1930_2018(lon_mab(i),lat_mab(i),:));
    t149_mab_unc_aux(i,:) = squeeze(t149_1930_2018_unc(lon_mab(i),lat_mab(i),:));
end
t149_mab = nanmean(t149_mab_aux,1)';
t149_mab_unc = sqrt(nanmean(t149_mab_unc_aux,1).^2 + nanstd(t149_mab_aux,1).^2)';
clear t_149_mab_aux t149_mab_unc_aux i

% GoM
for i = 1:length(lat_gom)
    t149_gom_aux(i,:) = squeeze(t149_1930_2018(lon_gom(i),lat_gom(i),:));
    t149_gom_unc_aux(i,:) = squeeze(t149_1930_2018_unc(lon_gom(i),lat_gom(i),:));
end
t149_gom = nanmean(t149_gom_aux,1)';
t149_gom_unc = sqrt(nanmean(t149_gom_unc_aux,1).^2 + nanstd(t149_gom_aux,1).^2)';
clear t_149_ss_aux t149_gom_unc_aux i

% SS
for i = 1:length(lat_ss)
    t149_ss_aux(i,:) = squeeze(t149_1930_2018(lon_ss(i),lat_ss(i),:));
    t149_ss_unc_aux(i,:) = squeeze(t149_1930_2018_unc(lon_ss(i),lat_ss(i),:));
end
t149_ss = nanmean(t149_ss_aux,1)';
t149_ss_unc = sqrt(nanmean(t149_ss_unc_aux,1).^2 + nanstd(t149_ss_aux,1).^2)';
clear t_149_ss_aux t149_ss_unc_aux i

% LC
for i = 1:length(lat_lc)
    t149_lc_aux(i,:) = squeeze(t149_1930_2018(lon_lc(i),lat_lc(i),:));
    t149_lc_unc_aux(i,:) = squeeze(t149_1930_2018_unc(lon_lc(i),lat_lc(i),:));
end
t149_lc = nanmean(t149_lc_aux,1)';
t149_lc_unc = sqrt(nanmean(t149_lc_unc_aux,1).^2 + nanstd(t149_lc_aux,1).^2)';
clear t_149_lc_aux t149_lc_unc_aux i

% SS + LC
for i = 1:length(lat_sslc)
    t149_sslc_aux(i,:) = squeeze(t149_1930_2018(lon_sslc(i),lat_sslc(i),:));
    t149_sslc_unc_aux(i,:) = squeeze(t149_1930_2018_unc(lon_sslc(i),lat_sslc(i),:));
end
t149_sslc = nanmean(t149_sslc_aux,1)';
t149_sslc_unc = sqrt(nanmean(t149_sslc_unc_aux,1).^2 + nanstd(t149_sslc_aux,1).^2)';
clear t_149_sslc_aux t149_sslc_unc_aux i

% numbers for paper
nanmean(t149_sslc(1:120))% 1930s mean 7.3325
nanstd(t149_sslc(1:120))% 1930s std 0.8949
nanmean(t149_sslc(120+1:120*3))% 1940s-1950s mean 8.5931
nanstd(t149_sslc(120+1:120*3))% 1940s-1950s std 0.9221
nanmean(t149_sslc(120*3+1:120*4))% 1960s mean 7.7460
nanstd(t149_sslc(120*3+1:120*4))% 1960s std 0.9253
nanmean(t149_sslc(120*4+1:120*8))% 1970s-2000s mean 9.0755
nanstd(t149_sslc(120*4+1:120*8))% 1970s-2000s std 0.8392
nanmean(t149_sslc(120*4+1:120*5))% 1970s mean 9.1049
nanstd(t149_sslc(120*4+1:120*5))% 1970s std 0.0.7568
nanmean(t149_sslc(120*5+1:120*6))% 1980s mean 8.9779
nanstd(t149_sslc(120*5+1:120*6))% 1980s std 0.8340
nanmean(t149_sslc(120*6+1:120*7))% 1990s mean 8.9692
nanstd(t149_sslc(120*6+1:120*7))% 1990s std 0.8428
nanmean(t149_sslc(120*7+1:120*8))% 2000s mean 9.2500
nanstd(t149_sslc(120*7+1:120*8))% 2000s std 0.8966
nanmean(t149_sslc(120*8+1:end))% 2010s mean 10.6554
nanstd(t149_sslc(120*8+1:end))% 2010s std 0.6889

t149_sslc_yr = NaN(89,1);
for i = 1:89
    t149_sslc_yr(i,1) = nanmean(t149_sslc(i*12-11:i*12));
end
t149_sslc_yr_sort = NaN(89,2);
[t149_sslc_yr_sort(:,2),aux] = sort(t149_sslc_yr,'descend');
t149_sslc_yr_sort(:,1) = aux + 1929;
clear aux

% Plot T-S diagram (make it look nice)
for i = 1:length(year)-1
    S_series11(:,i) = gsw_SA_from_SP(S_series1(:,i),p_interp,-50.5,42.5);
    T_series11(:,i) = gsw_pt0_from_t(S_series11(:,i),T_series1(:,i),p_interp);
    s_lc_series11(:,i) = gsw_SA_from_SP(s_lc_series1(:,i),p_interp,-50.5,42.5);
    t_lc_series11(:,i) = gsw_pt0_from_t(s_lc_series11(:,i),t_lc_series1(:,i),p_interp);
    s_gs_series11(:,i) = gsw_SA_from_SP(s_gs_series1(:,i),p_interp,-50.5,42.5);
    t_gs_series11(:,i) = gsw_pt0_from_t(s_gs_series11(:,i),t_gs_series1(:,i),p_interp);
end
theta=T_series11(:);
s=S_series11(:);
smin=min(s)-0.01.*min(s);
smax=max(s)+0.03.*max(s);
thetamin=min(theta)-0.5*max(theta);
thetamax=max(theta)+0.8*max(theta);
xdim=round((smax-smin)./0.1+1);
ydim=round((thetamax-thetamin)+1);
dens=zeros(ydim,xdim);
thetai=((1:ydim)-1)*1+thetamin;
si=((1:xdim)-1)*0.1+smin;
disp(xdim);disp(ydim);
for j=1:ydim
    for i=1:xdim
        dens(j,i)=gsw_sigma0(si(i),thetai(j));
    end
end

% % smooth profiles
% t_tail_series_smooth = NaN(size(t_tail_series));
% s_tail_series_smooth = NaN(size(s_tail_series));
% for i = 4:12
%     t_tail_series_smooth(i,:) = smooth(p_interp,t_tail_series(i,:),0.15,'rloess');
%     s_tail_series_smooth(i,:) = smooth(p_interp,s_tail_series(i,:),0.15,'rloess');
% end

myscatter1 = varycolor(11);
myscatter2 = linspecer(11);

figure('Position', [100, 200, 600, 800])
subplot('Position',[0.08 0.38 0.88 0.58])
xlabel('Absolute Salinity','FontSize',14)
ylabel('Potential Temperature (^\circC)','FontSize',14)

hold on

for i=1:9
eval(['s',num2str(i),' = line(S_series11(p_interp>=25 & p_interp <=2000,i),T_series11(p_interp>=25 & p_interp <=2000,i),''LineWidth'',5);'])
eval(['s',num2str(i),'.Color = myscatter1(i+1,:);'])
%eval(['s',num2str(i),'.MarkerEdgeColor = myscatter2(i,:);'])
legendinfo{i} = [num2str(year(i))];
end

for i=1:9
eval(['s',num2str(i),' = scatter(S_series11(p_interp>=25 & p_interp <=2000,i),T_series11(p_interp>=25 & p_interp <=2000,i),50);'])
eval(['s',num2str(i),'.MarkerFaceColor = myscatter1(i+1,:);'])
eval(['s',num2str(i),'.MarkerEdgeColor = myscatter1(i+1,:);'])
%eval(['s',num2str(i),'.MarkerFaceAlpha = 0.4;'])
%eval(['s',num2str(i),'.MarkerEdgeAlpha = 0.4;'])
legendinfo{i} = [num2str(year(i))];
end

[c,h]=contour(si,thetai,dens,[27.68 27.68],'-k');
clabel(c,h,'LabelSpacing',500);
[c,h]=contour(si,thetai,dens,[27.80 27.80],'-k');
clabel(c,h,'LabelSpacing',500);
set(gca,'fontsize',14)
plot(nanmean(s_gs_series11(p_interp>=450 & p_interp <=2000,:),2),...
    nanmean(t_gs_series11(p_interp>=450 & p_interp <=2000,:),2),'color',myscatter2(11,:),'LineWidth',3)
plot(nanmean(s_lc_series11(p_interp>=50 & p_interp <=2000,:),2),...
    nanmean(t_lc_series11(p_interp>=50 & p_interp <=2000,:),2),'color',myscatter2(1,:),'LineWidth',3)
[c,h]=contour(si,thetai,dens,'LineStyle','REPLACE_WITH_DASH_DASH','color',[60/256,60/256,60/256]);
clabel(c,h,'LabelSpacing',450,'color',[60/256,60/256,60/256]);

legend(legendinfo,'location','southeast')
text(34.25,2,'Labrador Current','color',myscatter2(1,:),'Fontsize',14,'FontWeight','bold')
text(35.25,9.5,'Gulf','color',myscatter2(11,:),'Fontsize',14,'FontWeight','bold')
text(35.2,9,'Stream','color',myscatter2(11,:),'Fontsize',14,'FontWeight','bold')
ylim([1 10])
xlim([33.6 35.5])
box on

subplot('Position',[0.08 0.08 0.88 0.22])
hold on
fill([time_1930_2018;flipud(time_1930_2018)],...
    [(t149_sslc + t149_sslc_unc/2);flipud(t149_sslc - t149_sslc_unc/2)],...
    [120/256,120/256,120/256],'EdgeColor',[120/256,120/256,120/256],...
    'FaceAlpha',0.4,'EdgeAlpha',0.05)
plot(time_1930_2018,t149_sslc,'color','k','linewidth',1)
datetick('x','yyyy')
set(gca,'FontSize',14)
ylabel('Temperature (^\circC)')
xlabel('Time (year)')
%title('149-m Temperature (Scotian Shelf + Laurentian Channel)')
grid on
axis('tight')
ylim([4 14])
box on
set(gcf, 'Color', 'w')
saveas(gcf,[output_dir,'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_Figure4_pre2'],'epsc')

% Inset

figure('Position', [100, 200, 650, 400])
sp2 = subplot('Position',[0.15 0.165 0.805 0.8]);
axesm('MapProjection','eqdcylin','MapLatLimit',[36 50],'MapLonLimit',[-72 -45])
hold on
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-100 -100],'color',[.7 .7 .7],'linewidth',1)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-1000 -1000],'color',[.7 .7 .7],'linewidth',1)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-3000 -3000],'color',[.7 .7 .7],'linewidth',1)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-4000 -4000],'color',[.7 .7 .7],'linewidth',1)

%TGB
plotm([41 41],[-53.1 -47.9],'k','LineWidth',5)
plotm([44 44],[-53.1 -47.9],'k','LineWidth',5)
plotm([40.9 44.1],[-53 -53],'k','LineWidth',5)
plotm([40.9 44.1],[-48 -48],'k','LineWidth',5)
%LC
plotm([47 47],[-46.9 -48.1],'color',myscatter2(1,:),'LineWidth',5)
plotm([44 44],[-46.9 -48.1],'color',myscatter2(1,:),'LineWidth',5)
plotm([47.1 43.9],[-47 -47],'color',myscatter2(1,:),'LineWidth',5)
plotm([47.1 43.9],[-48 -48],'color',myscatter2(1,:),'LineWidth',5)
%GS
plotm([41 41],[-52.9 -56.1],'color',myscatter2(11,:),'LineWidth',5)
plotm([40 40],[-52.9 -56.1],'color',myscatter2(11,:),'LineWidth',5)
plotm([41.1 39.9],[-53 -53],'color',myscatter2(11,:),'LineWidth',5)
plotm([41.1 39.9],[-56 -56],'color',myscatter2(11,:),'LineWidth',5)

scatterm(lat_en4(lat_sslc)+0.5,lon_en4(lon_sslc)+0.5,50,'k','o','filled')
set(gca,'FontSize',14)
geoshow('GSHHS_i_L1.shp','FaceColor','k')%[.7 .7 .7])
plabel('PLabelLocation',5,'Fontsize',30)
mlabel('MLabelLocation',10,'MLabelParallel','south','Fontsize',30)
%title('Change Point of 150-m Deseasonalized Temperature (1993-2018)','fontsize',16)
framem
tightmap
set(gcf, 'Color', 'w')
saveas(gcf,[output_dir,'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_Figure4_inset_pre'],'epsc')

clearvars -except *_dir
close all

%% Supplemental Figure 1

% Set  directory to save data
data_dir = '/Users/afonso/Documents/Research/TGB/data/';
% Set directory to save figures and tables
output_dir = '/Users/afonso/Documents/Research/TGB/output/';

load([output_dir,'etopo1_TGB.mat'],'lat_z','lon_z','z')
load([output_dir,'SSH_TGB.mat'],'time_month','lat_ssh','lon_ssh','adt')

figure('Position', [100, 200, 800, 600])
axesm('MapProjection','eqdcylin','MapLatLimit',[30 60],'MapLonLimit',[-80 -40])
hold on
c1_aux = contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),[-1000 -1000],'k','linewidth',1);
linem([36 36],[360-75 360-47],'k')
linem([46 46],[360-75 360-47],'k')
linem([36 46],[360-75 360-75],'k')
linem([36 46],[360-47 360-47],'k')
geoshow('landareas.shp','FaceColor','k')%[.7 .7 .7])

close all

c1 = NaN(2,1);
j = 1;
for i = 2:length(c1_aux)
    if c1_aux(1,i)>=360-75 & c1_aux(1,i)<=360-47 & c1_aux(2,i)>=36 & c1_aux(2,i)<=46
        c1(:,j) = c1_aux(:,i);
        if j>1
            if abs(c1_aux(1,i)-c1(1,j-1))<0.2
                j = j+1;
            else
                c1(:,j) = NaN;
            end
        else
            j = j+1;
        end
    end
end
clear i j

if isnan(c1(1,end))
    c1 = c1(:,1:end-1);% lon,lat of 1000m isobath
end

c1(3,:) = zeros;
c1_dist = gsw_distance(c1(1,:),c1(2,:));
for i = 2:length(c1)
    c1(3,i) = sum(c1_dist(1:i-1));
end
clear c1_aux c1_dist i

% Lat and Lon for TGB, slope and shelf

lon_ssh2 = lon_ssh(lon_ssh>=360-75 & lon_ssh<=360-45);
lat_ssh2 = lat_ssh(lat_ssh>=36 & lat_ssh<=46);
[lon_ssh2_mesh,lat_ssh2_mesh] = meshgrid(lon_ssh2,lat_ssh2);

lon_z2 = lon_z(lon_z>=360-75 & lon_z<=360-45);
lat_z2 = lat_z(lat_z>=36 & lat_z<=46);
[lon_z2_mesh,lat_z2_mesh] = meshgrid(lon_z2,lat_z2);

z2 = z(lat_z>=36 & lat_z<=46,lon_z>=360-75 & lon_z<=360-45)';

% Define area at TGB between 3000m and 4000 isobaths (for time series)

[lon_mesh,lat_mesh] = meshgrid(lon_ssh,lat_ssh);

[lon_z_mesh,lat_z_mesh] = meshgrid(lon_z,lat_z);
lon_z_tgb = lon_z(lon_z>=360-51 & lon_z<=360-46);
lat_z_tgb = lat_z(lat_z>=39 & lat_z<=43);

z_ssh = interp2(lon_z_mesh,lat_z_mesh,z,lon_mesh,lat_mesh);
z_tgb = z_ssh(lat_ssh>=39 & lat_ssh<=43,lon_ssh>=360-51 & lon_ssh<=360-46);
[z_aux1,z_aux2] = find(z_tgb>=-4000 & z_tgb<=-3000);
z_aux3 = z_aux1+36;
z_aux4 = z_aux2+116;

% SLA at TGB

adt_TGB = nan(length(time_month),length(z_aux4));
for i=1:length(z_aux4)
    adt_TGB(:,i) = squeeze(adt(z_aux4(i),z_aux3(i),:));
end
adt_TGB2 = nanmean(adt_TGB,2);
adt_TGB2_lp = filtfilt(ones(12,1)/12,1,adt_TGB2(1:end-1));

% ADT time series

sla_TGB2_std = nanstd(adt_TGB2);
sla_TGB2_mean = nanmean(adt_TGB2);
sla2_TGB2 = adt_TGB2;%-sla_TGB2_mean;
sla2_TGB2_lp = filtfilt(ones(12,1)/12,1,sla2_TGB2(1:end-1));

slahigh = find(sla2_TGB2>(1.5*sla_TGB2_std));
slalow = find(sla2_TGB2<-(1.5*sla_TGB2_std));

% annual averages
sla2_TGB2_yr = NaN(26,1);
for i = 1:26
    sla2_TGB2_yr(i,1) = nanmean(sla2_TGB2(i*12-11:i*12));
end

% monthly averages
sla2_TGB2_mo = NaN(12,1);
for i = 1:12
    sla2_TGB2_mo(i,1) = nanmean(sla2_TGB2(i:12:16*12+i));
end

for i = 1:26
    sla2_TGB2_nomo(i*12-11:i*12) = sla2_TGB2(i*12-11:i*12) - sla2_TGB2_mo;
end

sla2_TGB2_nomo_mean = nanmean(sla2_TGB2_nomo);
sla2_TGB2_nomo_std = nanstd(sla2_TGB2_nomo);
sla2_TGB2_nomo = sla2_TGB2_nomo - sla2_TGB2_nomo_mean;
slahigh_nomo = find(sla2_TGB2_nomo>(1.5*(sla2_TGB2_nomo_std)));
slalow_nomo = find(sla2_TGB2_nomo<(1.5*(-sla2_TGB2_nomo_std)));
sla2_TGB2_nomo_lp = filtfilt(ones(12,1)/12,1,sla2_TGB2_nomo(1:end-1));
sla2_TGB2_std = nanstd(sla2_TGB2);

[ipt,ipt_res] = findchangepts(sla2_TGB2_nomo(1:end-1))

% TGB SSH increase: 0.1043 m
nanmean(sla2_TGB2_nomo(1:12*15))% -0.0409 m
nanmean(sla2_TGB2_nomo(12*16+1:end))% 0.0634 m
nanmean(sla2_TGB2_nomo(1:ipt))% -0.0417 m
nanmean(sla2_TGB2_nomo(ipt:end))% 0.0625 m

% Basin SSH increase: 0.0450
nanmean(nanmean(nanmean(adt(:,:,1:12*15),3)))% - 0.0066 m
nanmean(nanmean(nanmean(adt(:,:,12*16+1:end),3)))% 0.0384 m

csvwrite([output_dir,'SSH_TGB_1993-2018.csv'],sla2_TGB2_nomo')

% Histogram of SSH at TGB
sla2_TGB2_nomo_var = var(sla2_TGB2_nomo*100,'omitnan')
sum(sla2_TGB2_nomo<(nanmean(sla2_TGB2_nomo)-1.5*sla2_TGB2_nomo_std)) + ...
    sum(sla2_TGB2_nomo>(nanmean(sla2_TGB2_nomo)+1.5*sla2_TGB2_nomo_std))

sla2_TGB2_nomo_pre = sla2_TGB2_nomo(1:ipt-1);
sla2_TGB2_nomo_pre_var = var(sla2_TGB2_nomo_pre*100,'omitnan')%50.5265cm^2
sla2_TGB2_nomo_pre_std = nanstd(sla2_TGB2_nomo_pre*100)%7.1082 cm
sla2_TGB2_nomo_pre_mean = nanmean(sla2_TGB2_nomo_pre*100)%-4.1972 cm
sla2_TGB2_nomo_post = sla2_TGB2_nomo(ipt:end);
sla2_TGB2_nomo_post_var = var(sla2_TGB2_nomo_post*100,'omitnan')%63.6254 cm^2
sla2_TGB2_nomo_post_std = nanstd(sla2_TGB2_nomo_post*100)%7.9766 cm
sla2_TGB2_nomo_post_mean = nanmean(sla2_TGB2_nomo_post*100)%6.2454 cm
sla2_TGB2_nomo_pre_aux = [sla2_TGB2_nomo_pre,NaN(1,length(sla2_TGB2_nomo_post))];
sla2_TGB2_nomo_post_aux = [sla2_TGB2_nomo_post,NaN(1,length(sla2_TGB2_nomo_pre))];
100 * (sla2_TGB2_nomo_post_var - sla2_TGB2_nomo_pre_var)/sla2_TGB2_nomo_pre_var;%25.9249%
100 * (sla2_TGB2_nomo_post_std - sla2_TGB2_nomo_pre_std)/sla2_TGB2_nomo_pre_std;%12.2162%

aux1 = find(sla2_TGB2_nomo_pre_aux > (sla2_TGB2_nomo_pre_mean/100 - sla2_TGB2_nomo_pre_std/100)...
    & sla2_TGB2_nomo_pre_aux < (sla2_TGB2_nomo_pre_mean/100 + sla2_TGB2_nomo_pre_std/100))
aux2 = find(sla2_TGB2_nomo_pre_aux > (sla2_TGB2_nomo_pre_mean/100 - 2*sla2_TGB2_nomo_pre_std/100)...
    & sla2_TGB2_nomo_pre_aux < (sla2_TGB2_nomo_pre_mean/100 + 2*sla2_TGB2_nomo_pre_std/100))
aux3 = find(sla2_TGB2_nomo_pre_aux > (sla2_TGB2_nomo_pre_mean/100 - 3*sla2_TGB2_nomo_pre_std/100)...
    & sla2_TGB2_nomo_pre_aux < (sla2_TGB2_nomo_pre_mean/100 + 3*sla2_TGB2_nomo_pre_std/100))
100*length(aux1)/length(sla2_TGB2_nomo_pre)%67.7419%, should be 68% for normal distribution
100*length(aux2)/length(sla2_TGB2_nomo_pre)%95.6989%, should be 95% for normal distribution
100*length(aux3)/length(sla2_TGB2_nomo_pre)%98.9247%, should be 99.7% for normal distribution

aux4 = find(sla2_TGB2_nomo_post_aux > (sla2_TGB2_nomo_post_mean/100 - sla2_TGB2_nomo_post_std/100)...
    & sla2_TGB2_nomo_post_aux < (sla2_TGB2_nomo_post_mean/100 + sla2_TGB2_nomo_post_std/100))
aux5 = find(sla2_TGB2_nomo_post_aux > (sla2_TGB2_nomo_post_mean/100 - 2*sla2_TGB2_nomo_post_std/100)...
    & sla2_TGB2_nomo_post_aux < (sla2_TGB2_nomo_post_mean/100 + 2*sla2_TGB2_nomo_post_std/100))
aux6 = find(sla2_TGB2_nomo_post_aux > (sla2_TGB2_nomo_post_mean/100 - 3*sla2_TGB2_nomo_post_std/100)...
    & sla2_TGB2_nomo_post_aux < (sla2_TGB2_nomo_post_mean/100 + 3*sla2_TGB2_nomo_post_std/100))
100*length(aux4)/length(sla2_TGB2_nomo_post)%65.8730%, should be 68% for normal distribution
100*length(aux5)/length(sla2_TGB2_nomo_post)%95.2381%, should be 95% for normal distribution
100*length(aux6)/length(sla2_TGB2_nomo_post)%99.2063%, should be 99.7% for normal distribution

% Histogram of SSH at TGB (sla2_TGB2)
sla2_TGB2_var = var(sla2_TGB2*100,'omitnan')
sum(sla2_TGB2<(nanmean(sla2_TGB2)-1.5*sla2_TGB2_std)) + ...
    sum(sla2_TGB2>(nanmean(sla2_TGB2)+1.5*sla2_TGB2_std))

sla2_TGB2_pre = sla2_TGB2(1:ipt-1);
sla2_TGB2_pre_var = var(sla2_TGB2_pre*100,'omitnan')%50.5265cm^2
sla2_TGB2_pre_std = nanstd(sla2_TGB2_pre*100)%7.1082 cm
sla2_TGB2_pre_mean = nanmean(sla2_TGB2_pre*100)%-4.1972 cm
sla2_TGB2_post = sla2_TGB2(ipt:end);
sla2_TGB2_post_var = var(sla2_TGB2_post*100,'omitnan')%63.6254 cm^2
sla2_TGB2_post_std = nanstd(sla2_TGB2_post*100)%7.9766 cm
sla2_TGB2_post_mean = nanmean(sla2_TGB2_post*100)%6.2454 cm
sla2_TGB2_pre_aux = [sla2_TGB2_pre',NaN(1,length(sla2_TGB2_post))];
sla2_TGB2_post_aux = [sla2_TGB2_post',NaN(1,length(sla2_TGB2_pre))];
100 * (sla2_TGB2_post_var - sla2_TGB2_pre_var)/sla2_TGB2_pre_var;%25.9249%
100 * (sla2_TGB2_post_std - sla2_TGB2_pre_std)/sla2_TGB2_pre_std;%12.2162%

aux1 = find(sla2_TGB2_pre_aux > (sla2_TGB2_pre_mean/100 - sla2_TGB2_pre_std/100)...
    & sla2_TGB2_pre_aux < (sla2_TGB2_pre_mean/100 + sla2_TGB2_pre_std/100))
aux2 = find(sla2_TGB2_pre_aux > (sla2_TGB2_pre_mean/100 - 2*sla2_TGB2_pre_std/100)...
    & sla2_TGB2_pre_aux < (sla2_TGB2_pre_mean/100 + 2*sla2_TGB2_pre_std/100))
aux3 = find(sla2_TGB2_pre_aux > (sla2_TGB2_pre_mean/100 - 3*sla2_TGB2_pre_std/100)...
    & sla2_TGB2_pre_aux < (sla2_TGB2_pre_mean/100 + 3*sla2_TGB2_pre_std/100))
100*length(aux1)/length(sla2_TGB2_pre)%67.7419%, should be 68% for normal distribution
100*length(aux2)/length(sla2_TGB2_pre)%95.6989%, should be 95% for normal distribution
100*length(aux3)/length(sla2_TGB2_pre)%98.9247%, should be 99.7% for normal distribution

aux4 = find(sla2_TGB2_post_aux > (sla2_TGB2_post_mean/100 - sla2_TGB2_post_std/100)...
    & sla2_TGB2_post_aux < (sla2_TGB2_post_mean/100 + sla2_TGB2_post_std/100))
aux5 = find(sla2_TGB2_post_aux > (sla2_TGB2_post_mean/100 - 2*sla2_TGB2_post_std/100)...
    & sla2_TGB2_post_aux < (sla2_TGB2_post_mean/100 + 2*sla2_TGB2_post_std/100))
aux6 = find(sla2_TGB2_post_aux > (sla2_TGB2_post_mean/100 - 3*sla2_TGB2_post_std/100)...
    & sla2_TGB2_post_aux < (sla2_TGB2_post_mean/100 + 3*sla2_TGB2_post_std/100))
100*length(aux4)/length(sla2_TGB2_post)%65.8730%, should be 68% for normal distribution
100*length(aux5)/length(sla2_TGB2_post)%95.2381%, should be 95% for normal distribution
100*length(aux6)/length(sla2_TGB2_post)%99.2063%, should be 99.7% for normal distribution

% SSH fit
sla2_fit_aux = readtable('SSH.Fit.csv', 'HeaderLines',1);
sla2_fit = table2array(sla2_fit_aux);
clear sla2_fit_aux
sla2_fit_std = nanstd(sla2_fit);

% Histogram of SSH at TGB (sla2_fit)
sla2_fit_var = var(sla2_fit*100,'omitnan')
sum(sla2_fit<(nanmean(sla2_fit)-1.5*sla2_fit_std)) + ...
    sum(sla2_fit>(nanmean(sla2_fit)+1.5*sla2_fit_std))

sla2_fit_pre = sla2_fit(1:ipt-1,4);
sla2_fit_pre_var = var(sla2_fit_pre*100,'omitnan')%54.0897cm^2
sla2_fit_pre_std = nanstd(sla2_fit_pre*100)%7.3546 cm
sla2_fit_pre_mean = nanmean(sla2_fit_pre*100)%-10.4645 cm
sla2_fit_post = sla2_fit(ipt:end,4);
sla2_fit_post_var = var(sla2_fit_post*100,'omitnan')%52.4571 cm^2
sla2_fit_post_std = nanstd(sla2_fit_post*100)%7.2427 cm
sla2_fit_post_mean = nanmean(sla2_fit_post*100)%0.3160 cm
sla2_fit_pre_aux = [sla2_fit_pre',NaN(1,length(sla2_fit_post))];
sla2_fit_post_aux = [sla2_fit_post',NaN(1,length(sla2_fit_pre))];
100 * (sla2_fit_post_var - sla2_fit_pre_var)/sla2_fit_pre_var%25.9249%
100 * (sla2_fit_post_std - sla2_fit_pre_std)/sla2_fit_pre_std%12.2162%

aux1 = find(sla2_fit_pre_aux > (sla2_fit_pre_mean/100 - sla2_fit_pre_std/100)...
    & sla2_fit_pre_aux < (sla2_fit_pre_mean/100 + sla2_fit_pre_std/100))
aux2 = find(sla2_fit_pre_aux > (sla2_fit_pre_mean/100 - 2*sla2_fit_pre_std/100)...
    & sla2_fit_pre_aux < (sla2_fit_pre_mean/100 + 2*sla2_fit_pre_std/100))
aux3 = find(sla2_fit_pre_aux > (sla2_fit_pre_mean/100 - 3*sla2_fit_pre_std/100)...
    & sla2_fit_pre_aux < (sla2_fit_pre_mean/100 + 3*sla2_fit_pre_std/100))
100*length(aux1)/length(sla2_fit_pre)%67.7419%, should be 68% for normal distribution
100*length(aux2)/length(sla2_fit_pre)%95.6989%, should be 95% for normal distribution
100*length(aux3)/length(sla2_fit_pre)%98.9247%, should be 99.7% for normal distribution

aux4 = find(sla2_fit_post_aux > (sla2_fit_post_mean/100 - sla2_fit_post_std/100)...
    & sla2_fit_post_aux < (sla2_fit_post_mean/100 + sla2_fit_post_std/100))
aux5 = find(sla2_fit_post_aux > (sla2_fit_post_mean/100 - 2*sla2_fit_post_std/100)...
    & sla2_fit_post_aux < (sla2_fit_post_mean/100 + 2*sla2_fit_post_std/100))
aux6 = find(sla2_fit_post_aux > (sla2_fit_post_mean/100 - 3*sla2_fit_post_std/100)...
    & sla2_fit_post_aux < (sla2_fit_post_mean/100 + 3*sla2_fit_post_std/100))
100*length(aux4)/length(sla2_fit_post)%65.8730%, should be 68% for normal distribution
100*length(aux5)/length(sla2_fit_post)%95.2381%, should be 95% for normal distribution
100*length(aux6)/length(sla2_fit_post)%99.2063%, should be 99.7% for normal distribution

% ACF
acf_aux = readtable('SSH_ACF.csv', 'HeaderLines',1);
acf = table2array(acf_aux);
clear acf_aux


figure('Position', [100, 200, 800, 600])
subplot('Position',[0.09 0.57 0.86 0.4])
hold on
% histogram(sla2_TGB2_pre_aux*100,[-35:1:35],'normalization','pdf',...
%     'facecolor',rgb('SteelBlue'),'edgecolor','w','facealpha',0.2)
% histogram(sla2_TGB2_post_aux*100,[-35:1:35],'normalization','pdf',...
%     'facecolor',rgb('DarkRed'),'edgecolor','w','facealpha',0.2)
histogram(sla2_fit_pre_aux*100,[-35:1:25],'normalization','pdf',...
    'facecolor',rgb('SteelBlue'),'edgecolor','w','facealpha',0.2)
histogram(sla2_fit_post_aux*100,[-35:1:25],'normalization','pdf',...
    'facecolor',rgb('DarkRed'),'edgecolor','w','facealpha',0.2)

%plot([nanmean(sla2_TGB2_nomo)*100-1.5*sla2_TGB2_nomo_std*100 ...
%    nanmean(sla2_TGB2_nomo)*100-1.5*sla2_TGB2_nomo_std*100],[0 0.04],'REPLACE_WITH_DASH_DASHk','linewidth',2)
%plot([nanmean(sla2_TGB2_nomo)*100+1.5*sla2_TGB2_nomo_std*100 ...
%    nanmean(sla2_TGB2_nomo)*100+1.5*sla2_TGB2_nomo_std*100],[0 0.04],'REPLACE_WITH_DASH_DASHk','linewidth',2)

%y = -25:1:25;
% f_pre = exp(-(y-sla2_TGB2_nomo_pre_mean).^2./(2*sla2_TGB2_nomo_pre_std^2))./(sla2_TGB2_nomo_pre_std*sqrt(2*pi));
% plot(y,f_pre*length(sla2_TGB2_nomo_pre)/length(sla2_TGB2_nomo_pre_aux),'color',rgb('SteelBlue'),'LineWidth',1.5)
% f_post = exp(-(y-sla2_TGB2_nomo_post_mean).^2./(2*sla2_TGB2_nomo_post_std^2))./(sla2_TGB2_nomo_post_std*sqrt(2*pi));
% plot(y,f_post*length(sla2_TGB2_nomo_post)/length(sla2_TGB2_nomo_post_aux),'color',rgb('DarkRed'),'LineWidth',1.5)
% y = -30:1:30;
% f_pre = exp(-(y-sla2_TGB2_pre_mean).^2./(2*sla2_TGB2_pre_std^2))./(sla2_TGB2_pre_std*sqrt(2*pi));
% plot(y,f_pre*length(sla2_TGB2_pre)/length(sla2_TGB2_pre_aux),'color',rgb('SteelBlue'),'LineWidth',1.5)
% f_post = exp(-(y-sla2_TGB2_post_mean).^2./(2*sla2_TGB2_post_std^2))./(sla2_TGB2_post_std*sqrt(2*pi));
% plot(y,f_post*length(sla2_TGB2_post)/length(sla2_TGB2_post_aux),'color',rgb('DarkRed'),'LineWidth',1.5)
% y = -30:1:20;
% f_pre = exp(-(y-sla2_fit_pre_mean).^2./(2*sla2_fit_pre_std^2))./(sla2_fit_pre_std*sqrt(2*pi));
% plot(y,f_pre*length(sla2_fit_pre)/length(sla2_fit_pre_aux),'color',rgb('SteelBlue'),'LineWidth',1.5)
% f_post = exp(-(y-sla2_fit_post_mean).^2./(2*sla2_fit_post_std^2))./(sla2_fit_post_std*sqrt(2*pi));
% plot(y,f_post*length(sla2_fit_post)/length(sla2_fit_post_aux),'color',rgb('DarkRed'),'LineWidth',1.5)
%[f_pre,y_pre,bw_pre] = ksdensity(sla2_fit_pre);
%[f_post,y_post,bw_post] = ksdensity(sla2_fit_post);
%plot(y_pre*100,(f_pre/100)*length(sla2_fit_pre)/length(sla2_fit_pre_aux),'color',rgb('SteelBlue'),'LineWidth',1.5)
%plot(y_post*100,(f_post/100)*length(sla2_fit_post)/length(sla2_fit_post_aux),'color',rgb('DarkRed'),'LineWidth',1.5)


set(gca,'fontsize',14')
ytix = get(gca, 'YTick');
set(gca, 'YTick',ytix, 'YTickLabel',ytix*100)
%ylim([0 0.04])
%xlim([-25 25])
ylim([0 0.04])
xlim([-30 20])
xlabel('Sea Surface Height Anomaly (cm)')
ylabel('Probability (%)')
grid
%axis('tight')
box on

subplot('Position',[0.09 0.09 0.86 0.4])
hold on
bar(acf(1:25,1),acf(1:25,2),0.02,...
    'facecolor',rgb('MidnightBlue'),'edgecolor',rgb('MidnightBlue'),'facealpha',1)
scatter(acf(1:25,1),acf(1:25,2),40,'filled',...
    'MarkerFaceColor',rgb('MidnightBlue'),'MarkerEdgeColor','w','MarkerFaceAlpha',1)
set(gca,'FontSize',14,'xtick',[0,6,12,18,24])
grid on
xlabel('Lag (months)')
ylabel('Autocorrelation Function')
box on
set(gcf, 'Color', 'w')

saveas(gcf,[output_dir,'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_SupplementalFigure1_pre2'],'epsc')

clearvars -except *_dir
close all

%% Supplemental Figure 2

% Set  directory to save data
data_dir = '/Users/afonso/Documents/Research/TGB/data/';
% Set directory to save figures and tables
output_dir = '/Users/afonso/Documents/Research/TGB/output/';

load([output_dir,'etopo1_TGB.mat'],'lat_z','lon_z','z')
load([output_dir,'SSH_TGB.mat'],'time_month','lat_ssh','lon_ssh','u_g','v_g')

figure('Position', [100, 200, 800, 600])
axesm('MapProjection','eqdcylin','MapLatLimit',[30 60],'MapLonLimit',[-80 -40])
hold on
c1_aux = contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),[-1000 -1000],'k','linewidth',1);
linem([36 36],[360-75 360-47],'k')
linem([46 46],[360-75 360-47],'k')
linem([36 46],[360-75 360-75],'k')
linem([36 46],[360-47 360-47],'k')
geoshow('landareas.shp','FaceColor','k')%[.7 .7 .7])

close all

c1 = NaN(2,1);
j = 1;
for i = 2:length(c1_aux)
    if c1_aux(1,i)>=360-75 & c1_aux(1,i)<=360-47 & c1_aux(2,i)>=36 & c1_aux(2,i)<=46
        c1(:,j) = c1_aux(:,i);
        if j>1
            if abs(c1_aux(1,i)-c1(1,j-1))<0.2
                j = j+1;
            else
                c1(:,j) = NaN;
            end
        else
            j = j+1;
        end
    end
end
clear i j

if isnan(c1(1,end))
    c1 = c1(:,1:end-1);% lon,lat of 1000m isobath
end

c1(3,:) = zeros;
c1_dist = gsw_distance(c1(1,:),c1(2,:));
for i = 2:length(c1)
    c1(3,i) = sum(c1_dist(1:i-1));
end
clear c1_aux c1_dist i

% Lat and Lon for TGB, slope and shelf

lon_ssh2 = lon_ssh(lon_ssh>=360-75 & lon_ssh<=360-45);
lat_ssh2 = lat_ssh(lat_ssh>=36 & lat_ssh<=46);
[lon_ssh2_mesh,lat_ssh2_mesh] = meshgrid(lon_ssh2,lat_ssh2);

lon_z2 = lon_z(lon_z>=360-75 & lon_z<=360-45);
lat_z2 = lat_z(lat_z>=36 & lat_z<=46);
[lon_z2_mesh,lat_z2_mesh] = meshgrid(lon_z2,lat_z2);

z2 = z(lat_z>=36 & lat_z<=46,lon_z>=360-75 & lon_z<=360-45)';

% Define velocity on different isobaths

[lon_mesh lat_mesh] = meshgrid(lon_ssh,lat_ssh);

u_z = NaN(length(lat_z2),length(lon_z2),size(u_g,3));
v_z = NaN(length(lat_z2),length(lon_z2),size(v_g,3));

for t = 1:length(time_month)
    u_z(:,:,t) = interp2(lon_mesh,lat_mesh,u_g(:,:,t)',lon_z2_mesh,lat_z2_mesh);
    v_z(:,:,t) = interp2(lon_mesh,lat_mesh,v_g(:,:,t)',lon_z2_mesh,lat_z2_mesh);
end

% 1000m 
u_1 = NaN(length(c1),length(time_month));
v_1 = NaN(length(c1),length(time_month));

for t = 1:length(time_month)
    u_1(:,t) = interp2(lon_z2_mesh,lat_z2_mesh,u_z(:,:,t),c1(1,:),c1(2,:));
    v_1(:,t) = interp2(lon_z2_mesh,lat_z2_mesh,v_z(:,:,t),c1(1,:),c1(2,:));
end

clear u_z v_z z2 lon_z2* lat_z2* lon_ssh2* lat_ssh2* u_g v_g t

% Rotating velocities

% magnitude of input vector
uv_in = sqrt(u_1.^2 + v_1.^2);

cross_1 = NaN(size(u_1,1)-1,size(u_1,2));
along_1 = NaN(size(u_1,1)-1,size(u_1,2));
cross_1_u = NaN(size(u_1,1)-1,size(u_1,2));
cross_1_v = NaN(size(u_1,1)-1,size(u_1,2));
along_1_u = NaN(size(u_1,1)-1,size(u_1,2));
along_1_v = NaN(size(u_1,1)-1,size(u_1,2));
cross_1_anom = NaN(size(u_1,1)-1,size(u_1,2));
along_1_anom = NaN(size(u_1,1)-1,size(u_1,2));

for t = 1:length(time_month)-1
    for i = 1:size(c1,2)-1
                
        % direction of input vector (angle relative to north, increases clockwise)
        if u_1(i,t) >= 0 & v_1(i,t) >= 0
            theta_in = atand(u_1(i,t)/v_1(i,t));
            %theta_in_aux = theta_in
        elseif u_1(i,t) >= 0 & v_1(i,t) < 0
            theta_in = 180 + atand(u_1(i,t)/v_1(i,t));
            %theta_in_aux = theta_in - 90
        elseif u_1(i,t) < 0 & v_1(i,t) < 0
            theta_in = 180 + atand(u_1(i,t)/v_1(i,t));
            %theta_in_aux = theta_in - 180
        elseif u_1(i,t) < 0 & v_1(i,t) >= 0
            theta_in = 360 + atand(u_1(i,t)/v_1(i,t));
            %theta_in_aux = theta_in - 270
        end
        
        % direction of speed (angle relative to north, increases clockwise)
        if (c1(2,i+1)-c1(2,i)) >= 0 & (c1(1,i+1)-c1(1,i)) >= 0
            theta_rot = atand((c1(1,i+1)-c1(1,i))/(c1(2,i+1)-c1(2,i)));
            %theta_rot_aux = 90 - theta_rot
        elseif (c1(2,i+1)-c1(2,i)) < 0 & (c1(1,i+1)-c1(1,i)) >= 0
            theta_rot = 180 + atand((c1(1,i+1)-c1(1,i))/(c1(2,i+1)-c1(2,i)));
            %theta_rot_aux = 180 - theta_rot
        elseif (c1(2,i+1)-c1(2,i)) < 0 & (c1(1,i+1)-c1(1,i)) < 0
            theta_rot = 180 + atand((c1(1,i+1)-c1(1,i))/(c1(2,i+1)-c1(2,i)));
            %theta_rot_aux = 270 - theta_rot
        elseif (c1(2,i+1)-c1(2,i)) >= 0 & (c1(1,i+1)-c1(1,i)) < 0
            theta_rot = 360 + atand((c1(1,i+1)-c1(1,i))/(c1(2,i+1)-c1(2,i)));
            %theta_rot_aux = 360 - theta_rot
        end
        
        % direction of speed relative to the new coordinate system
        if theta_in > theta_rot
            theta_out = theta_in - theta_rot;
        else
            theta_out = 360 - theta_rot + theta_in;
        end
        
        
        cross_1(i,t) = uv_in(i,t) * sind(theta_out);
        along_1(i,t) = uv_in(i,t) * cosd(theta_out);
        uv_out = sqrt(along_1.^2 + cross_1.^2);
        
        along_1_u(i,t) = along_1(i,t) * sind(theta_rot);
        along_1_v(i,t) = along_1(i,t) * cosd(theta_rot);
        
        if theta_rot + 90 > 360
            cross_1_u(i,t) = cross_1(i,t) * sind(theta_rot-270);
            cross_1_v(i,t) = cross_1(i,t) * cosd(theta_rot-270);
        else
            cross_1_u(i,t) = cross_1(i,t) * sind(theta_rot+90);
            cross_1_v(i,t) = cross_1(i,t) * cosd(theta_rot+90);
        end
        clear theta*
    end
end
clear i t

% Calculate anomalies

for i = 1:size(c1,2)-1
    along_1_anom(i,:) = along_1(i,:) - nanmean(along_1(i,:));
    cross_1_anom(i,:) = cross_1(i,:) - nanmean(cross_1(i,:));
end

% Remove seasonality

% calculate monthly averages
along_1_mo = NaN(size(along_1,1),12);
cross_1_mo = NaN(size(along_1,1),12);
for j = 1:size(along_1,1)
    for i = 1:12
        along_1_mo(j,i) = nanmean(along_1(j,i:12:25*12+i));
        cross_1_mo(j,i) = nanmean(cross_1(j,i:12:25*12+i));
    end
end

% remove monthly averages
along_1_nomo = NaN(size(along_1));
cross_1_nomo = NaN(size(along_1));
for j = 1:size(along_1,1)
    for i = 1:26
        along_1_nomo(j,i*12-11:i*12) = along_1(j,i*12-11:i*12) - along_1_mo(j,:);
        cross_1_nomo(j,i*12-11:i*12) = cross_1(j,i*12-11:i*12) - cross_1_mo(j,:);
    end
end

% Calculate lagged correlations (deseasonalized)

along_nomo_corrlag = NaN(size(along_1_nomo,1)-40,61);
along_nomo_p = NaN(size(along_1_nomo,1)-40,61);
along_nomo_pl = NaN(size(along_1_nomo,1)-40,61);
along_nomo_pu = NaN(size(along_1_nomo,1)-40,61);
for i = 41:size(along_1,1)
    for l = 0:60
        [aux_corr,aux_p,aux_pl,aux_pu] = corrcoef(along_1_nomo(41,1:end-1-l),along_1_nomo(i,1+l:end-1));
        along_nomo_corrlag(i-40,l+1) = aux_corr(1,2);
        along_nomo_p(i-40,l+1) = aux_p(1,2);
        along_nomo_pl(i-40,l+1) = aux_pl(1,2);
        along_nomo_pu(i-40,l+1) = aux_pu(1,2);
        clear aux_corr aux_p aux_pl aux_pu
    end
end

along_nomo_corrlag = NaN(size(along_1_nomo,1),61);
along_nomo_p = NaN(size(along_1_nomo,1),61);
along_nomo_pl = NaN(size(along_1_nomo,1),61);
along_nomo_pu = NaN(size(along_1_nomo,1),61);
for i = 1:size(along_1,1)
    for l = -12:48
        if l>=0
            [aux_corr,aux_p,aux_pl,aux_pu] = corrcoef(along_1_nomo(41,1:end-1-l),along_1_nomo(i,1+l:end-1));
        else
            [aux_corr,aux_p,aux_pl,aux_pu] = corrcoef(along_1_nomo(41,1-l:end-1),along_1_nomo(i,1:end-1+l));
        end
        along_nomo_corrlag(i,l+13) = aux_corr(1,2);
        along_nomo_p(i,l+13) = aux_p(1,2);
        along_nomo_pl(i,l+13) = aux_pl(1,2);
        along_nomo_pu(i,l+13) = aux_pu(1,2);
        clear aux_corr aux_p aux_pl aux_pu
    end
end

% u_g_mean = nanmean(u_g,3);
% v_g_mean = nanmean(v_g,3);
% u_g_neg = u_g_mean;
% u_g_neg(u_g_mean>0) = NaN;
% v_g_neg = v_g_mean;
% v_g_neg(u_g_mean>0) = NaN;
% u_g_pos = u_g_mean;
% u_g_pos(u_g_mean<=0) = NaN;
% v_g_pos = v_g_mean;
% v_g_pos(u_g_mean<=0) = NaN;

figure('Position', [100, 200, 800, 400])
subplot('Position',[0.08 0.08 0.88 0.88])
axesm('MapProjection','eqdcylin','MapLatLimit',[35 47],'MapLonLimit',[-76 -46],'MLineLocation',2,'PLineLocation',2)
hold on
q1 = quivermc([c1(2,1:5:end);c1(2,1:5:end)+10],...
    [c1(1,1:5:end);c1(1,1:5:end)],...
    [u_1(1:5:end,1)';zeros(size(c1(2,1:5:end)))],...
    [v_1(1:5:end,1)';zeros(size(c1(2,1:5:end)))],...
    'reference',10,'arrowstyle','tail');%,'density',100/10);
set(q1,'LineWidth',0.5,'Color',rgb('Black'))%,'MaxHeadSize',0.5)
q2 = quivermc([c1(2,1:5:end);c1(2,1:5:end)+10],...
    [c1(1,1:5:end);c1(1,1:5:end)],...
    [along_1_u(1:5:end,1)';zeros(size(c1(2,1:5:end)))],...
    [along_1_v(1:5:end,1)';zeros(size(c1(2,1:5:end)))],...
    'reference',10,'arrowstyle','tail');%,'density',100/10);
set(q2,'LineWidth',0.5,'Color',rgb('DarkRed'))%,'MaxHeadSize',0.5)
q3 = quivermc([c1(2,1:5:end);c1(2,1:5:end)+10],...
    [c1(1,1:5:end);c1(1,1:5:end)],...
    [cross_1_u(1:5:end,1)';zeros(size(c1(2,1:5:end)))],...
    [cross_1_v(1:5:end,1)';zeros(size(c1(2,1:5:end)))],...
    'reference',10,'arrowstyle','tail');%,'density',100/10);
set(q3,'LineWidth',0.5,'Color',rgb('MidnightBlue'))%,'MaxHeadSize',0.5)
%quiverm(c1(2,1:5:end),c1(1,1:5:end),v_1(1:5:end,1)',u_1(1:5:end,1)','k')
%quiverm(c1(2,1:5:end-1),c1(1,1:5:end-1),along_1_v(1:5:end,1)',along_1_u(1:5:end,1)','r')
%quiverm(c1(2,1:5:end-1),c1(1,1:5:end-1),cross_1_v(1:5:end,1)',cross_1_u(1:5:end,1)','b')
q5 = quivermc([39.5 49.5;59.5 69.5],[-59.9 -69.9;-79.9 -89.9],...
    [0 0;0 0],[6 0;0 0],'reference',6,'arrowstyle','tail');
set(q5,'LineWidth',0.5,'Color',rgb('Black'))
q6 = quivermc([38.75 49.5;59.5 69.5],[-59.9 -69.9;-79.9 -89.9],...
    [0 0;0 0],[6 0;0 0],'reference',6,'arrowstyle','tail');
set(q6,'LineWidth',0.5,'Color',rgb('DarkRed'))
q7 = quivermc([38 49.5;59.5 69.5],[-59.9 -69.9;-79.9 -89.9],...
    [0 0;0 0],[6 0;0 0],'reference',6,'arrowstyle','tail');
set(q6,'LineWidth',0.5,'Color',rgb('MidnightBlue'))
%quiverm(39.5,-59.9,0,2,'Color',rgb('Black'))
%quiverm(38.75,-59.9,0,2,'Color',rgb('DarkRed'))
%quiverm(38,-59.9,0,2,'Color',rgb('MidnightBlue'))
textm(39.5,-57.7,'Mean Speed','color',rgb('Black'),'fontsize',18)
textm(38.75,-57.7,'Along-slope component','color',rgb('DarkRed'),'fontsize',18)
textm(38,-57.7,'Cross-slope component','color',rgb('MidnightBlue'),'fontsize',18)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-100 -100],'color',[200/256 200/256 200/256],'linewidth',1)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-1000 -1000],'color',[200/256 200/256 200/256],'linewidth',1)
geoshow('GSHHS_i_L1.shp','FaceColor','k')
%f1 = fillm([37,41,41,37],[-79.7,-79.7,-73.5,-73.5],'w');
%f1.FaceColor = 'w';
%f1.EdgeColor = 'w';
%f1.FaceAlpha = 0.75;
%f1.EdgeAlpha = 1;
q4 = quivermc([36.3 36.3;35 36],[-72 -69;-72 -60],[2 0; 0 0],[0 0; 0 0],...
    'reference',10,'arrowstyle','tail');
set(q4,'LineWidth',2,'Color',rgb('Black'))%,'MaxHeadSize',0.5)
textm(36.45,-70.7,'2 cm s^{-1}','Color',rgb('Black'),'FontSize',18)%,'Fontweight','bold')
plabel('PLabelLocation',2,'fontsize',14)
mlabel('MLabelLocation',4,'MLabelParallel','south')
gridm
tightmap
set(gcf, 'Color', 'w')

saveas(gcf,[output_dir,'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_SupplementalFigure2_pre_revised'],'epsc')

clearvars -except *_dir
close all

%% Supplemental Figure 3

% Set  directory to save data
data_dir = '/Users/afonso/Documents/Research/TGB/data/';
% Set directory to save figures and tables
output_dir = '/Users/afonso/Documents/Research/TGB/output/';

%T2 = readtable('Z149mat2.xlsx','TreatAsEmpty',["NA"]);
T = readtable('Z149mat22.csv', 'HeaderLines',1);
T1 = table2array(T);
T1(T1==0) = NaN;
T149_change_point = NaN(1,1271);
T149_change = NaN(1,1271);
for j = 1:1271
    if sum(~isnan(T1(:,j))) >= 1
        T149_change_point(1,j) = find(~isnan(T1(:,j)));
        T149_change(1,j) = T1(T149_change_point(1,j),j);
    end
end
%     aux = T1(:,j);
%     aux1 = ~isnan(T1(:,j))
%     for i = 1:264
%         aux = ~isnan(T1(i,j));
%         %aux = strcmp(T1(i,j),{'NA'});
%         if aux==0
%             T149_change_point(1,j) = i;
%             T149_change(1,j) = T1(i,j);
%         end
%     end
% end

T149_change_reshape = reshape(T149_change,41,31);
T149_change_point_reshape = reshape(T149_change_point,41,31);

% Set window to Jan/2009 to Dec/2011
T149_change_reshape_20092011 = T149_change_reshape;
T149_change_reshape_20092011(T149_change_point_reshape<193 | T149_change_point_reshape>228) = NaN;
T149_change_point_reshape_20092011 = T149_change_point_reshape;
T149_change_point_reshape_20092011(T149_change_point_reshape<193 | T149_change_point_reshape>228) = NaN;

% Set window to Apr/2009 to Jun/2009
T149_change_reshape_2009 = T149_change_reshape;
T149_change_reshape_2009(T149_change_point_reshape<196 | T149_change_point_reshape>198) = NaN;
T149_change_point_reshape_2009 = T149_change_point_reshape;
T149_change_point_reshape_2009(T149_change_point_reshape<196 | T149_change_point_reshape>198) = NaN;


load([output_dir,'etopo1_TGB.mat'],'lat_z','lon_z','z')
%load([output_dir,'SSH_TGB.mat'],'time_month','lat_ssh','lon_ssh','u_g','v_g')
load([data_dir,'en4_NWA2.mat'],'t_en4','t_unc_en4','lon_en4','lat_en4','time_en4','depth_en4')
time_ssh = time_en4(93*12+1:end-9);
t_en4 = t_en4 - 273.15;

figure('Position', [100, 200, 800, 600])
sp2 = subplot('Position',[0.08 0.08 0.88 0.88]);
axesm('MapProjection','eqdcylin','MapLatLimit',[33 50],'MapLonLimit',[-77 -48])
hold on
%t_diff = t10002000_en4_2009_2018' - t10002000_en4_2001_2007';
pcolorm(lat_en4,lon_en4,T149_change_reshape_20092011')
shading flat
caxis([min(min(T149_change_reshape_20092011)) max(max(T149_change_reshape_20092011))])
colormap(sp2,cmocean('balance',8,'pivot',0))
%h = colorbar;
caxis([-1.5 2.5])
%ylabel(h,'Time of Change Point','Fontsize',14)
%set(h,'Fontsize',14,'ytick',[193;199;205;211;217;223],'yticklabel',[datestr(time_ssh(193),'mmmyy');datestr(time_ssh(199),'mmmyy');datestr(time_ssh(205),'mmmyy');datestr(time_ssh(211),'mmmyy');datestr(time_ssh(217),'mmmyy');datestr(time_ssh(223),'mmmyy')])
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-100 -100],'color',[.7 .7 .7],'linewidth',1)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-1000 -1000],'color',[.7 .7 .7],'linewidth',1)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-3000 -3000],'color',[.7 .7 .7],'linewidth',1)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-4000 -4000],'color',[.7 .7 .7],'linewidth',1)
fillm([33.1,33.1,36.2,36.2],[-65,-48.1,-48.1,-65],'facecolor','w','edgecolor','w')
c = colorbar('Orientation','Horizontal','Position',[0.51 0.22 0.32 0.048],'Color','k','Fontsize',10);%colorbar over land
c.Label.String = 'T_{149m} Change (\circC)';
set(c,'Fontsize',16)
%set(c,'Fontsize',14,'Fontweight','bold','ytick',[193;211;229],'yticklabel',[datestr(time_ssh(193),'mmmyy');datestr(time_ssh(211),'mmmyy');datestr(time_ssh(229),'mmmyy')])
linem([44.5 46],[360-56.3 360-57.8],':w','linewidth',3)
linem([41.6 42.6],[360-65 360-67],':w','linewidth',3)
linem([41 41.9],[360-69 360-69],':k','linewidth',3)
linem([40.4 41],[360-69 360-69],':w','linewidth',3)
textm(46.5,360-58.5,'LCh','color','w','Fontsize',16,'Fontweight','bold')
textm(43,360-67,'NECh','color','w','Fontsize',16,'Fontweight','bold')
textm(40.5,360-71.3,'GSCh','color','w','Fontsize',16,'Fontweight','bold')
textm(35,360-75.3,'CH','color','w','Fontsize',16,'Fontweight','bold')
set(gca,'FontSize',14)
geoshow('GSHHS_i_L1.shp','FaceColor','k')%[.7 .7 .7])
plabel('PLabelLocation',5,'Fontsize',14)
mlabel('MLabelLocation',5,'MLabelParallel','south','Fontsize',14)
%title('Change Point of 150-m Deseasonalized Temperature (1993-2018)','fontsize',16)
framem
tightmap
set(gcf, 'Color', 'w')

saveas(gcf,[output_dir,'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_SupplementalFigure3_pre'],'epsc')

clearvars -except *_dir
close all

%% Supplemental Figure 4

% Set  directory to save data
data_dir = '/Users/afonso/Documents/Research/TGB/data/';
% Set directory to save figures and tables
output_dir = '/Users/afonso/Documents/Research/TGB/output/';

load([data_dir,'EN4_profiles_TGB_AMJ_dec_postQC.mat'])

% Create structure with all profiles
decade = 1930:10:2010;
k = 1;
for i = 1:9
    disp(num2str(decade(i)))
    for j = 1:eval(['length(EN4_profiles_TGB_AMJ_dec.d',num2str(decade(i)),'.lat)'])
        eval(['tail_EN4(k).Latitude = EN4_profiles_TGB_AMJ_dec.d',num2str(decade(i)),'.lat(j);'])
        eval(['tail_EN4(k).Longitude = EN4_profiles_TGB_AMJ_dec.d',num2str(decade(i)),'.lon(j);'])
        eval(['tail_EN4(k).Time = EN4_profiles_TGB_AMJ_dec.d',num2str(decade(i)),'.time(j);'])
        eval(['tail_EN4(k).Pressure = EN4_profiles_TGB_AMJ_dec.d',num2str(decade(i)),'.depth(:,j);'])
        eval(['tail_EN4(k).Temperature = EN4_profiles_TGB_AMJ_dec.d',num2str(decade(i)),'.temperature(:,j);'])
        eval(['tail_EN4(k).Salinity = EN4_profiles_TGB_AMJ_dec.d',num2str(decade(i)),'.salinity(:,j);'])
        k = k + 1;
    end
end
clear EN4* i j k 

p_interp = [0:5:100,125:25:250,300:50:1500,1550:250:2050]';%in the manuscript as of Jun 9, 2020
year = 1930:10:2020;

% Average profiles over depths determined in p_interp (only 5,153 valid
% profiles)
tail_EN4_1 = tail_EN4(1);
k_yes = 0;
k_no = 0;
for i = 1:length(tail_EN4)
    if sum(isnan(tail_EN4(i).Temperature)) == length(tail_EN4(i).Temperature)
        k_no = k_no + 1;
    elseif ~isempty(find(diff(tail_EN4(i).Pressure)<=0,1))
        k_no = k_no + 1;
    else
        k_yes = k_yes + 1;
        tail_EN4_1(k_yes).Latitude = tail_EN4(i).Latitude;
        tail_EN4_1(k_yes).Longitude = tail_EN4(i).Longitude;
        tail_EN4_1(k_yes).Time = tail_EN4(i).Time;
        tail_EN4_1(k_yes).Pressure = p_interp;
        tail_EN4_1(k_yes).Temperature = interp1(tail_EN4(i).Pressure(~isnan(tail_EN4(i).Pressure)),tail_EN4(i).Temperature(~isnan(tail_EN4(i).Pressure)),p_interp);
        tail_EN4_1(k_yes).Salinity = interp1(tail_EN4(i).Pressure(~isnan(tail_EN4(i).Pressure)),tail_EN4(i).Salinity(~isnan(tail_EN4(i).Pressure)),p_interp);
    end
end
clear p_interp s_tail_series t_tail_series tail_EN4 i k_no decade

% Load ETOPO1
%ncdisp('/Users/afonso/Documents/Data/ETOPO1_Bed_g_gmt4.grd')
x = ncread('/Users/afonso/Google Drive/Data/ETOPO1_Bed_g_gmt4.grd','x');
lon_z = x(x<=(320-360) & x>=(280-360)); 
lon_z = lon_z+360;
y = ncread('/Users/afonso/Google Drive/Data/ETOPO1_Bed_g_gmt4.grd','y');
lat_z = y(y<=60 & y>=30); 
z_aux = ncread('/Users/afonso/Google Drive/Data/ETOPO1_Bed_g_gmt4.grd','z');
z = z_aux(x<=(320-360) & x>=(280-360),y<=60 & y>=30); z = z';
%z = z(8:15:end-7,8:15:end-8);
clear x y z_aux

plotcolor = linspecer(3);

pos_9panel = [0.08,0.7,0.27,0.27;...
    0.39,0.7,0.27,0.27;...
    0.70,0.7,0.27,0.27;...
    0.08,0.39,0.27,0.27;...
    0.39,0.39,0.27,0.27;...
    0.70,0.39,0.27,0.27;...
    0.08,0.08,0.27,0.27;...
    0.39,0.08,0.27,0.27;...
    0.70,0.08,0.27,0.27];

% Color-coded by year
figure('Position', [100, 200, 1100, 700])
%subplot('Position',[0.06 0.15 0.88 0.78])
for i = 1:length(year)-1
    %subplot(3,3,i-3)
    subplot('Position',pos_9panel(i,:))
    axesm('MapProjection','eqdcylin','MapLatLimit',[41 44],'MapLonLimit',[-53 -48])
    hold on
    contourm(lat_z(1:2:end),lon_z(1:2:end),z(1:2:end,1:2:end),...
        [-100 -100],'color',[.7 .7 .7],'linewidth',1)
    contourm(lat_z(1:2:end),lon_z(1:2:end),z(1:2:end,1:2:end),...
        [-1000 -1000],'color',[.7 .7 .7],'linewidth',1)
    contourm(lat_z(1:2:end),lon_z(1:2:end),z(1:2:end,1:2:end),...
        [-3000 -3000],'color',[.7 .7 .7],'linewidth',1)
    contourm(lat_z(1:2:end),lon_z(1:2:end),z(1:2:end,1:2:end),...
        [-4000 -4000],'color',[.7 .7 .7],'linewidth',1)
    profile_aux1 = find([tail_EN4_1.Time] >= datenum([num2str(year(i)),'0101'],'yyyymmdd') & ...
        [tail_EN4_1.Time] < datenum([num2str(year(i+1)),'0101'],'yyyymmdd') & ...
        str2num(datestr([tail_EN4_1.Time],'mm'))' == 4);
    profile_aux2 = find([tail_EN4_1.Time] >= datenum([num2str(year(i)),'0101'],'yyyymmdd') & ...
        [tail_EN4_1.Time] < datenum([num2str(year(i+1)),'0101'],'yyyymmdd') & ...
        str2num(datestr([tail_EN4_1.Time],'mm'))' == 5);
    profile_aux3 = find([tail_EN4_1.Time] >= datenum([num2str(year(i)),'0101'],'yyyymmdd') & ...
        [tail_EN4_1.Time] < datenum([num2str(year(i+1)),'0101'],'yyyymmdd') & ...
        str2num(datestr([tail_EN4_1.Time],'mm'))' == 6);
    lat_aux1 = [tail_EN4_1(profile_aux1).Latitude];
    lat_aux2 = [tail_EN4_1(profile_aux2).Latitude];
    lat_aux3 = [tail_EN4_1(profile_aux3).Latitude];
    lon_aux1 = [tail_EN4_1(profile_aux1).Longitude];
    lon_aux2 = [tail_EN4_1(profile_aux2).Longitude];
    lon_aux3 = [tail_EN4_1(profile_aux3).Longitude];
    count_profiles = length(lat_aux1) + length(lat_aux2) + length(lat_aux3);
    scatterm(lat_aux1,lon_aux1,20,plotcolor(1,:),'filled')
    scatterm(lat_aux2,lon_aux2,20,plotcolor(2,:),'filled')
    scatterm(lat_aux3,lon_aux3,20,plotcolor(3,:),'filled')
%     for j = 1:10
%         scatter(
%         eval(['scatterm(EN4_profiles_TGB.y',num2str(decade(i)+j-1),'.m04.lat,EN4_profiles_TGB.y',num2str(decade(i)+j-1),'.m04.lon,20,plotcolor(1,:),''filled'')'])
%         eval(['scatterm(EN4_profiles_TGB.y',num2str(decade(i)+j-1),'.m05.lat,EN4_profiles_TGB.y',num2str(decade(i)+j-1),'.m05.lon,20,plotcolor(2,:),''filled'')'])
%         eval(['scatterm(EN4_profiles_TGB.y',num2str(decade(i)+j-1),'.m06.lat,EN4_profiles_TGB.y',num2str(decade(i)+j-1),'.m06.lon,20,plotcolor(3,:),''filled'')'])
%         eval(['count_profiles = count_profiles + length(EN4_profiles_TGB.y',num2str(decade(i)+j-1),'.m04.lat);'])
%         eval(['count_profiles = count_profiles + length(EN4_profiles_TGB.y',num2str(decade(i)+j-1),'.m05.lat);'])
%         eval(['count_profiles = count_profiles + length(EN4_profiles_TGB.y',num2str(decade(i)+j-1),'.m06.lat);'])
%     end
    set(gca,'FontSize',16)
    title([num2str(year(i)),'s: ',num2str(count_profiles),' profiles'])
    %geoshow('GSHHS_l_L1.shp','FaceColor','k')
    if i == 1 | i == 4 | i == 7
    plabel('PLabelLocation',1,'Fontsize',16)
    else
        plabel('off')
    end
    if i == 7 | i == 8 | i == 9
        mlabel('MLabelLocation',2,'MLabelParallel','south','Fontsize',16)
    else
        mlabel('off')
    end
    %title('Change Point of 150-m Deseasonalized Temperature (1993-2018)','fontsize',16)
    framem
    tightmap
    set(gcf, 'Color', 'w')
    clear *aux* count_profiles
end
clear i plotcolor

saveas(gcf,[output_dir,'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_SupplementalFigure4_pre'],'epsc')

clearvars -except *_dir
close all

%% Supplemental Figure 5

% Set  directory to save data
data_dir = '/Users/afonso/Documents/Research/TGB/data/';
% Set directory to save figures and tables
output_dir = '/Users/afonso/Documents/Research/TGB/output/';

load([output_dir,'etopo1_TGB.mat'],'lat_z','lon_z','z')
load([data_dir,'en4_NWA2.mat'],'lon_en4','lat_en4','time_en4','depth_en4')
time_ssh = time_en4(93*12+1:end-9);

% T122 from Joe
T = readtable('Z122mat2.csv', 'HeaderLines',0);
T1 = table2array(T);
T1(T1==0) = NaN;
T122_change_point = NaN(1,1271);
T122_change = NaN(1,1271);
for j = 1:1271
    if sum(~isnan(T1(:,j))) >= 1
        T122_change_point(1,j) = find(~isnan(T1(:,j)));
        T122_change(1,j) = T1(T122_change_point(1,j),j);
    end
end
T122_change_reshape = reshape(T122_change,41,31);
T122_change_point_reshape = reshape(T122_change_point,41,31);
clear T T1 j

% T135 from Joe
T = readtable('Z135mat2.csv', 'HeaderLines',0);
T1 = table2array(T);
T1(T1==0) = NaN;
T135_change_point = NaN(1,1271);
T135_change = NaN(1,1271);
for j = 1:1271
    if sum(~isnan(T1(:,j))) >= 1
        T135_change_point(1,j) = find(~isnan(T1(:,j)));
        T135_change(1,j) = T1(T135_change_point(1,j),j);
    end
end
T135_change_reshape = reshape(T135_change,41,31);
T135_change_point_reshape = reshape(T135_change_point,41,31);
clear T T1 j

% T166 from Joe
T = readtable('Z166mat2.csv', 'HeaderLines',0);
T1 = table2array(T);
T1(T1==0) = NaN;
T166_change_point = NaN(1,1271);
T166_change = NaN(1,1271);
for j = 1:1271
    if sum(~isnan(T1(:,j))) >= 1
        T166_change_point(1,j) = find(~isnan(T1(:,j)));
        T166_change(1,j) = T1(T166_change_point(1,j),j);
    end
end
T166_change_reshape = reshape(T166_change,41,31);
T166_change_point_reshape = reshape(T166_change_point,41,31);
clear T T1 j

% T185 from Joe
T = readtable('Z185mat2.csv', 'HeaderLines',0);
T1 = table2array(T);
T1(T1==0) = NaN;
T185_change_point = NaN(1,1271);
T185_change = NaN(1,1271);
for j = 1:1271
    if sum(~isnan(T1(:,j))) >= 1
        T185_change_point(1,j) = find(~isnan(T1(:,j)));
        T185_change(1,j) = T1(T185_change_point(1,j),j);
    end
end
T185_change_reshape = reshape(T185_change,41,31);
T185_change_point_reshape = reshape(T185_change_point,41,31);
clear T T1 j

% Set window to Jan/2009 to Dec/2011
T122_change_reshape_20092011 = T122_change_reshape;
T122_change_reshape_20092011(T122_change_point_reshape<193 | T122_change_point_reshape>228) = NaN;
T122_change_point_reshape_20092011 = T122_change_point_reshape;
T122_change_point_reshape_20092011(T122_change_point_reshape<193 | T122_change_point_reshape>228) = NaN;
T135_change_reshape_20092011 = T135_change_reshape;
T135_change_reshape_20092011(T135_change_point_reshape<193 | T135_change_point_reshape>228) = NaN;
T135_change_point_reshape_20092011 = T135_change_point_reshape;
T135_change_point_reshape_20092011(T135_change_point_reshape<193 | T135_change_point_reshape>228) = NaN;
T166_change_reshape_20092011 = T166_change_reshape;
T166_change_reshape_20092011(T166_change_point_reshape<193 | T166_change_point_reshape>228) = NaN;
T166_change_point_reshape_20092011 = T166_change_point_reshape;
T166_change_point_reshape_20092011(T166_change_point_reshape<193 | T166_change_point_reshape>228) = NaN;
T185_change_reshape_20092011 = T185_change_reshape;
T185_change_reshape_20092011(T185_change_point_reshape<193 | T185_change_point_reshape>228) = NaN;
T185_change_point_reshape_20092011 = T185_change_point_reshape;
T185_change_point_reshape_20092011(T185_change_point_reshape<193 | T185_change_point_reshape>228) = NaN;
% Create negative value outside of the plotted area to avoid crashing because pivot=0
T185_change_reshape_20092011(end,end) = -0.5;

figure('Position', [100, 200, 600, 650])
% 122-m change point
sp1 = subplot('Position',[0.08 0.79 0.4 0.19]);
axesm('MapProjection','eqdcylin','MapLatLimit',[33 50],'MapLonLimit',[-77 -48])
hold on
pcolorm(lat_en4,lon_en4,T122_change_point_reshape_20092011')
shading flat
colormap(sp1,crameri('nuuk',12))
caxis([193 229])
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-100 -100],'color',[.7 .7 .7],'linewidth',1)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-1000 -1000],'color',[.7 .7 .7],'linewidth',1)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-3000 -3000],'color',[.7 .7 .7],'linewidth',1)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-4000 -4000],'color',[.7 .7 .7],'linewidth',1)
fillm([33.1,33.1,36.2,36.2],[-65,-48.1,-48.1,-65],'facecolor','w','edgecolor','w')
textm(45,-75,'122 m','FontSize',12,'FontWeight','Bold','Color','w')
c = colorbar('Orientation','Horizontal','Position',[0.08 0.07 0.4 0.02],'Color','k','Fontsize',10);%colorbar over land
c.Label.String = 'T Change Point';
set(c,'Fontsize',12,'ytick',[193;211;229],'yticklabel',[datestr(time_ssh(193),'mmmyy');datestr(time_ssh(211),'mmmyy');datestr(time_ssh(229),'mmmyy')])
set(gca,'FontSize',12)
geoshow('GSHHS_i_L1.shp','FaceColor','k')%[.7 .7 .7])
plabel('PLabelLocation',5,'Fontsize',12,'FontColor','k')
mlabel('MLabelLocation',100,'MLabelParallel','south','Fontsize',12,'FontColor','k')
framem
tightmap

% 122-m T change
sp2 = subplot('Position',[0.56 0.79 0.4 0.19]);
axesm('MapProjection','eqdcylin','MapLatLimit',[33 50],'MapLonLimit',[-77 -48])
hold on
%t_diff = t10002000_en4_2009_2018' - t10002000_en4_2001_2007';
pcolorm(lat_en4,lon_en4,T122_change_reshape_20092011')
shading flat
colormap(sp2,cmocean('balance',8,'pivot',0))
caxis([-1.5 2.5])
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-100 -100],'color',[.7 .7 .7],'linewidth',1)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-1000 -1000],'color',[.7 .7 .7],'linewidth',1)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-3000 -3000],'color',[.7 .7 .7],'linewidth',1)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-4000 -4000],'color',[.7 .7 .7],'linewidth',1)
fillm([33.1,33.1,36.2,36.2],[-65,-48.1,-48.1,-65],'facecolor','w','edgecolor','w')
textm(45,-75,'122 m','FontSize',12,'FontWeight','Bold','Color','w')
c = colorbar('Orientation','Horizontal','Position',[0.56 0.07 0.4 0.02],'Color','k','Fontsize',10);%colorbar over land
c.Label.String = 'T Change (\circC)';
set(c,'Fontsize',12)
set(gca,'FontSize',12)
geoshow('GSHHS_i_L1.shp','FaceColor','k')%[.7 .7 .7])
plabel('PLabelLocation',100,'Fontsize',12,'FontColor','k')
mlabel('MLabelLocation',100,'MLabelParallel','south','Fontsize',12,'FontColor','k')
framem
tightmap

% 135-m change point
sp1 = subplot('Position',[0.08 0.58 0.4 0.19]);
axesm('MapProjection','eqdcylin','MapLatLimit',[33 50],'MapLonLimit',[-77 -48])
hold on
pcolorm(lat_en4,lon_en4,T135_change_point_reshape_20092011')
shading flat
colormap(sp1,crameri('nuuk',12))
caxis([193 229])
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-100 -100],'color',[.7 .7 .7],'linewidth',1)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-1000 -1000],'color',[.7 .7 .7],'linewidth',1)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-3000 -3000],'color',[.7 .7 .7],'linewidth',1)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-4000 -4000],'color',[.7 .7 .7],'linewidth',1)
fillm([33.1,33.1,36.2,36.2],[-65,-48.1,-48.1,-65],'facecolor','w','edgecolor','w')
textm(45,-75,'135 m','FontSize',12,'FontWeight','Bold','Color','w')
% c = colorbar('Orientation','Horizontal','Position',[0.08 0.07 0.4 0.02],'Color','k','Fontsize',10);%colorbar over land
% c.Label.String = 'T_{150m} Change Point';
% set(c,'Fontsize',12,'ytick',[193;211;229],'yticklabel',[datestr(time_ssh(193),'mmmyy');datestr(time_ssh(211),'mmmyy');datestr(time_ssh(229),'mmmyy')])
set(gca,'FontSize',12)
geoshow('GSHHS_i_L1.shp','FaceColor','k')%[.7 .7 .7])
plabel('PLabelLocation',5,'Fontsize',12)
mlabel('MLabelLocation',100,'MLabelParallel','south','Fontsize',12,'FontColor','k')
framem
tightmap

% 135-m T change
sp2 = subplot('Position',[0.56 0.58 0.4 0.19]);
axesm('MapProjection','eqdcylin','MapLatLimit',[33 50],'MapLonLimit',[-77 -48])
hold on
pcolorm(lat_en4,lon_en4,T135_change_reshape_20092011')
shading flat
colormap(sp2,cmocean('balance',8,'pivot',0))
caxis([-1.5 2.5])
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-100 -100],'color',[.7 .7 .7],'linewidth',1)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-1000 -1000],'color',[.7 .7 .7],'linewidth',1)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-3000 -3000],'color',[.7 .7 .7],'linewidth',1)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-4000 -4000],'color',[.7 .7 .7],'linewidth',1)
fillm([33.1,33.1,36.2,36.2],[-65,-48.1,-48.1,-65],'facecolor','w','edgecolor','w')
textm(45,-75,'135 m','FontSize',12,'FontWeight','Bold','Color','w')
% c = colorbar('Orientation','Horizontal','Position',[0.56 0.07 0.4 0.02],'Color','k','Fontsize',10);%colorbar over land
% c.Label.String = 'T_{150m} Change (\circC)';
% set(c,'Fontsize',12)
set(gca,'FontSize',12)
geoshow('GSHHS_i_L1.shp','FaceColor','k')%[.7 .7 .7])
plabel('PLabelLocation',100,'Fontsize',12,'FontColor','k')
mlabel('MLabelLocation',100,'MLabelParallel','south','Fontsize',12,'FontColor','k')
framem
tightmap

% 166-m change point
sp1 = subplot('Position',[0.08 0.37 0.4 0.19]);
axesm('MapProjection','eqdcylin','MapLatLimit',[33 50],'MapLonLimit',[-77 -48])
hold on
pcolorm(lat_en4,lon_en4,T166_change_point_reshape_20092011')
shading flat
colormap(sp1,crameri('nuuk',12))
caxis([193 229])
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-100 -100],'color',[.7 .7 .7],'linewidth',1)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-1000 -1000],'color',[.7 .7 .7],'linewidth',1)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-3000 -3000],'color',[.7 .7 .7],'linewidth',1)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-4000 -4000],'color',[.7 .7 .7],'linewidth',1)
fillm([33.1,33.1,36.2,36.2],[-65,-48.1,-48.1,-65],'facecolor','w','edgecolor','w')
textm(45,-75,'166 m','FontSize',12,'FontWeight','Bold','Color','w')
% c = colorbar('Orientation','Horizontal','Position',[0.08 0.07 0.4 0.02],'Color','k','Fontsize',10);%colorbar over land
% c.Label.String = 'T_{150m} Change Point';
% set(c,'Fontsize',12,'ytick',[193;211;229],'yticklabel',[datestr(time_ssh(193),'mmmyy');datestr(time_ssh(211),'mmmyy');datestr(time_ssh(229),'mmmyy')])
set(gca,'FontSize',12)
geoshow('GSHHS_i_L1.shp','FaceColor','k')%[.7 .7 .7])
plabel('PLabelLocation',5,'Fontsize',12)
mlabel('MLabelLocation',100,'MLabelParallel','south','Fontsize',12,'FontColor','k')
framem
tightmap

% 166-m T change
sp2 = subplot('Position',[0.56 0.37 0.4 0.19]);
axesm('MapProjection','eqdcylin','MapLatLimit',[33 50],'MapLonLimit',[-77 -48])
hold on
pcolorm(lat_en4,lon_en4,T166_change_reshape_20092011')
shading flat
colormap(sp2,cmocean('balance',8,'pivot',0))
caxis([-1.5 2.5])
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-100 -100],'color',[.7 .7 .7],'linewidth',1)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-1000 -1000],'color',[.7 .7 .7],'linewidth',1)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-3000 -3000],'color',[.7 .7 .7],'linewidth',1)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-4000 -4000],'color',[.7 .7 .7],'linewidth',1)
fillm([33.1,33.1,36.2,36.2],[-65,-48.1,-48.1,-65],'facecolor','w','edgecolor','w')
textm(45,-75,'166 m','FontSize',12,'FontWeight','Bold','Color','w')
% c = colorbar('Orientation','Horizontal','Position',[0.56 0.07 0.4 0.02],'Color','k','Fontsize',10);%colorbar over land
% c.Label.String = 'T_{150m} Change (\circC)';
% set(c,'Fontsize',12)
set(gca,'FontSize',12)
geoshow('GSHHS_i_L1.shp','FaceColor','k')%[.7 .7 .7])
plabel('PLabelLocation',100,'Fontsize',12,'FontColor','k')
mlabel('MLabelLocation',100,'MLabelParallel','south','Fontsize',12,'FontColor','k')
framem
tightmap
set(gcf, 'Color', 'w')

% 185-m change point
sp1 = subplot('Position',[0.08 0.16 0.4 0.19]);
axesm('MapProjection','eqdcylin','MapLatLimit',[33 50],'MapLonLimit',[-77 -48])
hold on
pcolorm(lat_en4,lon_en4,T185_change_point_reshape_20092011')
shading flat
colormap(sp1,crameri('nuuk',12))
caxis([193 229])
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-100 -100],'color',[.7 .7 .7],'linewidth',1)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-1000 -1000],'color',[.7 .7 .7],'linewidth',1)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-3000 -3000],'color',[.7 .7 .7],'linewidth',1)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-4000 -4000],'color',[.7 .7 .7],'linewidth',1)
fillm([33.1,33.1,36.2,36.2],[-65,-48.1,-48.1,-65],'facecolor','w','edgecolor','w')
textm(45,-75,'185 m','FontSize',12,'FontWeight','Bold','Color','w')
% c = colorbar('Orientation','Horizontal','Position',[0.08 0.07 0.4 0.02],'Color','k','Fontsize',10);%colorbar over land
% c.Label.String = 'T_{150m} Change Point';
% set(c,'Fontsize',12,'ytick',[193;211;229],'yticklabel',[datestr(time_ssh(193),'mmmyy');datestr(time_ssh(211),'mmmyy');datestr(time_ssh(229),'mmmyy')])
set(gca,'FontSize',12)
geoshow('GSHHS_i_L1.shp','FaceColor','k')%[.7 .7 .7])
plabel('PLabelLocation',5,'Fontsize',12)
mlabel('MLabelLocation',10,'MLabelParallel','south','Fontsize',12,'FontColor','k')
framem
tightmap

% 185-m T change
sp2 = subplot('Position',[0.56 0.16 0.4 0.19]);
axesm('MapProjection','eqdcylin','MapLatLimit',[33 50],'MapLonLimit',[-77 -48])
hold on
pcolorm(lat_en4,lon_en4,T185_change_reshape_20092011')
shading flat
colormap(sp2,cmocean('balance',8,'pivot',0))
caxis([-1.5 2.5])
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-100 -100],'color',[.7 .7 .7],'linewidth',1)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-1000 -1000],'color',[.7 .7 .7],'linewidth',1)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-3000 -3000],'color',[.7 .7 .7],'linewidth',1)
contourm(lat_z(1:5:end),lon_z(1:5:end),z(1:5:end,1:5:end),[-4000 -4000],'color',[.7 .7 .7],'linewidth',1)
fillm([33.1,33.1,36.2,36.2],[-65,-48.1,-48.1,-65],'facecolor','w','edgecolor','w')
textm(45,-75,'185 m','FontSize',12,'FontWeight','Bold','Color','w')
% c = colorbar('Orientation','Horizontal','Position',[0.56 0.07 0.4 0.02],'Color','k','Fontsize',10);%colorbar over land
% c.Label.String = 'T_{150m} Change (\circC)';
% set(c,'Fontsize',12)
set(gca,'FontSize',12)
geoshow('GSHHS_i_L1.shp','FaceColor','k')%[.7 .7 .7])
plabel('PLabelLocation',100,'Fontsize',12,'FontColor','k')
mlabel('MLabelLocation',10,'MLabelParallel','south','Fontsize',12,'FontColor','k')
framem
tightmap

saveas(gcf,[output_dir,'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_SupplementalFigure5_pre'],'epsc')

clearvars -except *_dir
close all

%% Supplementary Figure 6

% Set  directory to save data
data_dir = '/Users/afonso/Documents/Research/TGB/data/';
% Set directory to save figures and tables
output_dir = '/Users/afonso/Documents/Research/TGB/output/';

load([data_dir,'EN4_profiles_TGB_AMJ_dec_postQC_T_only.mat'])

% Load ETOPO1
%ncdisp('/Users/afonso/Documents/Data/ETOPO1_Bed_g_gmt4.grd')
x = ncread('/Users/afonso/Google Drive/Data/ETOPO1_Bed_g_gmt4.grd','x');
lon_z = x(x<=(320-360) & x>=(280-360)); 
y = ncread('/Users/afonso/Google Drive/Data/ETOPO1_Bed_g_gmt4.grd','y');
lat_z = y(y<=60 & y>=30); 
z_aux = ncread('/Users/afonso/Google Drive/Data/ETOPO1_Bed_g_gmt4.grd','z');
z = z_aux(x<=(320-360) & x>=(280-360),y<=60 & y>=30); z = z';
clear x y z_aux

% Create structure with all profiles
decade = 1930:10:2010;
k = 1;
for i = 1:9
    disp(num2str(decade(i)))
    for j = 1:eval(['length(EN4_profiles_TGB_AMJ_dec.d',num2str(decade(i)),'.lat)'])
        eval(['tail_EN4(k).Latitude = EN4_profiles_TGB_AMJ_dec.d',num2str(decade(i)),'.lat(j);'])
        eval(['tail_EN4(k).Longitude = EN4_profiles_TGB_AMJ_dec.d',num2str(decade(i)),'.lon(j);'])
        eval(['tail_EN4(k).Time = EN4_profiles_TGB_AMJ_dec.d',num2str(decade(i)),'.time(j);'])
        eval(['tail_EN4(k).Pressure = EN4_profiles_TGB_AMJ_dec.d',num2str(decade(i)),'.depth(:,j);'])
        eval(['tail_EN4(k).Temperature = EN4_profiles_TGB_AMJ_dec.d',num2str(decade(i)),'.temperature(:,j);'])
        eval(['tail_EN4(k).Salinity = EN4_profiles_TGB_AMJ_dec.d',num2str(decade(i)),'.salinity(:,j);'])
        k = k + 1;
    end
end
clear EN4* i j k 

% Vertical levels to inpterpolate
p_interp = [350]';%in the manuscript as of Jun 9, 2020
% Isopycnals to interpolate
%d_interp = [26.5;27;27.25;27.5];

% Define spatial and temporal boundaries and deltas
lat_n = 44;
lat_s = 41;
lat_delta = 0.5;
lon_w = -53;
lon_e = -48;
lon_delta = 1;
lat_box = lat_s:lat_delta:lat_n;
lon_box = lon_w:lon_delta:lon_e;
year = 1930:10:2020;
time_delta = 10;%year

% Average profiles over depths determined in p_interp (only 5,153 valid
% profiles)
tail_EN4_1 = tail_EN4(1);
k_yes = 0;
k_no = 0;
for i = 1:length(tail_EN4)
    if sum(isnan(tail_EN4(i).Temperature)) == length(tail_EN4(i).Temperature)
        k_no = k_no + 1;
    elseif sum(isnan(tail_EN4(i).Temperature)) + 1 == length(tail_EN4(i).Temperature)
        k_no = k_no + 1;    
    elseif ~isempty(find(diff(tail_EN4(i).Pressure)<=0,1))
        k_no = k_no + 1;
    else
        k_yes = k_yes + 1;
        tail_EN4_1(k_yes).Latitude = tail_EN4(i).Latitude;
        tail_EN4_1(k_yes).Longitude = tail_EN4(i).Longitude;
        tail_EN4_1(k_yes).Time = tail_EN4(i).Time;
        tail_EN4_1(k_yes).Pressure = p_interp;
        tail_EN4_1(k_yes).Temperature = interp1(tail_EN4(i).Pressure(~isnan(tail_EN4(i).Temperature)),tail_EN4(i).Temperature(~isnan(tail_EN4(i).Temperature)),p_interp);
        tail_EN4_1(k_yes).Salinity = interp1(tail_EN4(i).Pressure(~isnan(tail_EN4(i).Temperature)),tail_EN4(i).Salinity(~isnan(tail_EN4(i).Temperature)),p_interp);           
%         s_abs = gsw_SA_from_SP(tail_EN4_1(k_yes).Salinity,tail_EN4_1(k_yes).Pressure,...
%             tail_EN4_1(k_yes).Latitude,tail_EN4_1(k_yes).Longitude);
%         t_cons = gsw_CT_from_t(s_abs,tail_EN4_1(k_yes).Temperature,tail_EN4_1(k_yes).Pressure);
%         tail_EN4_1(k_yes).Sigmatheta = gsw_sigma0(s_abs,t_cons);
%         if sum(isnan(tail_EN4_1(k_yes).Temperature)) == length(tail_EN4_1(k_yes).Temperature) | ...
%                 sum(isnan(tail_EN4_1(k_yes).Temperature)) + 1 == length(tail_EN4_1(k_yes).Temperature)
%             tail_EN4_1(k_yes).T_dens = NaN(length(d_interp),1);
%             tail_EN4_1(k_yes).S_dens = NaN(length(d_interp),1);
%             tail_EN4_1(k_yes).P_dens = NaN(length(d_interp),1);
%         else
%             tail_EN4_1(k_yes).T_dens = interp1(tail_EN4_1(k_yes).Sigmatheta(~isnan(s_abs)),...
%                 tail_EN4_1(k_yes).Temperature(~isnan(s_abs)),d_interp);
%             tail_EN4_1(k_yes).S_dens = interp1(tail_EN4_1(k_yes).Sigmatheta(~isnan(s_abs)),...
%                 tail_EN4_1(k_yes).Salinity(~isnan(s_abs)),d_interp);
%             tail_EN4_1(k_yes).P_dens = interp1(tail_EN4_1(k_yes).Sigmatheta(~isnan(s_abs)),...
%                 tail_EN4_1(k_yes).Pressure(~isnan(s_abs)),d_interp);
%         end
%         clear s_abs t_cons
    end
end

% Load bathymetry data needed for computing effective distance
indla = lat_z>=40.98 & lat_z<=44.01;
indlo = lon_z>=-53 & lon_z<=-48;
bathy = z(indla,indlo);

% Define position of profiles
xpos = [tail_EN4_1.Longitude];
ypos = [tail_EN4_1.Latitude];

% Define center of squared boxes
for i = 1:length(lon_box)-1
    ggx1(i) = mean(lon_box(i:i+1));
end
for j = 1:length(lat_box)-1
    ggy1(j) = mean(lat_box(j:j+1));
end
[ggx ggy] = meshgrid(ggx1,ggy1); 
clear i j 

% Meshgrid of the bathymetry.
[xBathy,yBathy] = meshgrid(lon_z(lon_z>=-53 & lon_z<=-48),lat_z(lat_z>=40.98 & lat_z<=44.01));

% Vector of the bathymetry at every data point location.
bathyi = interp2(xBathy,yBathy,bathy,xpos,ypos);
bathtarget = interp2(xBathy,yBathy,bathy,ggx,ggy);

% Define Lamda as in Lavender et al. 2005, equation 3
lambda = 1000;

% Loop on every data point. I try to give a grid point location to every
% data point.  Assign grid point based on effective distance criterion from
% equation 3, Lavender et al 2005
for i = 1:length(tail_EN4_1)  %This loops on every float profile
    
    % Compute the distance (to find nearest points) on the initial square grid 
    dist2 = (xpos(i)-ggx).^2 + (ypos(i)-ggy).^2;  %here xpos(i), ypos(i) is the float profile position and ggx, ggy are the grid cell centers for a standard x,y grid
    
    % Put distances in a vector and sort it.
    dist2vec = reshape(dist2,size(dist2,1)*size(dist2,2),1);
    dist2sorted = sort(dist2vec);
    
    % Find the 9 nearest grid cell centers to the individual float profile (this is a time-saving step, so you don't have to find the effective distance to every point in a big grid)
    mindists = dist2sorted(1:9);
    
    dist2mvec = zeros(length(mindists),1);
    hdist2 = zeros(length(mindists),1);
    deff2vec = zeros(length(mindists),1);
    ind = zeros(length(mindists),1);
    
    % Loop on these 9 nearest points.
    for minindex = 1:length(mindists)
        % Find the index of the current point.
        ind(minindex) = find(dist2 == mindists(minindex),1);
        
        % Find the real distance in meters. Square it.
        dist2mvec(minindex) = gsw_distance([xpos(i) ggx(ind(minindex))],[ypos(i) ggy(ind(minindex))]);
        %dist2mvec(minindex) = distance(ypos(i),xpos(i),ggy(ind(minindex)),ggx(ind(minindex)));
        %(greatCircleDistance(pi/180*xpos(i),pi/180*ypos(i),pi/180*ggx(ind(minindex)),pi/180*gy(ind(minindex)))).^2;
        
        % Find the correction using the bathymetry according to Lavender
        % (2005).
        %hdist2(minindex) = (3*lambda*(bathyi(i)-bathtarget(ind(minindex)))./(bathyi(i)+bathtarget(ind(minindex)))).^2;
        hdist2(minindex) = (3*lambda*(bathtarget(ind(minindex))-bathyi(i))./(bathyi(i)+bathtarget(ind(minindex)))).^2;
        
        % Calculate the effective distance between the data point and the
        % grid point considered here.
        deff2vec(minindex) = dist2mvec(minindex)+hdist2(minindex);
    end
    
    % Find the minimum effective distance and the location in the grid.
    deff(i) = sqrt(min(deff2vec));
    indexFin(i) = min(ind(deff2vec == min(deff2vec)));
    
    % Display where we are in the loop.
    if rand() < 0.005
        disp(i)
    end
end

[aux_un1,aux_un2,aux_un3] = unique(indexFin);
tail_EN4_n = NaN(length(aux_un1),1);
for i=1:length(aux_un1)
    tail_EN4_n(i) = sum(aux_un3==i);
end

% Create new fields in structure to receive anomalies
tail_EN4_1(1).T_anom = [];
tail_EN4_1(1).S_anom = [];
tail_EN4_1(1).T_anom_norm = [];
tail_EN4_1(1).S_anom_norm = [];

% Calculate T and S anomalies of each profile
T_mean_bin = NaN(length(p_interp),length(tail_EN4_n));
S_mean_bin = NaN(length(p_interp),length(tail_EN4_n));
T_std_bin = NaN(length(p_interp),length(tail_EN4_n));
S_std_bin = NaN(length(p_interp),length(tail_EN4_n));

for i = 1:length(aux_un3)
    aux5(i,1) = length(tail_EN4_1(i).Temperature);
end
find(aux5 ~=1)

for i = 1:length(tail_EN4_n)
    bin_pos = find(aux_un3==i);
    T_mean_bin(:,i) = nanmean(reshape([tail_EN4_1(aux_un3==i).Temperature],...
        length(p_interp),length(find(aux_un3==i))),2);
    S_mean_bin(:,i) = nanmean(reshape([tail_EN4_1(aux_un3==i).Salinity],...
        length(p_interp),length(find(aux_un3==i))),2);
    T_std_bin(:,i) = nanstd(reshape([tail_EN4_1(aux_un3==i).Temperature],...
        length(p_interp),length(find(aux_un3==i))),0,2);
    S_std_bin(:,i) = nanstd(reshape([tail_EN4_1(aux_un3==i).Salinity],...
        length(p_interp),length(find(aux_un3==i))),0,2);
    for k = 1:tail_EN4_n(i)
        tail_EN4_1(bin_pos(k)).T_anom = tail_EN4_1(bin_pos(k)).Temperature...
            - T_mean_bin(:,i);
        tail_EN4_1(bin_pos(k)).S_anom = tail_EN4_1(bin_pos(k)).Salinity...
            - S_mean_bin(:,i);
        tail_EN4_1(bin_pos(k)).T_anom_norm = (tail_EN4_1(bin_pos(k)).Temperature...
            - T_mean_bin(:,i))./T_std_bin(:,i);
        tail_EN4_1(bin_pos(k)).S_anom_norm = (tail_EN4_1(bin_pos(k)).Salinity...
            - S_mean_bin(:,i))./S_std_bin(:,i);
    end
    clear bin_pos k
end

ydelta = 1;
year_delta = 1930:ydelta:2020;
% Spatially average anomaly profiles for each 3-yr period
T_anom = NaN(length(p_interp),length(year_delta)-1);
T_std = NaN(length(p_interp),length(year_delta)-1);
T_anom_norm = NaN(length(p_interp),length(year_delta)-1);
S_anom = NaN(length(p_interp),length(year_delta)-1);
S_std = NaN(length(p_interp),length(year_delta)-1);
S_anom_norm = NaN(length(p_interp),length(year_delta)-1);
T_n = NaN(length(p_interp),length(year_delta)-1);
S_n = NaN(length(p_interp),length(year_delta)-1);
T_ste = NaN(length(p_interp),length(year_delta)-1);
S_ste = NaN(length(p_interp),length(year_delta)-1);
for t = 1:length(year_delta)-1
    if ~isempty([tail_EN4_1([tail_EN4_1.Time] >= ...
            datenum([num2str(year_delta(t)),'0101'],'yyyymmdd')...
            & [tail_EN4_1.Time] < ...
            datenum([num2str(year_delta(t+1)),'0101'],'yyyymmdd')).T_anom])
        T_anom(:,t) = nanmean([tail_EN4_1([tail_EN4_1.Time] >= ...
            datenum([num2str(year_delta(t)),'0101'],'yyyymmdd')...
            & [tail_EN4_1.Time] < ...
            datenum([num2str(year_delta(t+1)),'0101'],'yyyymmdd')).T_anom],2);
        T_std(:,t) = nanstd([tail_EN4_1([tail_EN4_1.Time] >= ...
            datenum([num2str(year_delta(t)),'0101'],'yyyymmdd')...
            & [tail_EN4_1.Time] < ...
            datenum([num2str(year_delta(t+1)),'0101'],'yyyymmdd')).T_anom],0,2);
        T_anom_norm(:,t) = nanmean([tail_EN4_1([tail_EN4_1.Time] >= ...
            datenum([num2str(year_delta(t)),'0101'],'yyyymmdd')...
            & [tail_EN4_1.Time] < ...
            datenum([num2str(year_delta(t+1)),'0101'],'yyyymmdd')).T_anom_norm],2);
        T_n(:,t) = sum(~isnan([tail_EN4_1([tail_EN4_1.Time] >= ...
            datenum([num2str(year_delta(t)),'0101'],'yyyymmdd')...
            & [tail_EN4_1.Time] < ...
            datenum([num2str(year_delta(t+1)),'0101'],'yyyymmdd')).T_anom]),2);
        T_ste(:,t) = T_std(:,t)./sqrt(T_n(:,t));
    else
        T_n(:,t) = zeros(length(p_interp),1);
    end
    if ~isempty([tail_EN4_1([tail_EN4_1.Time] >= ...
            datenum([num2str(year_delta(t)),'0101'],'yyyymmdd')...
            & [tail_EN4_1.Time] < ...
            datenum([num2str(year_delta(t+1)),'0101'],'yyyymmdd')).S_anom])
        S_anom(:,t) = nanmean([tail_EN4_1([tail_EN4_1.Time] >= ...
            datenum([num2str(year_delta(t)),'0101'],'yyyymmdd')...
            & [tail_EN4_1.Time] < ...
            datenum([num2str(year_delta(t+1)),'0101'],'yyyymmdd')).S_anom],2);
        S_std(:,t) = nanstd([tail_EN4_1([tail_EN4_1.Time] >= ...
            datenum([num2str(year_delta(t)),'0101'],'yyyymmdd')...
            & [tail_EN4_1.Time] < ...
            datenum([num2str(year_delta(t+1)),'0101'],'yyyymmdd')).S_anom],0,2);
        S_anom_norm(:,t) = nanmean([tail_EN4_1([tail_EN4_1.Time] >= ...
            datenum([num2str(year_delta(t)),'0101'],'yyyymmdd')...
            & [tail_EN4_1.Time] < ...
            datenum([num2str(year_delta(t+1)),'0101'],'yyyymmdd')).S_anom_norm],2);
        S_n(:,t) = sum(~isnan([tail_EN4_1([tail_EN4_1.Time] >= ...
            datenum([num2str(year_delta(t)),'0101'],'yyyymmdd')...
            & [tail_EN4_1.Time] < ...
            datenum([num2str(year_delta(t+1)),'0101'],'yyyymmdd')).S_anom]),2);
        S_ste(:,t) = S_std(:,t)./sqrt(S_n(:,t));
    else
        S_n(:,t) = zeros(length(p_interp),1);
    end
end

ydelta = 3;
year_delta3 = 1930:ydelta:2020;
% Spatially average anomaly profiles for each 3-yr period
T_anom3 = NaN(length(p_interp),length(year_delta3)-1);
T_std3 = NaN(length(p_interp),length(year_delta3)-1);
T_anom_norm3 = NaN(length(p_interp),length(year_delta3)-1);
S_anom3 = NaN(length(p_interp),length(year_delta3)-1);
S_std3 = NaN(length(p_interp),length(year_delta3)-1);
S_anom_norm3 = NaN(length(p_interp),length(year_delta3)-1);
T_n3 = NaN(length(p_interp),length(year_delta3)-1);
S_n3 = NaN(length(p_interp),length(year_delta3)-1);
T_ste3 = NaN(length(p_interp),length(year_delta3)-1);
S_ste3 = NaN(length(p_interp),length(year_delta3)-1);
for t = 1:length(year_delta3)-1
    if ~isempty([tail_EN4_1([tail_EN4_1.Time] >= ...
            datenum([num2str(year_delta3(t)),'0101'],'yyyymmdd')...
            & [tail_EN4_1.Time] < ...
            datenum([num2str(year_delta3(t+1)),'0101'],'yyyymmdd')).T_anom])
        T_anom3(:,t) = nanmean([tail_EN4_1([tail_EN4_1.Time] >= ...
            datenum([num2str(year_delta3(t)),'0101'],'yyyymmdd')...
            & [tail_EN4_1.Time] < ...
            datenum([num2str(year_delta3(t+1)),'0101'],'yyyymmdd')).T_anom],2);
        T_std3(:,t) = nanstd([tail_EN4_1([tail_EN4_1.Time] >= ...
            datenum([num2str(year_delta3(t)),'0101'],'yyyymmdd')...
            & [tail_EN4_1.Time] < ...
            datenum([num2str(year_delta3(t+1)),'0101'],'yyyymmdd')).T_anom],0,2);
        T_anom_norm3(:,t) = nanmean([tail_EN4_1([tail_EN4_1.Time] >= ...
            datenum([num2str(year_delta3(t)),'0101'],'yyyymmdd')...
            & [tail_EN4_1.Time] < ...
            datenum([num2str(year_delta3(t+1)),'0101'],'yyyymmdd')).T_anom_norm],2);
        T_n3(:,t) = sum(~isnan([tail_EN4_1([tail_EN4_1.Time] >= ...
            datenum([num2str(year_delta3(t)),'0101'],'yyyymmdd')...
            & [tail_EN4_1.Time] < ...
            datenum([num2str(year_delta3(t+1)),'0101'],'yyyymmdd')).T_anom]),2);
        T_ste3(:,t) = T_std3(:,t)./sqrt(T_n3(:,t));
    else
        T_n3(:,t) = zeros(length(p_interp),1);
    end
    if ~isempty([tail_EN4_1([tail_EN4_1.Time] >= ...
            datenum([num2str(year_delta3(t)),'0101'],'yyyymmdd')...
            & [tail_EN4_1.Time] < ...
            datenum([num2str(year_delta3(t+1)),'0101'],'yyyymmdd')).S_anom])
        S_anom3(:,t) = nanmean([tail_EN4_1([tail_EN4_1.Time] >= ...
            datenum([num2str(year_delta3(t)),'0101'],'yyyymmdd')...
            & [tail_EN4_1.Time] < ...
            datenum([num2str(year_delta3(t+1)),'0101'],'yyyymmdd')).S_anom],2);
        S_std3(:,t) = nanstd([tail_EN4_1([tail_EN4_1.Time] >= ...
            datenum([num2str(year_delta3(t)),'0101'],'yyyymmdd')...
            & [tail_EN4_1.Time] < ...
            datenum([num2str(year_delta3(t+1)),'0101'],'yyyymmdd')).S_anom],0,2);
        S_anom_norm3(:,t) = nanmean([tail_EN4_1([tail_EN4_1.Time] >= ...
            datenum([num2str(year_delta3(t)),'0101'],'yyyymmdd')...
            & [tail_EN4_1.Time] < ...
            datenum([num2str(year_delta3(t+1)),'0101'],'yyyymmdd')).S_anom_norm],2);
        S_n3(:,t) = sum(~isnan([tail_EN4_1([tail_EN4_1.Time] >= ...
            datenum([num2str(year_delta3(t)),'0101'],'yyyymmdd')...
            & [tail_EN4_1.Time] < ...
            datenum([num2str(year_delta3(t+1)),'0101'],'yyyymmdd')).S_anom]),2);
        S_ste3(:,t) = S_std3(:,t)./sqrt(S_n3(:,t));
    else
        S_n3(:,t) = zeros(length(p_interp),1);
    end
end

% Plot 3-yr temperature, anomalies, normalized (350 m)
%T_dens_anom = filtfilt(ones(5,1)/5,1,T_dens_anom);
T_anom_norm1 = T_anom_norm;
T_anom_norm1(T_anom_norm > 1) = 1;
T_anom_norm1(T_anom_norm < -1) = -1;

figure('Position', [100, 200, 750, 250])
sp2 = subplot('Position',[0.08 0.16 0.88 0.74]);
hold on
% scatter([tail_EN4_1.Time],[tail_EN4_1.T_dens_anom],'filled',...
%     'MarkerEdgeColor',rgb('DarkSlateGray'),'MarkerFaceColor',rgb('DarkSlateGray'),...
%     'MarkerEdgeAlpha',0.25,'MarkerFaceAlpha',0.25)
scatter(datenum(num2str(year_delta(1:end-1)'),'yyyy'),T_anom_norm,...
    30,rgb('gray'),'filled')
%plot(datenum(num2str(year_delta(1:end-1)'),'yyyy'),T_anom_norm,'k','LineWidth',1)
fill([datenum(num2str(year_delta3(1:4)'),'yyyy');flipud(datenum(num2str(year_delta3(1:4)'),'yyyy'))],...
    [T_anom_norm3(1:4)'-T_ste3(1:4)';flipud(T_anom_norm3(1:4)'+T_ste3(1:4)')],...
    rgb('FireBrick'),'EdgeColor',rgb('FireBrick'),...
    'FaceAlpha',0.4,'EdgeAlpha',0.05)
fill([datenum(num2str(year_delta3(7:end-1)'),'yyyy');flipud(datenum(num2str(year_delta3(7:end-1)'),'yyyy'))],...
    [T_anom_norm3(7:end)'-T_ste3(7:end)';flipud(T_anom_norm3(7:end)'+T_ste3(7:end)')],...
    rgb('FireBrick'),'EdgeColor',rgb('FireBrick'),...
    'FaceAlpha',0.4,'EdgeAlpha',0.05)
plot(datenum(num2str(year_delta3(1:end-1)'),'yyyy'),T_anom_norm3,'color',rgb('DarkRed'),'LineWidth',2.5)
%eb = errorbar(datenum(num2str(year_delta(1:end-1)'),'yyyy'),T_anom_norm(p_interp==350,:),T_ste(p_interp==350,:));
%eb.Marker = '.';
%eb.MarkerSize = 12;
%eb.Color = 'k';
grid on
ylabel('Temperature Std. Dev.')
xlabel('Time (yr)')
ylim([-1.3 1.3])
xlim([datenum(num2str(year_delta(1)),'yyyy') datenum(num2str(year_delta(end)),'yyyy')])
datetick('x','yyyy')
set(gca,'FontSize',14)
%title('Normalized 3-yr T anomalies at 350 m at the TGB')
saveas(gcf,[output_dir,'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_SupplementalFigure6_pre'],'epsc')

T_anom_norm33 = NaN(size(T_anom_norm));
T_anom_norm33(5:12) = filtfilt(ones(3,1)/3,1,T_anom_norm(5:12));
T_anom_norm33(19:end) = filtfilt(ones(3,1)/3,1,T_anom_norm(19:end));
T_ste33 = NaN(size(T_ste));
T_ste33(5:12) = filtfilt(ones(3,1)/3,1,T_ste(5:12));
T_ste33(19:end) = filtfilt(ones(3,1)/3,1,T_ste(19:end));

figure('Position', [100, 200, 750, 250])
sp2 = subplot('Position',[0.08 0.16 0.88 0.74]);
hold on
% scatter([tail_EN4_1.Time],[tail_EN4_1.T_dens_anom],'filled',...
%     'MarkerEdgeColor',rgb('DarkSlateGray'),'MarkerFaceColor',rgb('DarkSlateGray'),...
%     'MarkerEdgeAlpha',0.25,'MarkerFaceAlpha',0.25)
scatter(datenum(num2str(year_delta(1:end-1)'),'yyyy'),T_anom_norm,...
    30,rgb('gray'),'filled')
%plot(datenum(num2str(year_delta(1:end-1)'),'yyyy'),T_anom_norm,'k','LineWidth',1)
fill([datenum(num2str(year_delta(5:11)'),'yyyy');flipud(datenum(num2str(year_delta(5:11)'),'yyyy'))],...
    [T_anom_norm33(5:11)'-T_ste33(5:11)';flipud(T_anom_norm33(5:11)'+T_ste33(5:11)')],...
    rgb('FireBrick'),'EdgeColor',rgb('FireBrick'),...
    'FaceAlpha',0.4,'EdgeAlpha',0.05)
fill([datenum(num2str(year_delta(20:end-2)'),'yyyy');flipud(datenum(num2str(year_delta(20:end-2)'),'yyyy'))],...
    [T_anom_norm33(20:end-1)'-T_ste33(20:end-1)';flipud(T_anom_norm33(20:end-1)'+T_ste33(20:end-1)')],...
    rgb('FireBrick'),'EdgeColor',rgb('FireBrick'),...
    'FaceAlpha',0.4,'EdgeAlpha',0.05)
plot(datenum(num2str(year_delta(5:11)'),'yyyy'),T_anom_norm33(5:11),'color',rgb('DarkRed'),'LineWidth',2.5)
plot(datenum(num2str(year_delta(20:end-2)'),'yyyy'),T_anom_norm33(20:end-1),'color',rgb('DarkRed'),'LineWidth',2.5)
%eb = errorbar(datenum(num2str(year_delta(1:end-1)'),'yyyy'),T_anom_norm(p_interp==350,:),T_ste(p_interp==350,:));
%eb.Marker = '.';
%eb.MarkerSize = 12;
%eb.Color = 'k';
grid on
ylabel('Temperature Std. Dev.')
xlabel('Time (yr)')
ylim([-1.3 1.3])
xlim([datenum(num2str(year_delta(1)),'yyyy') datenum(num2str(year_delta(end)),'yyyy')])
datetick('x','yyyy')
set(gca,'FontSize',14)
%title('Normalized 3-yr T anomalies at 350 m at the TGB')
saveas(gcf,[output_dir,'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_SupplementalFigure6_pre2'],'epsc')

%% Supplemental Figure 7

% Set  directory to save data
data_dir = '/Users/afonso/Documents/Research/TGB/data/';
% Set directory to save figures and tables
output_dir = '/Users/afonso/Documents/Research/TGB/output/';

load([data_dir,'EN4_profiles_NWAsmall_postQC.mat'],'EN4_profiles_NWAsmall_n')
load([output_dir,'etopo1_TGB.mat'],'lat_z','lon_z','z')

decade = 1900:10:2010;
lat = 30:60;
lon = -80:-40;

% get number of profiles at each bin per decade
aux = zeros(30,40,12);
for t = 1:12
    aux(:,:,t) = nansum(EN4_profiles_NWAsmall_n(:,:,t*120-119:t*120),3);
end
clear t

% get profiles used in Fig 3, 4 and Table 1
T = readtable('Z149mat22.csv', 'HeaderLines',1);
T1 = table2array(T);
T1(T1==0) = NaN;
T149_change_point = NaN(1,1271);
T149_change = NaN(1,1271);
for j = 1:1271
    if sum(~isnan(T1(:,j))) >= 1
        T149_change_point(1,j) = find(~isnan(T1(:,j)));
        T149_change(1,j) = T1(T149_change_point(1,j),j);
    end
end

T149_change_reshape = reshape(T149_change,41,31);
T149_change_point_reshape = reshape(T149_change_point,41,31);
T149_change_reshape_20092011 = T149_change_reshape;
T149_change_reshape_20092011(T149_change_point_reshape<193 | T149_change_point_reshape>228) = NaN;

EN4_profiles_NWAsmall_n2 = nansum(EN4_profiles_NWAsmall_n,3)';
EN4_profiles_NWAsmall_n2(isnan(T149_change_reshape_20092011(1:end-1,1:end-1))) = NaN;
nansum(nansum(nansum(EN4_profiles_NWAsmall_n)));%  1,310,811 profiles in the small box
nansum(nansum(EN4_profiles_NWAsmall_n2));%  741,373 profiles on the shelf
100*nansum(nansum(EN4_profiles_NWAsmall_n2))/nansum(nansum(nansum(EN4_profiles_NWAsmall_n)))%57% on the shelf

% positions in Fig
pos_9panel = [0.08,0.72,0.27,0.24;...
    0.39,0.72,0.27,0.24;...
    0.70,0.72,0.27,0.24;...
    0.08,0.44,0.27,0.24;...
    0.39,0.44,0.27,0.24;...
    0.70,0.44,0.27,0.24;...
    0.08,0.16,0.27,0.24;...
    0.39,0.16,0.27,0.24;...
    0.70,0.16,0.27,0.24];

colormap_nonlinear = [254/256,217/256,118/256;...
    161/256,217/256,155/256;...
    65/256,171/256,93/256;...
    0/256,109/256,44/256;...
    0/256,68/256,27/256;...
    188/256,189/256,220/256;...
    128/256,125/256,186/256;...
    84/256,39/256,143/256;...
    63/256,0/256,125/256;...
    252/256,146/256,114/256;...
    239/256,59/256,44/256;...
    165/256,15/256,21/256;...
    103/256,0/256,13/256];

colormap_nonlinear2 = [255/256,255/256,217/256;...
    199/256,233/256,192/256;...
    161/256,217/256,155/256;...
    116/256,196/256,118/256;...
    65/256,171/256,93/256;...
    198/256,219/256,239/256;...
    158/256,202/256,225/256;...
    107/256,174/256,214/256;...
    66/256,146/256,198/256;...
    150/256,150/256,150/256;...
    115/256,115/256,115/256;...
    82/256,82/256,82/256;...
    37/256,37/256,37/256];

% Wave colormap 1
colormap_aux = readtable('convertcsv.csv', 'HeaderLines',1);
colormap_wave = table2array(colormap_aux(:,1:5));
clear colormap_aux
colormap_wave_trim = colormap_wave([9:14,31:54,59:82,83:106],3:5);

% Wave colormap 2
colormap_aux = readtable('4Wmed8.csv', 'HeaderLines',1);
colormap_wave2 = table2array(colormap_aux(:,1:5));
clear colormap_aux
colormap_wave2_trim = colormap_wave2([20:34,67:126,129:188,189:248],3:5);

% transform to nonlinear scale (13 color)
L = [1,10,25,50,75,100,250,500,750,1000,2500,5000,10^4,10^5];
aux1 = zeros(size(aux));
for i = 1:length(L)-1
    aux1(aux>=L(i) & aux<L(i+1)) = i;
end
aux1(aux1 ==0) = NaN;

% transform to nonlinear scale (wave colormap 1)
L = [1,10,25,50,75,100,250,500,750,1000,2500,5000,10^4,10^5];
L_wave1 = [1:9/6:10,10+90/24:90/24:100,100+900/24:900/24:1000,1000+4000/12:4000/12:5000,5000+5000/6:5000/6:10000,10000+90000/6:90000/6:100000];
aux1_wave1 = zeros(size(aux));
for i = 1:length(L_wave1)-1
    aux1_wave1(aux>=L_wave1(i) & aux<L_wave1(i+1)) = i;
end
aux1_wave1(aux1_wave1 == 0) = NaN;

% transform to nonlinear scale (wave colormap 2)
L = [1,10,25,50,75,100,250,500,750,1000,2500,5000,10^4,10^5];
L_wave2 = [1:9/15:10,10+90/60:90/60:100,100+900/60:900/60:1000,1000+4000/30:4000/30:5000,5000+5000/15:5000/15:10000,10000+90000/15:90000/15:100000];
aux1_wave2 = zeros(size(aux));
for i = 1:length(L_wave2)-1
    aux1_wave2(aux>=L_wave2(i) & aux<L_wave2(i+1)) = i;
end
aux1_wave2(aux1_wave2 == 0) = NaN;


%py cm_xml_to_matplotlib.py -m -f /Users/afonso/Documents/MATLAB/fourwave-bgyGr.xml

% number of profiles by 1 degree x 1 degree bin (nonlinear colomarp)
figure('Position', [100, 200, 900, 700])
%subplot('Position',[0.06 0.15 0.88 0.78])
for t = 4:12
    %count_profiles = 0;
    subplot('Position',pos_9panel(t-3,:))
    axesm('MapProjection','eqdcylin','MapLatLimit',[33 50],'MapLonLimit',[-77 -48])
    hold on    
    pcolorm(lat(1:end-1)+0.5,lon(1:end-1)+0.5,aux1(:,:,t))
    shading flat
    caxis([1,14])
    %set(gca,'ColorScale','log')
    %colormap(crameri('-hawaii',13))
    %colormap(cmocean('speed',13))
    colormap(colormap_nonlinear2)
    %colormap(colormap_wave_trim)
    if t == 4
        c = colorbar('Orientation','Horizontal','Position',[0.12 0.07 0.8 0.02],'Color','k','Fontsize',14);
        set(c,'ytick',1:14,'yticklabel',string(L))
        c.Label.String = 'Number of profiles';
    end
    contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),...
        [-100 -100],'color',[.7 .7 .7],'linewidth',1)
    contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),...
        [-1000 -1000],'color',[.7 .7 .7],'linewidth',1)
    contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),...
        [-3000 -3000],'color',[.7 .7 .7],'linewidth',1)
    contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),...
        [-4000 -4000],'color',[.7 .7 .7],'linewidth',1)
    
    set(gca,'FontSize',14)
    title([num2str(decade(t)),'s: ',num2str(nansum(nansum(nansum(EN4_profiles_NWAsmall_n(:,:,t*120-119:t*120))))),' profiles'])
    geoshow('GSHHS_l_L1.shp','FaceColor','k')
    if t == 4 | t == 7 | t == 10
    plabel('PLabelLocation',5,'Fontsize',16)
    else
        plabel('off')
    end
    if t == 10 | t == 11 | t == 12
        mlabel('MLabelLocation',10,'MLabelParallel','south','Fontsize',16)
    else
        mlabel('off')
    end
    framem
    tightmap
    set(gcf, 'Color', 'w')
end
saveas(gcf,[output_dir,'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_SupplementalFigure7_pre_option3'],'epsc')

% number of profiles by 1 degree x 1 degree bin (wave colomarp 1)
figure('Position', [100, 200, 900, 700])
%subplot('Position',[0.06 0.15 0.88 0.78])
for t = 4:12
    %count_profiles = 0;
    subplot('Position',pos_9panel(t-3,:))
    axesm('MapProjection','eqdcylin','MapLatLimit',[33 50],'MapLonLimit',[-77 -48])
    hold on    
    pcolorm(lat(1:end-1)+0.5,lon(1:end-1)+0.5,aux1_wave1(:,:,t))
    shading flat
    caxis([1,79])
    %set(gca,'ColorScale','log')
    %colormap(crameri('-hawaii',13))
    %colormap(cmocean('speed',13))
    %colormap(colormap_nonlinear2)
    colormap(colormap_wave_trim)
    if t == 4
        c = colorbar('Orientation','Horizontal','Position',[0.12 0.07 0.8 0.02],'Color','k','Fontsize',14);
        set(c,'ytick',[1,7,11,16.667,24.333,31,35,41.667,48.333,55,59.5,67,73,79],'yticklabel',string(L))%string(L_wave1([1,7,11,19,27,31,35,43,51,55,61,67,73,79])))
        c.Label.String = 'Number of profiles';
    end
    contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),...
        [-100 -100],'color',[.7 .7 .7],'linewidth',1)
    contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),...
        [-1000 -1000],'color',[.7 .7 .7],'linewidth',1)
    contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),...
        [-3000 -3000],'color',[.7 .7 .7],'linewidth',1)
    contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),...
        [-4000 -4000],'color',[.7 .7 .7],'linewidth',1)
    
    set(gca,'FontSize',14)
    title([num2str(decade(t)),'s: ',num2str(nansum(nansum(nansum(EN4_profiles_NWAsmall_n(:,:,t*120-119:t*120))))),' profiles'])
    geoshow('GSHHS_l_L1.shp','FaceColor','k')
    if t == 4 | t == 7 | t == 10
    plabel('PLabelLocation',5,'Fontsize',16)
    else
        plabel('off')
    end
    if t == 10 | t == 11 | t == 12
        mlabel('MLabelLocation',10,'MLabelParallel','south','Fontsize',16)
    else
        mlabel('off')
    end
    framem
    tightmap
    set(gcf, 'Color', 'w')
end
saveas(gcf,[output_dir,'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_SupplementalFigure7_pre_option1'],'epsc')

% number of profiles by 1 degree x 1 degree bin (wave colomarp 2)
figure('Position', [100, 200, 900, 700])
%subplot('Position',[0.06 0.15 0.88 0.78])
for t = 4:12
    %count_profiles = 0;
    subplot('Position',pos_9panel(t-3,:))
    axesm('MapProjection','eqdcylin','MapLatLimit',[33 50],'MapLonLimit',[-77 -48])
    hold on    
    pcolorm(lat(1:end-1)+0.5,lon(1:end-1)+0.5,aux1_wave2(:,:,t))
    shading flat
    caxis([1,196])
    %set(gca,'ColorScale','log')
    %colormap(crameri('-hawaii',13))
    %colormap(cmocean('speed',13))
    %colormap(colormap_nonlinear2)
    colormap(colormap_wave2_trim)
    if t == 4
        c = colorbar('Orientation','Horizontal','Position',[0.12 0.07 0.8 0.02],'Color','k','Fontsize',14);
        set(c,'ytick',[1,16,26,42.667,59.333,76,86,102.667,119.333,136,147.25,166,181,196],'yticklabel',string(L))%string(L_wave2([1,16,26,46,66,76,86,106,126,136,151,166,181,196])))
        c.Label.String = 'Number of profiles';
    end
    contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),...
        [-100 -100],'color',[.7 .7 .7],'linewidth',1)
    contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),...
        [-1000 -1000],'color',[.7 .7 .7],'linewidth',1)
    contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),...
        [-3000 -3000],'color',[.7 .7 .7],'linewidth',1)
    contourm(lat_z(1:10:end),lon_z(1:10:end),z(1:10:end,1:10:end),...
        [-4000 -4000],'color',[.7 .7 .7],'linewidth',1)
    
    set(gca,'FontSize',14)
    title([num2str(decade(t)),'s: ',num2str(nansum(nansum(nansum(EN4_profiles_NWAsmall_n(:,:,t*120-119:t*120))))),' profiles'])
    geoshow('GSHHS_l_L1.shp','FaceColor','k')
    if t == 4 | t == 7 | t == 10
    plabel('PLabelLocation',5,'Fontsize',16)
    else
        plabel('off')
    end
    if t == 10 | t == 11 | t == 12
        mlabel('MLabelLocation',10,'MLabelParallel','south','Fontsize',16)
    else
        mlabel('off')
    end
    framem
    tightmap
    set(gcf, 'Color', 'w')
end
saveas(gcf,[output_dir,'GoncalvesNeto_et_al_2020_Nature/GoncalvesNeto_et_al_2020_Nature_SupplementalFigure7_pre_option2'],'epsc')


clearvars -except *_dir
close all
##### SOURCE END #####
--></body></html>